"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/members/[memberId]/pass/route";
exports.ids = ["app/api/members/[memberId]/pass/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "dns":
/*!**********************!*\
  !*** external "dns" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("dns");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute&page=%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute.ts&appDir=%2FVolumes%2FMacintosh%20HD%20-%20Data%2Fsda%2Fsda-backend%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FMacintosh%20HD%20-%20Data%2Fsda%2Fsda-backend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute&page=%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute.ts&appDir=%2FVolumes%2FMacintosh%20HD%20-%20Data%2Fsda%2Fsda-backend%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FMacintosh%20HD%20-%20Data%2Fsda%2Fsda-backend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Volumes_Macintosh_HD_Data_sda_sda_backend_app_api_members_memberId_pass_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/members/[memberId]/pass/route.ts */ \"(rsc)/./app/api/members/[memberId]/pass/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/members/[memberId]/pass/route\",\n        pathname: \"/api/members/[memberId]/pass\",\n        filename: \"route\",\n        bundlePath: \"app/api/members/[memberId]/pass/route\"\n    },\n    resolvedPagePath: \"/Volumes/Macintosh HD - Data/sda/sda-backend/app/api/members/[memberId]/pass/route.ts\",\n    nextConfigOutput,\n    userland: _Volumes_Macintosh_HD_Data_sda_sda_backend_app_api_members_memberId_pass_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/members/[memberId]/pass/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZtZW1iZXJzJTJGJTVCbWVtYmVySWQlNUQlMkZwYXNzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZtZW1iZXJzJTJGJTVCbWVtYmVySWQlNUQlMkZwYXNzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGbWVtYmVycyUyRiU1Qm1lbWJlcklkJTVEJTJGcGFzcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZWb2x1bWVzJTJGTWFjaW50b3NoJTIwSEQlMjAtJTIwRGF0YSUyRnNkYSUyRnNkYS1iYWNrZW5kJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZWb2x1bWVzJTJGTWFjaW50b3NoJTIwSEQlMjAtJTIwRGF0YSUyRnNkYSUyRnNkYS1iYWNrZW5kJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNxQztBQUNsSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NkYS1iYWNrZW5kLz8yNDQzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Wb2x1bWVzL01hY2ludG9zaCBIRCAtIERhdGEvc2RhL3NkYS1iYWNrZW5kL2FwcC9hcGkvbWVtYmVycy9bbWVtYmVySWRdL3Bhc3Mvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL21lbWJlcnMvW21lbWJlcklkXS9wYXNzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbWVtYmVycy9bbWVtYmVySWRdL3Bhc3NcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL21lbWJlcnMvW21lbWJlcklkXS9wYXNzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1ZvbHVtZXMvTWFjaW50b3NoIEhEIC0gRGF0YS9zZGEvc2RhLWJhY2tlbmQvYXBwL2FwaS9tZW1iZXJzL1ttZW1iZXJJZF0vcGFzcy9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvbWVtYmVycy9bbWVtYmVySWRdL3Bhc3Mvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute&page=%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute.ts&appDir=%2FVolumes%2FMacintosh%20HD%20-%20Data%2Fsda%2Fsda-backend%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FMacintosh%20HD%20-%20Data%2Fsda%2Fsda-backend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/members/[memberId]/pass/route.ts":
/*!**************************************************!*\
  !*** ./app/api/members/[memberId]/pass/route.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var _lib_route__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/route */ \"(rsc)/./src/lib/route.ts\");\n/* harmony import */ var _middlewares_auth_middleware__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/middlewares/auth.middleware */ \"(rsc)/./src/middlewares/auth.middleware.ts\");\n/* harmony import */ var _middlewares_params_middleware__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/middlewares/params.middleware */ \"(rsc)/./src/middlewares/params.middleware.ts\");\n/* harmony import */ var _controllers_member_controller__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/controllers/member.controller */ \"(rsc)/./src/controllers/member.controller.ts\");\n\n\n\n\n\n\nconst paramsSchema = zod__WEBPACK_IMPORTED_MODULE_5__.object({\n    memberId: zod__WEBPACK_IMPORTED_MODULE_5__.string().min(1, \"Member id is required\")\n});\nconst GET = (0,_lib_route__WEBPACK_IMPORTED_MODULE_1__.createHandler)({\n    middlewares: [\n        (0,_middlewares_auth_middleware__WEBPACK_IMPORTED_MODULE_2__.requireAuthMiddleware)([\n            \"CHURCH_ADMIN\",\n            \"DISTRICT_ADMIN\",\n            \"UNION_ADMIN\",\n            \"MEMBER\"\n        ]),\n        (0,_middlewares_params_middleware__WEBPACK_IMPORTED_MODULE_3__.paramsSchemaMiddleware)(paramsSchema)\n    ],\n    controller: _controllers_member_controller__WEBPACK_IMPORTED_MODULE_4__.getMemberPassController\n});\nconst OPTIONS = (0,_lib_route__WEBPACK_IMPORTED_MODULE_1__.createHandler)({\n    controller: async ()=>new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n            status: 204\n        })\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL21lbWJlcnMvW21lbWJlcklkXS9wYXNzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQTJDO0FBQ25CO0FBRW9CO0FBQzBCO0FBQ0c7QUFDQztBQUUxRSxNQUFNTSxlQUFlTCx1Q0FBUSxDQUFDO0lBQzVCTyxVQUFVUCx1Q0FBUSxHQUFHUyxHQUFHLENBQUMsR0FBRztBQUM5QjtBQUVPLE1BQU1DLE1BQU1ULHlEQUFhQSxDQUFDO0lBQy9CVSxhQUFhO1FBQ1hULG1GQUFxQkEsQ0FBQztZQUFDO1lBQWdCO1lBQWtCO1lBQWU7U0FBUztRQUNqRkMsc0ZBQXNCQSxDQUFDRTtLQUN4QjtJQUNETyxZQUFZUixtRkFBdUJBO0FBQ3JDLEdBQUc7QUFFSSxNQUFNUyxVQUFVWix5REFBYUEsQ0FBQztJQUNuQ1csWUFBWSxVQUFZLElBQUliLHFEQUFZQSxDQUFDLE1BQU07WUFBRWUsUUFBUTtRQUFJO0FBQy9ELEdBQUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZGEtYmFja2VuZC8uL2FwcC9hcGkvbWVtYmVycy9bbWVtYmVySWRdL3Bhc3Mvcm91dGUudHM/ODllMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG5cbmltcG9ydCB7IGNyZWF0ZUhhbmRsZXIgfSBmcm9tIFwiQC9saWIvcm91dGVcIjtcbmltcG9ydCB7IHJlcXVpcmVBdXRoTWlkZGxld2FyZSB9IGZyb20gXCJAL21pZGRsZXdhcmVzL2F1dGgubWlkZGxld2FyZVwiO1xuaW1wb3J0IHsgcGFyYW1zU2NoZW1hTWlkZGxld2FyZSB9IGZyb20gXCJAL21pZGRsZXdhcmVzL3BhcmFtcy5taWRkbGV3YXJlXCI7XG5pbXBvcnQgeyBnZXRNZW1iZXJQYXNzQ29udHJvbGxlciB9IGZyb20gXCJAL2NvbnRyb2xsZXJzL21lbWJlci5jb250cm9sbGVyXCI7XG5cbmNvbnN0IHBhcmFtc1NjaGVtYSA9IHoub2JqZWN0KHtcbiAgbWVtYmVySWQ6IHouc3RyaW5nKCkubWluKDEsIFwiTWVtYmVyIGlkIGlzIHJlcXVpcmVkXCIpLFxufSk7XG5cbmV4cG9ydCBjb25zdCBHRVQgPSBjcmVhdGVIYW5kbGVyKHtcbiAgbWlkZGxld2FyZXM6IFtcbiAgICByZXF1aXJlQXV0aE1pZGRsZXdhcmUoW1wiQ0hVUkNIX0FETUlOXCIsIFwiRElTVFJJQ1RfQURNSU5cIiwgXCJVTklPTl9BRE1JTlwiLCBcIk1FTUJFUlwiXSksXG4gICAgcGFyYW1zU2NoZW1hTWlkZGxld2FyZShwYXJhbXNTY2hlbWEpLFxuICBdLFxuICBjb250cm9sbGVyOiBnZXRNZW1iZXJQYXNzQ29udHJvbGxlcixcbn0pO1xuXG5leHBvcnQgY29uc3QgT1BUSU9OUyA9IGNyZWF0ZUhhbmRsZXIoe1xuICBjb250cm9sbGVyOiBhc3luYyAoKSA9PiBuZXcgTmV4dFJlc3BvbnNlKG51bGwsIHsgc3RhdHVzOiAyMDQgfSksXG59KTtcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJ6IiwiY3JlYXRlSGFuZGxlciIsInJlcXVpcmVBdXRoTWlkZGxld2FyZSIsInBhcmFtc1NjaGVtYU1pZGRsZXdhcmUiLCJnZXRNZW1iZXJQYXNzQ29udHJvbGxlciIsInBhcmFtc1NjaGVtYSIsIm9iamVjdCIsIm1lbWJlcklkIiwic3RyaW5nIiwibWluIiwiR0VUIiwibWlkZGxld2FyZXMiLCJjb250cm9sbGVyIiwiT1BUSU9OUyIsInN0YXR1cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/members/[memberId]/pass/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/controllers/member.controller.ts":
/*!**********************************************!*\
  !*** ./src/controllers/member.controller.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createMemberController: () => (/* binding */ createMemberController),\n/* harmony export */   deleteMemberController: () => (/* binding */ deleteMemberController),\n/* harmony export */   getMemberPassController: () => (/* binding */ getMemberPassController),\n/* harmony export */   listMembersController: () => (/* binding */ listMembersController),\n/* harmony export */   updateMemberController: () => (/* binding */ updateMemberController)\n/* harmony export */ });\n/* harmony import */ var _services_member_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/services/member.service */ \"(rsc)/./src/services/member.service.ts\");\n/* harmony import */ var _services_audit_log_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/services/audit-log.service */ \"(rsc)/./src/services/audit-log.service.ts\");\n\n\nconst listMembersController = async (context)=>{\n    const members = await (0,_services_member_service__WEBPACK_IMPORTED_MODULE_0__.listMembersForUser)(context.user, context.queryData ?? {});\n    return {\n        members\n    };\n};\nconst createMemberController = async (context)=>{\n    if (!context.body) {\n        throw new Error(\"Missing request body\");\n    }\n    const result = await (0,_services_member_service__WEBPACK_IMPORTED_MODULE_0__.createMember)(context.user, context.body);\n    await (0,_services_audit_log_service__WEBPACK_IMPORTED_MODULE_1__.recordAuditLog)({\n        req: context.req,\n        user: context.user,\n        action: \"member.create\",\n        details: {\n            memberId: result.member.id,\n            churchId: result.member.church?.id ?? null,\n            firstName: result.member.firstName,\n            lastName: result.member.lastName\n        }\n    });\n    return result;\n};\nconst updateMemberController = async (context)=>{\n    const memberId = context.paramsData?.memberId;\n    if (!memberId) {\n        throw new Error(\"Member id is required\");\n    }\n    const changes = context.body ?? {};\n    const result = await (0,_services_member_service__WEBPACK_IMPORTED_MODULE_0__.updateMember)(context.user, memberId, changes);\n    await (0,_services_audit_log_service__WEBPACK_IMPORTED_MODULE_1__.recordAuditLog)({\n        req: context.req,\n        user: context.user,\n        action: \"member.update\",\n        details: {\n            memberId,\n            churchId: result.member.church?.id ?? null,\n            changes\n        }\n    });\n    return result;\n};\nconst deleteMemberController = async (context)=>{\n    const memberId = context.paramsData?.memberId;\n    if (!memberId) {\n        throw new Error(\"Member id is required\");\n    }\n    const result = await (0,_services_member_service__WEBPACK_IMPORTED_MODULE_0__.deleteMember)(context.user, memberId);\n    await (0,_services_audit_log_service__WEBPACK_IMPORTED_MODULE_1__.recordAuditLog)({\n        req: context.req,\n        user: context.user,\n        action: \"member.delete\",\n        details: {\n            memberId\n        }\n    });\n    return result;\n};\nconst getMemberPassController = async (context)=>{\n    const memberId = context.paramsData?.memberId;\n    if (!memberId) {\n        throw new Error(\"Member id is required\");\n    }\n    const result = await (0,_services_member_service__WEBPACK_IMPORTED_MODULE_0__.getMemberPassForUser)(context.user, memberId);\n    return result;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29udHJvbGxlcnMvbWVtYmVyLmNvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQWVtQztBQUMyQjtBQUV2RCxNQUFNTSx3QkFBd0IsT0FDbkNDO0lBRUEsTUFBTUMsVUFBVSxNQUFNTCw0RUFBa0JBLENBQUNJLFFBQVFFLElBQUksRUFBRUYsUUFBUUcsU0FBUyxJQUFJLENBQUM7SUFDN0UsT0FBTztRQUFFRjtJQUFRO0FBQ25CLEVBQUU7QUFFSyxNQUFNRyx5QkFBeUIsT0FDcENKO0lBRUEsSUFBSSxDQUFDQSxRQUFRSyxJQUFJLEVBQUU7UUFDakIsTUFBTSxJQUFJQyxNQUFNO0lBQ2xCO0lBRUEsTUFBTUMsU0FBUyxNQUFNZCxzRUFBWUEsQ0FBQ08sUUFBUUUsSUFBSSxFQUFFRixRQUFRSyxJQUFJO0lBRTVELE1BQU1QLDJFQUFjQSxDQUFDO1FBQ25CVSxLQUFLUixRQUFRUSxHQUFHO1FBQ2hCTixNQUFNRixRQUFRRSxJQUFJO1FBQ2xCTyxRQUFRO1FBQ1JDLFNBQVM7WUFDUEMsVUFBVUosT0FBT0ssTUFBTSxDQUFDQyxFQUFFO1lBQzFCQyxVQUFVUCxPQUFPSyxNQUFNLENBQUNHLE1BQU0sRUFBRUYsTUFBTTtZQUN0Q0csV0FBV1QsT0FBT0ssTUFBTSxDQUFDSSxTQUFTO1lBQ2xDQyxVQUFVVixPQUFPSyxNQUFNLENBQUNLLFFBQVE7UUFDbEM7SUFDRjtJQUNBLE9BQU9WO0FBQ1QsRUFBRTtBQUVLLE1BQU1XLHlCQUF5QixPQUNwQ2xCO0lBRUEsTUFBTVcsV0FBV1gsUUFBUW1CLFVBQVUsRUFBRVI7SUFDckMsSUFBSSxDQUFDQSxVQUFVO1FBQ2IsTUFBTSxJQUFJTCxNQUFNO0lBQ2xCO0lBRUEsTUFBTWMsVUFBVXBCLFFBQVFLLElBQUksSUFBSSxDQUFDO0lBQ2pDLE1BQU1FLFNBQVMsTUFBTVYsc0VBQVlBLENBQUNHLFFBQVFFLElBQUksRUFBRVMsVUFBVVM7SUFFMUQsTUFBTXRCLDJFQUFjQSxDQUFDO1FBQ25CVSxLQUFLUixRQUFRUSxHQUFHO1FBQ2hCTixNQUFNRixRQUFRRSxJQUFJO1FBQ2xCTyxRQUFRO1FBQ1JDLFNBQVM7WUFDUEM7WUFDQUcsVUFBVVAsT0FBT0ssTUFBTSxDQUFDRyxNQUFNLEVBQUVGLE1BQU07WUFDdENPO1FBQ0Y7SUFDRjtJQUNBLE9BQU9iO0FBQ1QsRUFBRTtBQUVLLE1BQU1jLHlCQUF5QixPQUNwQ3JCO0lBRUEsTUFBTVcsV0FBV1gsUUFBUW1CLFVBQVUsRUFBRVI7SUFDckMsSUFBSSxDQUFDQSxVQUFVO1FBQ2IsTUFBTSxJQUFJTCxNQUFNO0lBQ2xCO0lBRUEsTUFBTUMsU0FBUyxNQUFNYixzRUFBWUEsQ0FBQ00sUUFBUUUsSUFBSSxFQUFFUztJQUVoRCxNQUFNYiwyRUFBY0EsQ0FBQztRQUNuQlUsS0FBS1IsUUFBUVEsR0FBRztRQUNoQk4sTUFBTUYsUUFBUUUsSUFBSTtRQUNsQk8sUUFBUTtRQUNSQyxTQUFTO1lBQ1BDO1FBQ0Y7SUFDRjtJQUNBLE9BQU9KO0FBQ1QsRUFBRTtBQUVLLE1BQU1lLDBCQUEwQixPQUNyQ3RCO0lBRUEsTUFBTVcsV0FBV1gsUUFBUW1CLFVBQVUsRUFBRVI7SUFDckMsSUFBSSxDQUFDQSxVQUFVO1FBQ2IsTUFBTSxJQUFJTCxNQUFNO0lBQ2xCO0lBRUEsTUFBTUMsU0FBUyxNQUFNWiw4RUFBb0JBLENBQUNLLFFBQVFFLElBQUksRUFBRVM7SUFDeEQsT0FBT0o7QUFDVCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2RhLWJhY2tlbmQvLi9zcmMvY29udHJvbGxlcnMvbWVtYmVyLmNvbnRyb2xsZXIudHM/ZmU3MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7XG4gIEF1dGhlbnRpY2F0ZWRCb2R5Q29udGV4dCxcbiAgQXV0aGVudGljYXRlZEJvZHlQYXJhbXNDb250ZXh0LFxuICBBdXRoZW50aWNhdGVkUGFyYW1zQ29udGV4dCxcbiAgQXV0aGVudGljYXRlZFF1ZXJ5Q29udGV4dCxcbn0gZnJvbSBcIkAvbWlkZGxld2FyZXMvdHlwZXNcIjtcbmltcG9ydCB7XG4gIGNyZWF0ZU1lbWJlcixcbiAgZGVsZXRlTWVtYmVyLFxuICBnZXRNZW1iZXJQYXNzRm9yVXNlcixcbiAgbGlzdE1lbWJlcnNGb3JVc2VyLFxuICB1cGRhdGVNZW1iZXIsXG4gIHR5cGUgQ3JlYXRlTWVtYmVySW5wdXQsXG4gIHR5cGUgTWVtYmVyRmlsdGVycyxcbiAgdHlwZSBVcGRhdGVNZW1iZXJJbnB1dCxcbn0gZnJvbSBcIkAvc2VydmljZXMvbWVtYmVyLnNlcnZpY2VcIjtcbmltcG9ydCB7IHJlY29yZEF1ZGl0TG9nIH0gZnJvbSBcIkAvc2VydmljZXMvYXVkaXQtbG9nLnNlcnZpY2VcIjtcblxuZXhwb3J0IGNvbnN0IGxpc3RNZW1iZXJzQ29udHJvbGxlciA9IGFzeW5jIChcbiAgY29udGV4dDogQXV0aGVudGljYXRlZFF1ZXJ5Q29udGV4dDxQYXJ0aWFsPE1lbWJlckZpbHRlcnM+PixcbikgPT4ge1xuICBjb25zdCBtZW1iZXJzID0gYXdhaXQgbGlzdE1lbWJlcnNGb3JVc2VyKGNvbnRleHQudXNlciwgY29udGV4dC5xdWVyeURhdGEgPz8ge30pO1xuICByZXR1cm4geyBtZW1iZXJzIH07XG59O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlTWVtYmVyQ29udHJvbGxlciA9IGFzeW5jIChcbiAgY29udGV4dDogQXV0aGVudGljYXRlZEJvZHlDb250ZXh0PENyZWF0ZU1lbWJlcklucHV0PixcbikgPT4ge1xuICBpZiAoIWNvbnRleHQuYm9keSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgcmVxdWVzdCBib2R5XCIpO1xuICB9XG5cbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3JlYXRlTWVtYmVyKGNvbnRleHQudXNlciwgY29udGV4dC5ib2R5KTtcblxuICBhd2FpdCByZWNvcmRBdWRpdExvZyh7XG4gICAgcmVxOiBjb250ZXh0LnJlcSxcbiAgICB1c2VyOiBjb250ZXh0LnVzZXIsXG4gICAgYWN0aW9uOiBcIm1lbWJlci5jcmVhdGVcIixcbiAgICBkZXRhaWxzOiB7XG4gICAgICBtZW1iZXJJZDogcmVzdWx0Lm1lbWJlci5pZCxcbiAgICAgIGNodXJjaElkOiByZXN1bHQubWVtYmVyLmNodXJjaD8uaWQgPz8gbnVsbCxcbiAgICAgIGZpcnN0TmFtZTogcmVzdWx0Lm1lbWJlci5maXJzdE5hbWUsXG4gICAgICBsYXN0TmFtZTogcmVzdWx0Lm1lbWJlci5sYXN0TmFtZSxcbiAgICB9LFxuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVNZW1iZXJDb250cm9sbGVyID0gYXN5bmMgKFxuICBjb250ZXh0OiBBdXRoZW50aWNhdGVkQm9keVBhcmFtc0NvbnRleHQ8VXBkYXRlTWVtYmVySW5wdXQsIHsgbWVtYmVySWQ6IHN0cmluZyB9PixcbikgPT4ge1xuICBjb25zdCBtZW1iZXJJZCA9IGNvbnRleHQucGFyYW1zRGF0YT8ubWVtYmVySWQ7XG4gIGlmICghbWVtYmVySWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJNZW1iZXIgaWQgaXMgcmVxdWlyZWRcIik7XG4gIH1cblxuICBjb25zdCBjaGFuZ2VzID0gY29udGV4dC5ib2R5ID8/IHt9O1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCB1cGRhdGVNZW1iZXIoY29udGV4dC51c2VyLCBtZW1iZXJJZCwgY2hhbmdlcyk7XG5cbiAgYXdhaXQgcmVjb3JkQXVkaXRMb2coe1xuICAgIHJlcTogY29udGV4dC5yZXEsXG4gICAgdXNlcjogY29udGV4dC51c2VyLFxuICAgIGFjdGlvbjogXCJtZW1iZXIudXBkYXRlXCIsXG4gICAgZGV0YWlsczoge1xuICAgICAgbWVtYmVySWQsXG4gICAgICBjaHVyY2hJZDogcmVzdWx0Lm1lbWJlci5jaHVyY2g/LmlkID8/IG51bGwsXG4gICAgICBjaGFuZ2VzLFxuICAgIH0sXG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufTtcblxuZXhwb3J0IGNvbnN0IGRlbGV0ZU1lbWJlckNvbnRyb2xsZXIgPSBhc3luYyAoXG4gIGNvbnRleHQ6IEF1dGhlbnRpY2F0ZWRQYXJhbXNDb250ZXh0PHsgbWVtYmVySWQ6IHN0cmluZyB9PixcbikgPT4ge1xuICBjb25zdCBtZW1iZXJJZCA9IGNvbnRleHQucGFyYW1zRGF0YT8ubWVtYmVySWQ7XG4gIGlmICghbWVtYmVySWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJNZW1iZXIgaWQgaXMgcmVxdWlyZWRcIik7XG4gIH1cblxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBkZWxldGVNZW1iZXIoY29udGV4dC51c2VyLCBtZW1iZXJJZCk7XG5cbiAgYXdhaXQgcmVjb3JkQXVkaXRMb2coe1xuICAgIHJlcTogY29udGV4dC5yZXEsXG4gICAgdXNlcjogY29udGV4dC51c2VyLFxuICAgIGFjdGlvbjogXCJtZW1iZXIuZGVsZXRlXCIsXG4gICAgZGV0YWlsczoge1xuICAgICAgbWVtYmVySWQsXG4gICAgfSxcbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0TWVtYmVyUGFzc0NvbnRyb2xsZXIgPSBhc3luYyAoXG4gIGNvbnRleHQ6IEF1dGhlbnRpY2F0ZWRQYXJhbXNDb250ZXh0PHsgbWVtYmVySWQ6IHN0cmluZyB9PixcbikgPT4ge1xuICBjb25zdCBtZW1iZXJJZCA9IGNvbnRleHQucGFyYW1zRGF0YT8ubWVtYmVySWQ7XG4gIGlmICghbWVtYmVySWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJNZW1iZXIgaWQgaXMgcmVxdWlyZWRcIik7XG4gIH1cblxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRNZW1iZXJQYXNzRm9yVXNlcihjb250ZXh0LnVzZXIsIG1lbWJlcklkKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG4iXSwibmFtZXMiOlsiY3JlYXRlTWVtYmVyIiwiZGVsZXRlTWVtYmVyIiwiZ2V0TWVtYmVyUGFzc0ZvclVzZXIiLCJsaXN0TWVtYmVyc0ZvclVzZXIiLCJ1cGRhdGVNZW1iZXIiLCJyZWNvcmRBdWRpdExvZyIsImxpc3RNZW1iZXJzQ29udHJvbGxlciIsImNvbnRleHQiLCJtZW1iZXJzIiwidXNlciIsInF1ZXJ5RGF0YSIsImNyZWF0ZU1lbWJlckNvbnRyb2xsZXIiLCJib2R5IiwiRXJyb3IiLCJyZXN1bHQiLCJyZXEiLCJhY3Rpb24iLCJkZXRhaWxzIiwibWVtYmVySWQiLCJtZW1iZXIiLCJpZCIsImNodXJjaElkIiwiY2h1cmNoIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJ1cGRhdGVNZW1iZXJDb250cm9sbGVyIiwicGFyYW1zRGF0YSIsImNoYW5nZXMiLCJkZWxldGVNZW1iZXJDb250cm9sbGVyIiwiZ2V0TWVtYmVyUGFzc0NvbnRyb2xsZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/controllers/member.controller.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/email.ts":
/*!**************************!*\
  !*** ./src/lib/email.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getStoredEmails: () => (/* binding */ getStoredEmails),\n/* harmony export */   sendAccountCredentialsEmail: () => (/* binding */ sendAccountCredentialsEmail),\n/* harmony export */   sendEmail: () => (/* binding */ sendEmail),\n/* harmony export */   sendMemberWelcomeEmail: () => (/* binding */ sendMemberWelcomeEmail),\n/* harmony export */   sendPasswordResetEmail: () => (/* binding */ sendPasswordResetEmail)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var nodemailer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! nodemailer */ \"(rsc)/./node_modules/nodemailer/lib/nodemailer.js\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var pdf_lib__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pdf-lib */ \"(rsc)/./node_modules/pdf-lib/es/index.js\");\n/* harmony import */ var _env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./env */ \"(rsc)/./src/lib/env.ts\");\n\n\n\n\n\n\n// Log environment variables for debugging\nconsole.log(\"Email Config:\", {\n    hasUser: !!_env__WEBPACK_IMPORTED_MODULE_5__.env.GMAIL_USER,\n    hasPass: !!_env__WEBPACK_IMPORTED_MODULE_5__.env.GMAIL_APP_PASSWORD,\n    smtpHost: _env__WEBPACK_IMPORTED_MODULE_5__.env.SMTP_HOST,\n    smtpPort: _env__WEBPACK_IMPORTED_MODULE_5__.env.SMTP_PORT,\n    smtpSecure: _env__WEBPACK_IMPORTED_MODULE_5__.env.SMTP_SECURE\n});\nconst devEmailStore = [];\n// Only create transporter if we have the required config\nconst transporter = _env__WEBPACK_IMPORTED_MODULE_5__.env.GMAIL_USER && _env__WEBPACK_IMPORTED_MODULE_5__.env.GMAIL_APP_PASSWORD ? nodemailer__WEBPACK_IMPORTED_MODULE_2__.createTransport({\n    host: _env__WEBPACK_IMPORTED_MODULE_5__.env.SMTP_HOST || \"smtp.gmail.com\",\n    port: _env__WEBPACK_IMPORTED_MODULE_5__.env.SMTP_PORT ? parseInt(_env__WEBPACK_IMPORTED_MODULE_5__.env.SMTP_PORT) : 587,\n    secure: _env__WEBPACK_IMPORTED_MODULE_5__.env.SMTP_SECURE === \"true\",\n    auth: {\n        user: _env__WEBPACK_IMPORTED_MODULE_5__.env.GMAIL_USER,\n        pass: _env__WEBPACK_IMPORTED_MODULE_5__.env.GMAIL_APP_PASSWORD\n    },\n    tls: {\n        rejectUnauthorized: false\n    }\n}) : null;\n// Only verify connection if we have a transporter\nif (transporter) {\n    transporter.verify(function(error) {\n        if (error) {\n            console.error(\"SMTP connection error:\", error);\n        } else {\n            console.log(\"SMTP server is ready to take our messages\");\n        }\n    });\n} else {\n    console.log(\"Running in development mode without email configuration\");\n    console.log(\"Emails will be logged to the console instead of being sent\");\n}\nconst sendEmail = async ({ to, subject, text, html, attachments })=>{\n    // In development without email config, store the email in memory\n    if (!transporter) {\n        console.warn(\"Email not sent - no email configuration. Storing in dev email store.\");\n        devEmailStore.push({\n            to,\n            subject,\n            text,\n            attachments\n        });\n        console.log(\"Dev Email Store:\", devEmailStore);\n        return {\n            success: true,\n            devMode: true,\n            stored: true\n        };\n    }\n    const from = `\"${_env__WEBPACK_IMPORTED_MODULE_5__.env.GMAIL_FROM_NAME || \"Umuganda SDA\"}\" <${_env__WEBPACK_IMPORTED_MODULE_5__.env.GMAIL_USER}>`;\n    try {\n        const info = await transporter.sendMail({\n            from,\n            to,\n            subject,\n            text,\n            html: html || text,\n            attachments\n        });\n        console.log(\"Email sent:\", info.messageId);\n        return {\n            success: true,\n            messageId: info.messageId\n        };\n    } catch (error) {\n        console.error(\"Error sending email:\", error);\n        // In development, still store the email even if sending fails\n        if (true) {\n            devEmailStore.push({\n                to,\n                subject,\n                text,\n                attachments\n            });\n            console.log(\"Email stored in dev store due to error:\", {\n                to,\n                subject\n            });\n            return {\n                success: true,\n                devMode: true,\n                error: \"Email stored in dev mode\",\n                stored: true\n            };\n        }\n        throw new Error(\"Failed to send email\");\n    }\n};\n// Helper to get stored emails in development\nconst getStoredEmails = ()=>[\n        ...devEmailStore\n    ];\nconst sendPasswordResetEmail = async (email, token, expiresInMinutes)=>{\n    const resetLink = `${_env__WEBPACK_IMPORTED_MODULE_5__.env.PRIMARY_ORIGIN || \"http://localhost:3000\"}/reset-password/confirm?token=${encodeURIComponent(token)}`;\n    const subject = \"Password Reset Request\";\n    const text = `\n    You have requested to reset your password for the Umuganda SDA platform.\n    \n    Please click the following link to reset your password (valid for ${expiresInMinutes} minutes):\n    ${resetLink}\n    \n    If you did not request this, please ignore this email.\n  `;\n    const html = `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n      <h2>Password Reset Request</h2>\n      <p>You have requested to reset your password for the Umuganda SDA platform.</p>\n      <p>Please click the button below to reset your password (valid for ${expiresInMinutes} minutes):</p>\n      <div style=\"margin: 25px 0;\">\n        <a href=\"${resetLink}\" \n           style=\"display: inline-block; padding: 10px 20px; background-color: #2d3748; color: white; \n                  text-decoration: none; border-radius: 5px; font-weight: bold;\">\n          Reset Password\n        </a>\n      </div>\n      <p>Or copy and paste this link into your browser:</p>\n      <p style=\"word-break: break-all; color: #3182ce;\">${resetLink}</p>\n      <p>If you did not request this, please ignore this email.</p>\n      <hr style=\"border: none; border-top: 1px solid #e2e8f0; margin: 20px 0;\">\n      <p style=\"font-size: 0.875rem; color: #718096;\">\n        This is an automated message, please do not reply directly to this email.\n      </p>\n    </div>\n  `;\n    return sendEmail({\n        to: email,\n        subject,\n        text,\n        html\n    });\n};\nconst resolveRoleLabel = (role)=>{\n    switch(role){\n        case _prisma_client__WEBPACK_IMPORTED_MODULE_0__.Role.UNION_ADMIN:\n            return \"Union Administrator\";\n        case _prisma_client__WEBPACK_IMPORTED_MODULE_0__.Role.DISTRICT_ADMIN:\n            return \"District Pastor\";\n        case _prisma_client__WEBPACK_IMPORTED_MODULE_0__.Role.CHURCH_ADMIN:\n            return \"Church Administrator\";\n        default:\n            return \"Umuganda SDA account\";\n    }\n};\nconst escapeHtml = (value)=>(value ?? \"\").replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#39;\");\nconst sendAccountCredentialsEmail = async ({ to, role, firstName, username, password })=>{\n    const loginUrl = `${_env__WEBPACK_IMPORTED_MODULE_5__.env.PRIMARY_ORIGIN || \"http://localhost:3000\"}/login`;\n    const roleLabel = resolveRoleLabel(role);\n    const greetingName = firstName?.trim() || \"there\";\n    const subject = `Your ${roleLabel} credentials`;\n    const text = [\n        `Hello ${greetingName},`,\n        \"\",\n        `An Umuganda SDA ${roleLabel.toLowerCase()} account has been created for you.`,\n        `Visit ${loginUrl} and sign in with:`,\n        `Username: ${username}`,\n        `Temporary password: ${password}`,\n        \"\",\n        \"For security, please sign in and change this password immediately.\",\n        \"\",\n        \"If you did not expect this email, contact your administrator.\"\n    ].join(\"\\n\");\n    const html = `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n      <p style=\"font-size: 1rem;\">Hello ${greetingName},</p>\n      <p>An Umuganda SDA ${roleLabel.toLowerCase()} account has been created for you.</p>\n      <p style=\"margin-bottom: 12px;\">Use the credentials below to sign in:</p>\n      <div style=\"background: #f7fafc; padding: 16px; border-radius: 8px; line-height: 1.6;\">\n        <div><strong>Username:</strong> ${username}</div>\n        <div><strong>Temporary password:</strong> ${password}</div>\n      </div>\n      <p style=\"margin: 16px 0;\">Visit <a href=\"${loginUrl}\" style=\"color: #2b6cb0;\">${loginUrl}</a> to sign in and please change this password immediately after logging in.</p>\n      <p style=\"color: #4a5568; font-size: 0.95rem;\">If you did not expect this email, contact your administrator.</p>\n    </div>\n  `;\n    return sendEmail({\n        to,\n        subject,\n        text,\n        html\n    });\n};\nconst logoAssetPath = path__WEBPACK_IMPORTED_MODULE_3___default().resolve(process.cwd(), \"src/assets/sda-logo.png\");\nlet cachedLogoBytes = null;\nconst loadLogoBytes = async ()=>{\n    if (cachedLogoBytes) {\n        return cachedLogoBytes;\n    }\n    try {\n        cachedLogoBytes = await fs__WEBPACK_IMPORTED_MODULE_1__.promises.readFile(logoAssetPath);\n    } catch (error) {\n        console.error(\"Could not load SDA logo for PDF\", error);\n        cachedLogoBytes = null;\n    }\n    return cachedLogoBytes;\n};\nconst hexToRgb = (hex)=>{\n    const normalized = hex.replace(\"#\", \"\");\n    const value = parseInt(normalized, 16);\n    const r = value >> 16 & 255;\n    const g = value >> 8 & 255;\n    const b = value & 255;\n    return (0,pdf_lib__WEBPACK_IMPORTED_MODULE_4__.rgb)(r / 255, g / 255, b / 255);\n};\nconst buildMemberPassPdf = async ({ firstName, lastName, phoneNumber, nationalId, churchName, qrPayload, passToken })=>{\n    const pdfDoc = await pdf_lib__WEBPACK_IMPORTED_MODULE_4__.PDFDocument.create();\n    const pageWidth = 672;\n    const pageHeight = 432;\n    const cardWidth = 576;\n    const cardHeight = 336;\n    const cardX = (pageWidth - cardWidth) / 2;\n    const cardY = (pageHeight - cardHeight) / 2;\n    const midnight = hexToRgb(\"#020617\");\n    const frontHeader = hexToRgb(\"#0f172a\");\n    const frontBorder = hexToRgb(\"#1e293b\");\n    const frontBody = hexToRgb(\"#f8fafc\");\n    const frontText = hexToRgb(\"#1e293b\");\n    const mutedText = hexToRgb(\"#94a3b8\");\n    const slate = hexToRgb(\"#475569\");\n    const highlight = hexToRgb(\"#64748b\");\n    const badgeBlue = hexToRgb(\"#1e3a8a\");\n    const backPanel = hexToRgb(\"#101c3a\");\n    const backSection = hexToRgb(\"#12274f\");\n    const white = (0,pdf_lib__WEBPACK_IMPORTED_MODULE_4__.rgb)(1, 1, 1);\n    const boldFont = await pdfDoc.embedFont(pdf_lib__WEBPACK_IMPORTED_MODULE_4__.StandardFonts.HelveticaBold);\n    const regularFont = await pdfDoc.embedFont(pdf_lib__WEBPACK_IMPORTED_MODULE_4__.StandardFonts.Helvetica);\n    let logoImage = null;\n    try {\n        const logoBytes = await loadLogoBytes();\n        if (logoBytes) {\n            logoImage = await pdfDoc.embedPng(logoBytes);\n        }\n    } catch (logoError) {\n        console.error(\"Could not embed SDA logo\", logoError);\n    }\n    const drawParagraph = (page, text, { x, y, maxWidth, lineHeight, font, size, color })=>{\n        const words = text.split(/\\s+/);\n        const lines = [];\n        let currentLine = \"\";\n        words.forEach((word)=>{\n            const candidate = currentLine ? `${currentLine} ${word}` : word;\n            if (font.widthOfTextAtSize(candidate, size) <= maxWidth) {\n                currentLine = candidate;\n            } else {\n                if (currentLine) {\n                    lines.push(currentLine);\n                }\n                currentLine = word;\n            }\n        });\n        if (currentLine) {\n            lines.push(currentLine);\n        }\n        lines.forEach((line, index)=>{\n            page.drawText(line, {\n                x,\n                y: y - index * lineHeight,\n                size,\n                font,\n                color\n            });\n        });\n        const totalHeight = (lines.length - 1) * lineHeight;\n        return y - totalHeight;\n    };\n    const initials = `${(firstName?.[0] ?? \"\").toUpperCase()}${(lastName?.[0] ?? \"\").toUpperCase()}`.trim() || \"RM\";\n    const displayName = `${firstName ?? \"\"} ${lastName ?? \"\"}`.trim() || \"Umuganda Member\";\n    const churchLabel = churchName ?? \"Church assignment pending\";\n    const phoneLabel = phoneNumber || \"Not provided\";\n    const qrData = qrPayload.startsWith(\"data:image\") ? qrPayload.split(\",\")[1] : null;\n    const drawFrontCard = async (page)=>{\n        page.drawRectangle({\n            x: 0,\n            y: 0,\n            width: pageWidth,\n            height: pageHeight,\n            color: midnight\n        });\n        page.drawRectangle({\n            x: cardX,\n            y: cardY,\n            width: cardWidth,\n            height: cardHeight,\n            color: frontBody,\n            borderColor: frontBorder,\n            borderWidth: 1.2,\n            opacity: 0.98\n        });\n        const headerHeight = 80;\n        page.drawRectangle({\n            x: cardX,\n            y: cardY + cardHeight - headerHeight,\n            width: cardWidth,\n            height: headerHeight,\n            color: frontHeader\n        });\n        let headerTextX = cardX + 36;\n        const headerTextY = cardY + cardHeight - headerHeight / 2 + 8;\n        if (logoImage) {\n            const targetHeight = 44;\n            const targetWidth = logoImage.width / logoImage.height * targetHeight;\n            page.drawImage(logoImage, {\n                x: cardX + 32,\n                y: headerTextY - targetHeight / 2,\n                width: targetWidth,\n                height: targetHeight\n            });\n            headerTextX += targetWidth + 24;\n        }\n        page.drawText(\"RWANDA UNION MISSION\", {\n            x: headerTextX,\n            y: headerTextY + 14,\n            size: 20,\n            font: boldFont,\n            color: white\n        });\n        page.drawText(\"OFFICIAL UMUGANDA PASS\", {\n            x: headerTextX,\n            y: headerTextY - 10,\n            size: 12,\n            font: regularFont,\n            color: mutedText\n        });\n        const leftColumnX = cardX + 40;\n        const contentTop = cardY + cardHeight - headerHeight - 40;\n        const badgeRadius = 40;\n        const badgeCenterX = leftColumnX + badgeRadius;\n        const badgeCenterY = contentTop - badgeRadius + 6;\n        page.drawCircle({\n            x: badgeCenterX,\n            y: badgeCenterY,\n            size: badgeRadius,\n            color: badgeBlue\n        });\n        const initialsWidth = boldFont.widthOfTextAtSize(initials, 22);\n        page.drawText(initials, {\n            x: badgeCenterX - initialsWidth / 2,\n            y: badgeCenterY - 8,\n            size: 22,\n            font: boldFont,\n            color: white\n        });\n        const nameX = leftColumnX + badgeRadius * 2 + 24;\n        page.drawText(displayName, {\n            x: nameX,\n            y: contentTop - 6,\n            size: 20,\n            font: boldFont,\n            color: frontText\n        });\n        page.drawText(\"Community Service Member\", {\n            x: nameX,\n            y: contentTop - 28,\n            size: 12,\n            font: regularFont,\n            color: highlight\n        });\n        const detailStartY = contentTop - 60;\n        const lineSpacing = 30;\n        const detailLabels = [\n            {\n                label: \"Church\",\n                value: churchLabel\n            },\n            {\n                label: \"National ID\",\n                value: nationalId || \"Not provided\"\n            },\n            {\n                label: \"Phone number\",\n                value: phoneLabel\n            },\n            {\n                label: \"Member pass\",\n                value: passToken\n            }\n        ];\n        detailLabels.forEach(({ label, value }, index)=>{\n            const y = detailStartY - lineSpacing * index;\n            page.drawText(label.toUpperCase(), {\n                x: leftColumnX,\n                y,\n                size: 10,\n                font: boldFont,\n                color: highlight\n            });\n            page.drawText(value, {\n                x: leftColumnX,\n                y: y - 16,\n                size: 13,\n                font: regularFont,\n                color: frontText\n            });\n        });\n        const qrBoxWidth = 190;\n        const qrBoxHeight = 190;\n        const qrBoxX = cardX + cardWidth - qrBoxWidth - 48;\n        const qrBoxY = cardY + 68;\n        page.drawRectangle({\n            x: qrBoxX,\n            y: qrBoxY,\n            width: qrBoxWidth,\n            height: qrBoxHeight,\n            color: white,\n            borderColor: mutedText,\n            borderWidth: 1,\n            opacity: 0.92\n        });\n        if (qrData) {\n            try {\n                const qrBytes = Buffer.from(qrData, \"base64\");\n                const qrImage = await pdfDoc.embedPng(qrBytes);\n                const qrSize = Math.min(qrBoxWidth - 36, qrBoxHeight - 48);\n                page.drawImage(qrImage, {\n                    x: qrBoxX + (qrBoxWidth - qrSize) / 2,\n                    y: qrBoxY + (qrBoxHeight - qrSize) / 2 + 12,\n                    width: qrSize,\n                    height: qrSize\n                });\n            } catch (qrError) {\n                console.error(\"Unable to embed QR code in pass PDF\", qrError);\n                page.drawText(\"QR unavailable\", {\n                    x: qrBoxX + 36,\n                    y: qrBoxY + qrBoxHeight / 2,\n                    size: 12,\n                    font: regularFont,\n                    color: mutedText\n                });\n            }\n        } else {\n            page.drawText(\"QR unavailable\", {\n                x: qrBoxX + 36,\n                y: qrBoxY + qrBoxHeight / 2,\n                size: 12,\n                font: regularFont,\n                color: mutedText\n            });\n        }\n        page.drawText(\"OFFICIAL SCAN\", {\n            x: qrBoxX + 54,\n            y: qrBoxY + 16,\n            size: 11,\n            font: boldFont,\n            color: highlight\n        });\n        drawParagraph(page, \"Official Rwanda Union Mission pass. Present with your national ID on Umuganda day. Non-transferable  report misuse, loss, or damage immediately.\", {\n            x: cardX + 40,\n            y: cardY + 44,\n            maxWidth: cardWidth - 80,\n            lineHeight: 12,\n            font: regularFont,\n            size: 10,\n            color: slate\n        });\n    };\n    const drawBackCard = (page)=>{\n        page.drawRectangle({\n            x: 0,\n            y: 0,\n            width: pageWidth,\n            height: pageHeight,\n            color: midnight\n        });\n        page.drawRectangle({\n            x: cardX,\n            y: cardY,\n            width: cardWidth,\n            height: cardHeight,\n            color: backPanel,\n            borderColor: frontBorder,\n            borderWidth: 1.2\n        });\n        page.drawRectangle({\n            x: cardX,\n            y: cardY + cardHeight - 72,\n            width: cardWidth,\n            height: 72,\n            color: frontHeader\n        });\n        let headerTextX = cardX + 36;\n        if (logoImage) {\n            const targetHeight = 40;\n            const targetWidth = logoImage.width / logoImage.height * targetHeight;\n            page.drawImage(logoImage, {\n                x: cardX + 32,\n                y: cardY + cardHeight - 52,\n                width: targetWidth,\n                height: targetHeight\n            });\n            headerTextX += targetWidth + 24;\n        }\n        page.drawText(\"RWANDA UNION MISSION\", {\n            x: headerTextX,\n            y: cardY + cardHeight - 24,\n            size: 18,\n            font: boldFont,\n            color: white\n        });\n        page.drawText(\"Community Service Identification\", {\n            x: cardX + 40,\n            y: cardY + cardHeight - 96,\n            size: 14,\n            font: boldFont,\n            color: white\n        });\n        page.drawText(\"Member Obligations & Verification\", {\n            x: cardX + 40,\n            y: cardY + cardHeight - 116,\n            size: 11,\n            font: regularFont,\n            color: highlight\n        });\n        const columnWidth = (cardWidth - 120) / 2;\n        const columnHeight = 140;\n        const columnY = cardY + cardHeight - 168 - columnHeight;\n        page.drawRectangle({\n            x: cardX + 40,\n            y: columnY,\n            width: columnWidth,\n            height: columnHeight,\n            color: backSection\n        });\n        page.drawRectangle({\n            x: cardX + 80 + columnWidth,\n            y: columnY,\n            width: columnWidth,\n            height: columnHeight,\n            color: backSection\n        });\n        page.drawText(\"Usage Guidelines\", {\n            x: cardX + 48,\n            y: columnY + columnHeight - 24,\n            size: 12,\n            font: boldFont,\n            color: white\n        });\n        drawParagraph(page, \"Carry this pass with your national ID during Umuganda activities. Provide both documents when verification is requested. Keep the pass clean and legible. Damaged credentials must be returned to your church administrator for replacement.\", {\n            x: cardX + 48,\n            y: columnY + columnHeight - 44,\n            maxWidth: columnWidth - 20,\n            lineHeight: 12,\n            font: regularFont,\n            size: 10,\n            color: mutedText\n        });\n        const complianceX = cardX + 88 + columnWidth;\n        page.drawText(\"Compliance Notice\", {\n            x: complianceX,\n            y: columnY + columnHeight - 24,\n            size: 12,\n            font: boldFont,\n            color: white\n        });\n        drawParagraph(page, \"Property of the Seventh-day Adventist Church  Rwanda Union Mission. Any alteration, duplication, lending, or misuse voids this pass and may result in disciplinary or legal action. Update your contact details with your church administrator within 48 hours of any change.\", {\n            x: complianceX,\n            y: columnY + columnHeight - 44,\n            maxWidth: columnWidth - 20,\n            lineHeight: 12,\n            font: regularFont,\n            size: 10,\n            color: mutedText\n        });\n        const contactBlockHeight = 96;\n        const contactY = cardY + 64;\n        page.drawRectangle({\n            x: cardX + 40,\n            y: contactY,\n            width: cardWidth - 80,\n            height: contactBlockHeight,\n            color: backSection\n        });\n        page.drawText(\"Union Contact\", {\n            x: cardX + 52,\n            y: contactY + contactBlockHeight - 26,\n            size: 12,\n            font: boldFont,\n            color: white\n        });\n        page.drawText(\"KN 123 St, Kigali \\xb7 Tel +250 788 000 000\", {\n            x: cardX + 52,\n            y: contactY + contactBlockHeight - 50,\n            size: 11,\n            font: regularFont,\n            color: mutedText\n        });\n        page.drawText(\"support@umuganda.rw \\xb7 Report lost or stolen passes immediately.\", {\n            x: cardX + 52,\n            y: contactY + contactBlockHeight - 70,\n            size: 11,\n            font: regularFont,\n            color: mutedText\n        });\n        page.drawText(\"Keep this credential with your national ID. Return the pass within 7 days if you transfer to another church.\", {\n            x: cardX + 52,\n            y: contactY + 16,\n            size: 10,\n            font: regularFont,\n            color: mutedText\n        });\n    };\n    const frontPage = pdfDoc.addPage([\n        pageWidth,\n        pageHeight\n    ]);\n    await drawFrontCard(frontPage);\n    const backPage = pdfDoc.addPage([\n        pageWidth,\n        pageHeight\n    ]);\n    drawBackCard(backPage);\n    const pdfBytes = await pdfDoc.save();\n    return Buffer.from(pdfBytes);\n};\nconst sendMemberWelcomeEmail = async ({ to, firstName, lastName, phoneNumber, password, nationalId, churchName, loginUrl, passUrl, qrPayload, passToken })=>{\n    const subject = \"Your Umuganda SDA member credentials\";\n    const greeting = firstName?.trim() ? firstName.trim() : \"there\";\n    const text = [\n        `Hello ${greeting},`,\n        \"\",\n        \"Welcome to the Umuganda SDA community service platform.\",\n        \"\",\n        \"Log in using the member portal:\",\n        `Phone number: ${phoneNumber}`,\n        `Password: ${password}`,\n        `Link: ${loginUrl}`,\n        \"\",\n        `National ID: ${nationalId}`,\n        \"\",\n        \"You can always access your digital pass here:\",\n        passUrl,\n        \"\",\n        \"A PDF copy of your official Umuganda pass is attached for printing.\",\n        \"\",\n        \"Keep this information secure and change the password after your first sign-in.\"\n    ].join(\"\\n\");\n    let attachments;\n    try {\n        const pdfBuffer = await buildMemberPassPdf({\n            firstName,\n            lastName,\n            phoneNumber,\n            nationalId,\n            churchName,\n            qrPayload,\n            passToken\n        });\n        attachments = [\n            {\n                filename: `Umuganda-pass-${passToken}.pdf`,\n                content: pdfBuffer,\n                contentType: \"application/pdf\"\n            }\n        ];\n    } catch (pdfError) {\n        console.error(\"Failed to generate member pass PDF\", pdfError);\n    }\n    const html = `\n    <div style=\"font-family:'Segoe UI',Arial,sans-serif;background:#0f172a;padding:32px;color:#e2e8f0;\">\n      <div style=\"max-width:720px;margin:0 auto;background:#0f172a;border-radius:28px;padding:32px;\">\n        <p style=\"margin:0 0 12px 0;font-size:18px;font-weight:600;\">Hello ${escapeHtml(greeting)},</p>\n        <p style=\"margin:0 0 18px 0;font-size:15px;line-height:1.6;color:#cbd5f5;\">\n          Your Umuganda SDA member account has been created by your church administrator. Use the credentials below to sign in\n          and download your digital pass ahead of the next community service day.\n        </p>\n        <div style=\"background:rgba(15,23,42,0.65);border:1px solid rgba(148,163,184,0.35);border-radius:20px;padding:20px 24px;margin-bottom:24px;\">\n          <div style=\"font-size:13px;letter-spacing:0.18em;text-transform:uppercase;color:#94a3b8;font-weight:600;margin-bottom:12px;\">Member credentials</div>\n          <div style=\"display:flex;flex-wrap:wrap;gap:16px;color:#f8fafc;font-size:15px;\">\n            <div style=\"flex:1 1 220px;\">\n              <div style=\"color:#94a3b8;font-size:13px;letter-spacing:0.08em;text-transform:uppercase;margin-bottom:4px;\">Phone number</div>\n              <div style=\"font-weight:600;\">${escapeHtml(phoneNumber)}</div>\n            </div>\n            <div style=\"flex:1 1 220px;\">\n              <div style=\"color:#94a3b8;font-size:13px;letter-spacing:0.08em;text-transform:uppercase;margin-bottom:4px;\">Password</div>\n              <div style=\"font-weight:600;\">${escapeHtml(password)}</div>\n            </div>\n            <div style=\"flex:1 1 220px;\">\n              <div style=\"color:#94a3b8;font-size:13px;letter-spacing:0.18em;text-transform:uppercase;margin-bottom:4px;\">Login link</div>\n              <a href=\"${loginUrl}\" style=\"color:#38bdf8;font-weight:600;text-decoration:none;\">${escapeHtml(loginUrl)}</a>\n            </div>\n          </div>\n          <div style=\"margin-top:18px;font-size:13px;color:#cbd5f5;\">National ID: <strong>${escapeHtml(nationalId)}</strong></div>\n          <div style=\"margin-top:4px;font-size:12px;color:#94a3b8;\">A printable PDF with front and back card layouts is attached.</div>\n        </div>\n        <div style=\"background:rgba(15,23,42,0.45);border-radius:18px;padding:20px 24px;color:#e2e8f0;\">\n          <p style=\"margin:0 0 10px 0;font-size:14px;line-height:1.6;\">\n            Print the attached card on both sides and carry it together with your national ID on Umuganda day. Present both documents\n            when verification is requested.\n          </p>\n          <p style=\"margin:0;font-size:13px;color:#94a3b8;\">\n            If you did not expect this email, contact your church administrator immediately.\n          </p>\n        </div>\n      </div>\n    </div>\n  `;\n    return sendEmail({\n        to,\n        subject,\n        text,\n        html,\n        attachments\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFVOzs7MEZBRzdCLEVBQUVQLFdBQVc0QixZQUFZOzs7Ozs7Ozs7Ozs7OztFQWNqSCxDQUFDO0lBRUQsT0FBTzNELFVBQVU7UUFDZkM7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7SUFDRjtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZGEtYmFja2VuZC8uL3NyYy9saWIvZW1haWwudHM/NGMxOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb2xlIH0gZnJvbSBcIkBwcmlzbWEvY2xpZW50XCI7XG5pbXBvcnQgeyBwcm9taXNlcyBhcyBmcyB9IGZyb20gXCJmc1wiO1xuaW1wb3J0IG5vZGVtYWlsZXIgZnJvbSBcIm5vZGVtYWlsZXJcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBQREZEb2N1bWVudCwgUERGSW1hZ2UsIHJnYiwgU3RhbmRhcmRGb250cyB9IGZyb20gXCJwZGYtbGliXCI7XG5cbmltcG9ydCB7IGVudiB9IGZyb20gXCIuL2VudlwiO1xuXG4vLyBMb2cgZW52aXJvbm1lbnQgdmFyaWFibGVzIGZvciBkZWJ1Z2dpbmdcbmNvbnNvbGUubG9nKCdFbWFpbCBDb25maWc6Jywge1xuICBoYXNVc2VyOiAhIWVudi5HTUFJTF9VU0VSLFxuICBoYXNQYXNzOiAhIWVudi5HTUFJTF9BUFBfUEFTU1dPUkQsXG4gIHNtdHBIb3N0OiBlbnYuU01UUF9IT1NULFxuICBzbXRwUG9ydDogZW52LlNNVFBfUE9SVCxcbiAgc210cFNlY3VyZTogZW52LlNNVFBfU0VDVVJFXG59KTtcblxuLy8gQ3JlYXRlIGEgc2ltcGxlIGluLW1lbW9yeSBlbWFpbCBzdG9yZSBmb3IgZGV2ZWxvcG1lbnRcbnR5cGUgTWFpbEF0dGFjaG1lbnQgPSB7XG4gIGZpbGVuYW1lOiBzdHJpbmc7XG4gIGNvbnRlbnQ6IEJ1ZmZlciB8IHN0cmluZztcbiAgY29udGVudFR5cGU/OiBzdHJpbmc7XG59O1xuXG5jb25zdCBkZXZFbWFpbFN0b3JlOiBBcnJheTx7IHRvOiBzdHJpbmc7IHN1YmplY3Q6IHN0cmluZzsgdGV4dDogc3RyaW5nOyBhdHRhY2htZW50cz86IE1haWxBdHRhY2htZW50W10gfT4gPSBbXTtcblxuLy8gT25seSBjcmVhdGUgdHJhbnNwb3J0ZXIgaWYgd2UgaGF2ZSB0aGUgcmVxdWlyZWQgY29uZmlnXG5jb25zdCB0cmFuc3BvcnRlciA9IGVudi5HTUFJTF9VU0VSICYmIGVudi5HTUFJTF9BUFBfUEFTU1dPUkRcbiAgPyBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgICBob3N0OiBlbnYuU01UUF9IT1NUIHx8ICdzbXRwLmdtYWlsLmNvbScsXG4gICAgICBwb3J0OiBlbnYuU01UUF9QT1JUID8gcGFyc2VJbnQoZW52LlNNVFBfUE9SVCkgOiA1ODcsXG4gICAgICBzZWN1cmU6IGVudi5TTVRQX1NFQ1VSRSA9PT0gJ3RydWUnLFxuICAgICAgYXV0aDoge1xuICAgICAgICB1c2VyOiBlbnYuR01BSUxfVVNFUixcbiAgICAgICAgcGFzczogZW52LkdNQUlMX0FQUF9QQVNTV09SRCxcbiAgICAgIH0sXG4gICAgICB0bHM6IHtcbiAgICAgICAgcmVqZWN0VW5hdXRob3JpemVkOiBmYWxzZVxuICAgICAgfVxuICAgIH0pXG4gIDogbnVsbDtcblxuLy8gT25seSB2ZXJpZnkgY29ubmVjdGlvbiBpZiB3ZSBoYXZlIGEgdHJhbnNwb3J0ZXJcbmlmICh0cmFuc3BvcnRlcikge1xuICB0cmFuc3BvcnRlci52ZXJpZnkoZnVuY3Rpb24oZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1NNVFAgY29ubmVjdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCdTTVRQIHNlcnZlciBpcyByZWFkeSB0byB0YWtlIG91ciBtZXNzYWdlcycpO1xuICAgIH1cbiAgfSk7XG59IGVsc2Uge1xuICBjb25zb2xlLmxvZygnUnVubmluZyBpbiBkZXZlbG9wbWVudCBtb2RlIHdpdGhvdXQgZW1haWwgY29uZmlndXJhdGlvbicpO1xuICBjb25zb2xlLmxvZygnRW1haWxzIHdpbGwgYmUgbG9nZ2VkIHRvIHRoZSBjb25zb2xlIGluc3RlYWQgb2YgYmVpbmcgc2VudCcpO1xufVxuXG50eXBlIFNlbmRNYWlsT3B0aW9ucyA9IHtcbiAgdG86IHN0cmluZztcbiAgc3ViamVjdDogc3RyaW5nO1xuICB0ZXh0OiBzdHJpbmc7XG4gIGh0bWw/OiBzdHJpbmc7XG4gIGF0dGFjaG1lbnRzPzogTWFpbEF0dGFjaG1lbnRbXTtcbn07XG5cbmV4cG9ydCBjb25zdCBzZW5kRW1haWwgPSBhc3luYyAoeyB0bywgc3ViamVjdCwgdGV4dCwgaHRtbCwgYXR0YWNobWVudHMgfTogU2VuZE1haWxPcHRpb25zKSA9PiB7XG4gIC8vIEluIGRldmVsb3BtZW50IHdpdGhvdXQgZW1haWwgY29uZmlnLCBzdG9yZSB0aGUgZW1haWwgaW4gbWVtb3J5XG4gIGlmICghdHJhbnNwb3J0ZXIpIHtcbiAgICBjb25zb2xlLndhcm4oXCJFbWFpbCBub3Qgc2VudCAtIG5vIGVtYWlsIGNvbmZpZ3VyYXRpb24uIFN0b3JpbmcgaW4gZGV2IGVtYWlsIHN0b3JlLlwiKTtcbiAgICBkZXZFbWFpbFN0b3JlLnB1c2goeyB0bywgc3ViamVjdCwgdGV4dCwgYXR0YWNobWVudHMgfSk7XG4gICAgY29uc29sZS5sb2coXCJEZXYgRW1haWwgU3RvcmU6XCIsIGRldkVtYWlsU3RvcmUpO1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRldk1vZGU6IHRydWUsIHN0b3JlZDogdHJ1ZSB9O1xuICB9XG5cbiAgY29uc3QgZnJvbSA9IGBcIiR7ZW52LkdNQUlMX0ZST01fTkFNRSB8fCBcIlVtdWdhbmRhIFNEQVwifVwiIDwke2Vudi5HTUFJTF9VU0VSfT5gO1xuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBpbmZvID0gYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwoe1xuICAgICAgZnJvbSxcbiAgICAgIHRvLFxuICAgICAgc3ViamVjdCxcbiAgICAgIHRleHQsXG4gICAgICBodG1sOiBodG1sIHx8IHRleHQsXG4gICAgICBhdHRhY2htZW50cyxcbiAgICB9KTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnRW1haWwgc2VudDonLCBpbmZvLm1lc3NhZ2VJZCk7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZUlkOiBpbmZvLm1lc3NhZ2VJZCB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgZW1haWw6JywgZXJyb3IpO1xuICAgIFxuICAgIC8vIEluIGRldmVsb3BtZW50LCBzdGlsbCBzdG9yZSB0aGUgZW1haWwgZXZlbiBpZiBzZW5kaW5nIGZhaWxzXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgZGV2RW1haWxTdG9yZS5wdXNoKHsgdG8sIHN1YmplY3QsIHRleHQsIGF0dGFjaG1lbnRzIH0pO1xuICAgICAgY29uc29sZS5sb2coXCJFbWFpbCBzdG9yZWQgaW4gZGV2IHN0b3JlIGR1ZSB0byBlcnJvcjpcIiwgeyB0bywgc3ViamVjdCB9KTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRldk1vZGU6IHRydWUsIGVycm9yOiBcIkVtYWlsIHN0b3JlZCBpbiBkZXYgbW9kZVwiLCBzdG9yZWQ6IHRydWUgfTtcbiAgICB9XG4gICAgXG4gICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gc2VuZCBlbWFpbCcpO1xuICB9XG59O1xuXG4vLyBIZWxwZXIgdG8gZ2V0IHN0b3JlZCBlbWFpbHMgaW4gZGV2ZWxvcG1lbnRcbmV4cG9ydCBjb25zdCBnZXRTdG9yZWRFbWFpbHMgPSAoKSA9PiBbLi4uZGV2RW1haWxTdG9yZV07XG5cbmV4cG9ydCBjb25zdCBzZW5kUGFzc3dvcmRSZXNldEVtYWlsID0gYXN5bmMgKGVtYWlsOiBzdHJpbmcsIHRva2VuOiBzdHJpbmcsIGV4cGlyZXNJbk1pbnV0ZXM6IG51bWJlcikgPT4ge1xuICBjb25zdCByZXNldExpbmsgPSBgJHtlbnYuUFJJTUFSWV9PUklHSU4gfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCd9L3Jlc2V0LXBhc3N3b3JkL2NvbmZpcm0/dG9rZW49JHtlbmNvZGVVUklDb21wb25lbnQodG9rZW4pfWA7XG4gIFxuICBjb25zdCBzdWJqZWN0ID0gJ1Bhc3N3b3JkIFJlc2V0IFJlcXVlc3QnO1xuICBjb25zdCB0ZXh0ID0gYFxuICAgIFlvdSBoYXZlIHJlcXVlc3RlZCB0byByZXNldCB5b3VyIHBhc3N3b3JkIGZvciB0aGUgVW11Z2FuZGEgU0RBIHBsYXRmb3JtLlxuICAgIFxuICAgIFBsZWFzZSBjbGljayB0aGUgZm9sbG93aW5nIGxpbmsgdG8gcmVzZXQgeW91ciBwYXNzd29yZCAodmFsaWQgZm9yICR7ZXhwaXJlc0luTWludXRlc30gbWludXRlcyk6XG4gICAgJHtyZXNldExpbmt9XG4gICAgXG4gICAgSWYgeW91IGRpZCBub3QgcmVxdWVzdCB0aGlzLCBwbGVhc2UgaWdub3JlIHRoaXMgZW1haWwuXG4gIGA7XG4gIFxuICBjb25zdCBodG1sID0gYFxuICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBwYWRkaW5nOiAyMHB4O1wiPlxuICAgICAgPGgyPlBhc3N3b3JkIFJlc2V0IFJlcXVlc3Q8L2gyPlxuICAgICAgPHA+WW91IGhhdmUgcmVxdWVzdGVkIHRvIHJlc2V0IHlvdXIgcGFzc3dvcmQgZm9yIHRoZSBVbXVnYW5kYSBTREEgcGxhdGZvcm0uPC9wPlxuICAgICAgPHA+UGxlYXNlIGNsaWNrIHRoZSBidXR0b24gYmVsb3cgdG8gcmVzZXQgeW91ciBwYXNzd29yZCAodmFsaWQgZm9yICR7ZXhwaXJlc0luTWludXRlc30gbWludXRlcyk6PC9wPlxuICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbjogMjVweCAwO1wiPlxuICAgICAgICA8YSBocmVmPVwiJHtyZXNldExpbmt9XCIgXG4gICAgICAgICAgIHN0eWxlPVwiZGlzcGxheTogaW5saW5lLWJsb2NrOyBwYWRkaW5nOiAxMHB4IDIwcHg7IGJhY2tncm91bmQtY29sb3I6ICMyZDM3NDg7IGNvbG9yOiB3aGl0ZTsgXG4gICAgICAgICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7IGJvcmRlci1yYWRpdXM6IDVweDsgZm9udC13ZWlnaHQ6IGJvbGQ7XCI+XG4gICAgICAgICAgUmVzZXQgUGFzc3dvcmRcbiAgICAgICAgPC9hPlxuICAgICAgPC9kaXY+XG4gICAgICA8cD5PciBjb3B5IGFuZCBwYXN0ZSB0aGlzIGxpbmsgaW50byB5b3VyIGJyb3dzZXI6PC9wPlxuICAgICAgPHAgc3R5bGU9XCJ3b3JkLWJyZWFrOiBicmVhay1hbGw7IGNvbG9yOiAjMzE4MmNlO1wiPiR7cmVzZXRMaW5rfTwvcD5cbiAgICAgIDxwPklmIHlvdSBkaWQgbm90IHJlcXVlc3QgdGhpcywgcGxlYXNlIGlnbm9yZSB0aGlzIGVtYWlsLjwvcD5cbiAgICAgIDxociBzdHlsZT1cImJvcmRlcjogbm9uZTsgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNlMmU4ZjA7IG1hcmdpbjogMjBweCAwO1wiPlxuICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDAuODc1cmVtOyBjb2xvcjogIzcxODA5NjtcIj5cbiAgICAgICAgVGhpcyBpcyBhbiBhdXRvbWF0ZWQgbWVzc2FnZSwgcGxlYXNlIGRvIG5vdCByZXBseSBkaXJlY3RseSB0byB0aGlzIGVtYWlsLlxuICAgICAgPC9wPlxuICAgIDwvZGl2PlxuICBgO1xuICBcbiAgcmV0dXJuIHNlbmRFbWFpbCh7XG4gICAgdG86IGVtYWlsLFxuICAgIHN1YmplY3QsXG4gICAgdGV4dCxcbiAgICBodG1sLFxuICB9KTtcbn07XG5cbmNvbnN0IHJlc29sdmVSb2xlTGFiZWwgPSAocm9sZTogUm9sZSkgPT4ge1xuICBzd2l0Y2ggKHJvbGUpIHtcbiAgICBjYXNlIFJvbGUuVU5JT05fQURNSU46XG4gICAgICByZXR1cm4gJ1VuaW9uIEFkbWluaXN0cmF0b3InO1xuICAgIGNhc2UgUm9sZS5ESVNUUklDVF9BRE1JTjpcbiAgICAgIHJldHVybiAnRGlzdHJpY3QgUGFzdG9yJztcbiAgICBjYXNlIFJvbGUuQ0hVUkNIX0FETUlOOlxuICAgICAgcmV0dXJuICdDaHVyY2ggQWRtaW5pc3RyYXRvcic7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiAnVW11Z2FuZGEgU0RBIGFjY291bnQnO1xuICB9XG59O1xuXG5jb25zdCBlc2NhcGVIdG1sID0gKHZhbHVlOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKSA9PlxuICAodmFsdWUgPz8gXCJcIilcbiAgICAucmVwbGFjZSgvJi9nLCBcIiZhbXA7XCIpXG4gICAgLnJlcGxhY2UoLzwvZywgXCImbHQ7XCIpXG4gICAgLnJlcGxhY2UoLz4vZywgXCImZ3Q7XCIpXG4gICAgLnJlcGxhY2UoL1wiL2csIFwiJnF1b3Q7XCIpXG4gICAgLnJlcGxhY2UoLycvZywgXCImIzM5O1wiKTtcblxudHlwZSBTZW5kQWNjb3VudENyZWRlbnRpYWxzRW1haWxPcHRpb25zID0ge1xuICB0bzogc3RyaW5nO1xuICByb2xlOiBSb2xlO1xuICBmaXJzdE5hbWU/OiBzdHJpbmcgfCBudWxsO1xuICB1c2VybmFtZTogc3RyaW5nO1xuICBwYXNzd29yZDogc3RyaW5nO1xufTtcblxuZXhwb3J0IGNvbnN0IHNlbmRBY2NvdW50Q3JlZGVudGlhbHNFbWFpbCA9IGFzeW5jICh7XG4gIHRvLFxuICByb2xlLFxuICBmaXJzdE5hbWUsXG4gIHVzZXJuYW1lLFxuICBwYXNzd29yZCxcbn06IFNlbmRBY2NvdW50Q3JlZGVudGlhbHNFbWFpbE9wdGlvbnMpID0+IHtcbiAgY29uc3QgbG9naW5VcmwgPSBgJHtlbnYuUFJJTUFSWV9PUklHSU4gfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCd9L2xvZ2luYDtcbiAgY29uc3Qgcm9sZUxhYmVsID0gcmVzb2x2ZVJvbGVMYWJlbChyb2xlKTtcbiAgY29uc3QgZ3JlZXRpbmdOYW1lID0gZmlyc3ROYW1lPy50cmltKCkgfHwgJ3RoZXJlJztcblxuICBjb25zdCBzdWJqZWN0ID0gYFlvdXIgJHtyb2xlTGFiZWx9IGNyZWRlbnRpYWxzYDtcbiAgY29uc3QgdGV4dCA9IFtcbiAgICBgSGVsbG8gJHtncmVldGluZ05hbWV9LGAsXG4gICAgJycsXG4gICAgYEFuIFVtdWdhbmRhIFNEQSAke3JvbGVMYWJlbC50b0xvd2VyQ2FzZSgpfSBhY2NvdW50IGhhcyBiZWVuIGNyZWF0ZWQgZm9yIHlvdS5gLFxuICAgIGBWaXNpdCAke2xvZ2luVXJsfSBhbmQgc2lnbiBpbiB3aXRoOmAsXG4gICAgYFVzZXJuYW1lOiAke3VzZXJuYW1lfWAsXG4gICAgYFRlbXBvcmFyeSBwYXNzd29yZDogJHtwYXNzd29yZH1gLFxuICAgICcnLFxuICAgICdGb3Igc2VjdXJpdHksIHBsZWFzZSBzaWduIGluIGFuZCBjaGFuZ2UgdGhpcyBwYXNzd29yZCBpbW1lZGlhdGVseS4nLFxuICAgICcnLFxuICAgICdJZiB5b3UgZGlkIG5vdCBleHBlY3QgdGhpcyBlbWFpbCwgY29udGFjdCB5b3VyIGFkbWluaXN0cmF0b3IuJyxcbiAgXS5qb2luKCdcXG4nKTtcblxuICBjb25zdCBodG1sID0gYFxuICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBwYWRkaW5nOiAyMHB4O1wiPlxuICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDFyZW07XCI+SGVsbG8gJHtncmVldGluZ05hbWV9LDwvcD5cbiAgICAgIDxwPkFuIFVtdWdhbmRhIFNEQSAke3JvbGVMYWJlbC50b0xvd2VyQ2FzZSgpfSBhY2NvdW50IGhhcyBiZWVuIGNyZWF0ZWQgZm9yIHlvdS48L3A+XG4gICAgICA8cCBzdHlsZT1cIm1hcmdpbi1ib3R0b206IDEycHg7XCI+VXNlIHRoZSBjcmVkZW50aWFscyBiZWxvdyB0byBzaWduIGluOjwvcD5cbiAgICAgIDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kOiAjZjdmYWZjOyBwYWRkaW5nOiAxNnB4OyBib3JkZXItcmFkaXVzOiA4cHg7IGxpbmUtaGVpZ2h0OiAxLjY7XCI+XG4gICAgICAgIDxkaXY+PHN0cm9uZz5Vc2VybmFtZTo8L3N0cm9uZz4gJHt1c2VybmFtZX08L2Rpdj5cbiAgICAgICAgPGRpdj48c3Ryb25nPlRlbXBvcmFyeSBwYXNzd29yZDo8L3N0cm9uZz4gJHtwYXNzd29yZH08L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgPHAgc3R5bGU9XCJtYXJnaW46IDE2cHggMDtcIj5WaXNpdCA8YSBocmVmPVwiJHtsb2dpblVybH1cIiBzdHlsZT1cImNvbG9yOiAjMmI2Y2IwO1wiPiR7bG9naW5Vcmx9PC9hPiB0byBzaWduIGluIGFuZCBwbGVhc2UgY2hhbmdlIHRoaXMgcGFzc3dvcmQgaW1tZWRpYXRlbHkgYWZ0ZXIgbG9nZ2luZyBpbi48L3A+XG4gICAgICA8cCBzdHlsZT1cImNvbG9yOiAjNGE1NTY4OyBmb250LXNpemU6IDAuOTVyZW07XCI+SWYgeW91IGRpZCBub3QgZXhwZWN0IHRoaXMgZW1haWwsIGNvbnRhY3QgeW91ciBhZG1pbmlzdHJhdG9yLjwvcD5cbiAgICA8L2Rpdj5cbiAgYDtcblxuICByZXR1cm4gc2VuZEVtYWlsKHtcbiAgICB0byxcbiAgICBzdWJqZWN0LFxuICAgIHRleHQsXG4gICAgaHRtbCxcbiAgfSk7XG59O1xuXG50eXBlIFNlbmRNZW1iZXJXZWxjb21lRW1haWxPcHRpb25zID0ge1xuICB0bzogc3RyaW5nO1xuICBmaXJzdE5hbWU6IHN0cmluZztcbiAgbGFzdE5hbWU6IHN0cmluZztcbiAgcGhvbmVOdW1iZXI6IHN0cmluZztcbiAgcGFzc3dvcmQ6IHN0cmluZztcbiAgbmF0aW9uYWxJZDogc3RyaW5nO1xuICBjaHVyY2hOYW1lPzogc3RyaW5nIHwgbnVsbDtcbiAgbG9naW5Vcmw6IHN0cmluZztcbiAgcGFzc1VybDogc3RyaW5nO1xuICBxclBheWxvYWQ6IHN0cmluZztcbiAgcGFzc1Rva2VuOiBzdHJpbmc7XG59O1xuXG5jb25zdCBsb2dvQXNzZXRQYXRoID0gcGF0aC5yZXNvbHZlKHByb2Nlc3MuY3dkKCksIFwic3JjL2Fzc2V0cy9zZGEtbG9nby5wbmdcIik7XG5sZXQgY2FjaGVkTG9nb0J5dGVzOiBVaW50OEFycmF5IHwgbnVsbCA9IG51bGw7XG5cbmNvbnN0IGxvYWRMb2dvQnl0ZXMgPSBhc3luYyAoKSA9PiB7XG4gIGlmIChjYWNoZWRMb2dvQnl0ZXMpIHtcbiAgICByZXR1cm4gY2FjaGVkTG9nb0J5dGVzO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjYWNoZWRMb2dvQnl0ZXMgPSBhd2FpdCBmcy5yZWFkRmlsZShsb2dvQXNzZXRQYXRoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiQ291bGQgbm90IGxvYWQgU0RBIGxvZ28gZm9yIFBERlwiLCBlcnJvcik7XG4gICAgY2FjaGVkTG9nb0J5dGVzID0gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBjYWNoZWRMb2dvQnl0ZXM7XG59O1xuXG5jb25zdCBoZXhUb1JnYiA9IChoZXg6IHN0cmluZykgPT4ge1xuICBjb25zdCBub3JtYWxpemVkID0gaGV4LnJlcGxhY2UoXCIjXCIsIFwiXCIpO1xuICBjb25zdCB2YWx1ZSA9IHBhcnNlSW50KG5vcm1hbGl6ZWQsIDE2KTtcblxuICBjb25zdCByID0gKHZhbHVlID4+IDE2KSAmIDI1NTtcbiAgY29uc3QgZyA9ICh2YWx1ZSA+PiA4KSAmIDI1NTtcbiAgY29uc3QgYiA9IHZhbHVlICYgMjU1O1xuXG4gIHJldHVybiByZ2IociAvIDI1NSwgZyAvIDI1NSwgYiAvIDI1NSk7XG59O1xuXG5jb25zdCBidWlsZE1lbWJlclBhc3NQZGYgPSBhc3luYyAoe1xuICBmaXJzdE5hbWUsXG4gIGxhc3ROYW1lLFxuICBwaG9uZU51bWJlcixcbiAgbmF0aW9uYWxJZCxcbiAgY2h1cmNoTmFtZSxcbiAgcXJQYXlsb2FkLFxuICBwYXNzVG9rZW4sXG59OiBQaWNrPFNlbmRNZW1iZXJXZWxjb21lRW1haWxPcHRpb25zLCBcImZpcnN0TmFtZVwiIHwgXCJsYXN0TmFtZVwiIHwgXCJwaG9uZU51bWJlclwiIHwgXCJjaHVyY2hOYW1lXCIgfCBcInFyUGF5bG9hZFwiIHwgXCJwYXNzVG9rZW5cIiB8IFwibmF0aW9uYWxJZFwiPikgPT4ge1xuICBjb25zdCBwZGZEb2MgPSBhd2FpdCBQREZEb2N1bWVudC5jcmVhdGUoKTtcbiAgY29uc3QgcGFnZVdpZHRoID0gNjcyO1xuICBjb25zdCBwYWdlSGVpZ2h0ID0gNDMyO1xuICBjb25zdCBjYXJkV2lkdGggPSA1NzY7XG4gIGNvbnN0IGNhcmRIZWlnaHQgPSAzMzY7XG4gIGNvbnN0IGNhcmRYID0gKHBhZ2VXaWR0aCAtIGNhcmRXaWR0aCkgLyAyO1xuICBjb25zdCBjYXJkWSA9IChwYWdlSGVpZ2h0IC0gY2FyZEhlaWdodCkgLyAyO1xuXG4gIGNvbnN0IG1pZG5pZ2h0ID0gaGV4VG9SZ2IoXCIjMDIwNjE3XCIpO1xuICBjb25zdCBmcm9udEhlYWRlciA9IGhleFRvUmdiKFwiIzBmMTcyYVwiKTtcbiAgY29uc3QgZnJvbnRCb3JkZXIgPSBoZXhUb1JnYihcIiMxZTI5M2JcIik7XG4gIGNvbnN0IGZyb250Qm9keSA9IGhleFRvUmdiKFwiI2Y4ZmFmY1wiKTtcbiAgY29uc3QgZnJvbnRUZXh0ID0gaGV4VG9SZ2IoXCIjMWUyOTNiXCIpO1xuICBjb25zdCBtdXRlZFRleHQgPSBoZXhUb1JnYihcIiM5NGEzYjhcIik7XG4gIGNvbnN0IHNsYXRlID0gaGV4VG9SZ2IoXCIjNDc1NTY5XCIpO1xuICBjb25zdCBoaWdobGlnaHQgPSBoZXhUb1JnYihcIiM2NDc0OGJcIik7XG4gIGNvbnN0IGJhZGdlQmx1ZSA9IGhleFRvUmdiKFwiIzFlM2E4YVwiKTtcbiAgY29uc3QgYmFja1BhbmVsID0gaGV4VG9SZ2IoXCIjMTAxYzNhXCIpO1xuICBjb25zdCBiYWNrU2VjdGlvbiA9IGhleFRvUmdiKFwiIzEyMjc0ZlwiKTtcbiAgY29uc3Qgd2hpdGUgPSByZ2IoMSwgMSwgMSk7XG5cbiAgY29uc3QgYm9sZEZvbnQgPSBhd2FpdCBwZGZEb2MuZW1iZWRGb250KFN0YW5kYXJkRm9udHMuSGVsdmV0aWNhQm9sZCk7XG4gIGNvbnN0IHJlZ3VsYXJGb250ID0gYXdhaXQgcGRmRG9jLmVtYmVkRm9udChTdGFuZGFyZEZvbnRzLkhlbHZldGljYSk7XG5cbiAgbGV0IGxvZ29JbWFnZTogUERGSW1hZ2UgfCBudWxsID0gbnVsbDtcbiAgdHJ5IHtcbiAgICBjb25zdCBsb2dvQnl0ZXMgPSBhd2FpdCBsb2FkTG9nb0J5dGVzKCk7XG4gICAgaWYgKGxvZ29CeXRlcykge1xuICAgICAgbG9nb0ltYWdlID0gYXdhaXQgcGRmRG9jLmVtYmVkUG5nKGxvZ29CeXRlcyk7XG4gICAgfVxuICB9IGNhdGNoIChsb2dvRXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiQ291bGQgbm90IGVtYmVkIFNEQSBsb2dvXCIsIGxvZ29FcnJvcik7XG4gIH1cblxuICBjb25zdCBkcmF3UGFyYWdyYXBoID0gKFxuICAgIHBhZ2U6IFBhcmFtZXRlcnM8dHlwZW9mIHBkZkRvYy5hZGRQYWdlPlswXSBleHRlbmRzIGluZmVyIF9UID8gYW55IDogbmV2ZXIsXG4gICAgdGV4dDogc3RyaW5nLFxuICAgIHtcbiAgICAgIHgsXG4gICAgICB5LFxuICAgICAgbWF4V2lkdGgsXG4gICAgICBsaW5lSGVpZ2h0LFxuICAgICAgZm9udCxcbiAgICAgIHNpemUsXG4gICAgICBjb2xvcixcbiAgICB9OiB7XG4gICAgICB4OiBudW1iZXI7XG4gICAgICB5OiBudW1iZXI7XG4gICAgICBtYXhXaWR0aDogbnVtYmVyO1xuICAgICAgbGluZUhlaWdodDogbnVtYmVyO1xuICAgICAgZm9udDogdHlwZW9mIHJlZ3VsYXJGb250O1xuICAgICAgc2l6ZTogbnVtYmVyO1xuICAgICAgY29sb3I6IFJldHVyblR5cGU8dHlwZW9mIHJnYj47XG4gICAgfSxcbiAgKSA9PiB7XG4gICAgY29uc3Qgd29yZHMgPSB0ZXh0LnNwbGl0KC9cXHMrLyk7XG4gICAgY29uc3QgbGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgbGV0IGN1cnJlbnRMaW5lID0gXCJcIjtcblxuICAgIHdvcmRzLmZvckVhY2goKHdvcmQpID0+IHtcbiAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IGN1cnJlbnRMaW5lID8gYCR7Y3VycmVudExpbmV9ICR7d29yZH1gIDogd29yZDtcbiAgICAgIGlmIChmb250LndpZHRoT2ZUZXh0QXRTaXplKGNhbmRpZGF0ZSwgc2l6ZSkgPD0gbWF4V2lkdGgpIHtcbiAgICAgICAgY3VycmVudExpbmUgPSBjYW5kaWRhdGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoY3VycmVudExpbmUpIHtcbiAgICAgICAgICBsaW5lcy5wdXNoKGN1cnJlbnRMaW5lKTtcbiAgICAgICAgfVxuICAgICAgICBjdXJyZW50TGluZSA9IHdvcmQ7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAoY3VycmVudExpbmUpIHtcbiAgICAgIGxpbmVzLnB1c2goY3VycmVudExpbmUpO1xuICAgIH1cblxuICAgIGxpbmVzLmZvckVhY2goKGxpbmUsIGluZGV4KSA9PiB7XG4gICAgICBwYWdlLmRyYXdUZXh0KGxpbmUsIHtcbiAgICAgICAgeCxcbiAgICAgICAgeTogeSAtIGluZGV4ICogbGluZUhlaWdodCxcbiAgICAgICAgc2l6ZSxcbiAgICAgICAgZm9udCxcbiAgICAgICAgY29sb3IsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHRvdGFsSGVpZ2h0ID0gKGxpbmVzLmxlbmd0aCAtIDEpICogbGluZUhlaWdodDtcbiAgICByZXR1cm4geSAtIHRvdGFsSGVpZ2h0O1xuICB9O1xuXG4gIGNvbnN0IGluaXRpYWxzID0gYCR7KGZpcnN0TmFtZT8uWzBdID8/IFwiXCIpLnRvVXBwZXJDYXNlKCl9JHsobGFzdE5hbWU/LlswXSA/PyBcIlwiKS50b1VwcGVyQ2FzZSgpfWAudHJpbSgpIHx8IFwiUk1cIjtcbiAgY29uc3QgZGlzcGxheU5hbWUgPSBgJHtmaXJzdE5hbWUgPz8gXCJcIn0gJHtsYXN0TmFtZSA/PyBcIlwifWAudHJpbSgpIHx8IFwiVW11Z2FuZGEgTWVtYmVyXCI7XG4gIGNvbnN0IGNodXJjaExhYmVsID0gY2h1cmNoTmFtZSA/PyBcIkNodXJjaCBhc3NpZ25tZW50IHBlbmRpbmdcIjtcbiAgY29uc3QgcGhvbmVMYWJlbCA9IHBob25lTnVtYmVyIHx8IFwiTm90IHByb3ZpZGVkXCI7XG4gIGNvbnN0IHFyRGF0YSA9IHFyUGF5bG9hZC5zdGFydHNXaXRoKFwiZGF0YTppbWFnZVwiKSA/IHFyUGF5bG9hZC5zcGxpdChcIixcIilbMV0gOiBudWxsO1xuXG4gIGNvbnN0IGRyYXdGcm9udENhcmQgPSBhc3luYyAocGFnZTogYW55KSA9PiB7XG4gICAgcGFnZS5kcmF3UmVjdGFuZ2xlKHsgeDogMCwgeTogMCwgd2lkdGg6IHBhZ2VXaWR0aCwgaGVpZ2h0OiBwYWdlSGVpZ2h0LCBjb2xvcjogbWlkbmlnaHQgfSk7XG5cbiAgICBwYWdlLmRyYXdSZWN0YW5nbGUoe1xuICAgICAgeDogY2FyZFgsXG4gICAgICB5OiBjYXJkWSxcbiAgICAgIHdpZHRoOiBjYXJkV2lkdGgsXG4gICAgICBoZWlnaHQ6IGNhcmRIZWlnaHQsXG4gICAgICBjb2xvcjogZnJvbnRCb2R5LFxuICAgICAgYm9yZGVyQ29sb3I6IGZyb250Qm9yZGVyLFxuICAgICAgYm9yZGVyV2lkdGg6IDEuMixcbiAgICAgIG9wYWNpdHk6IDAuOTgsXG4gICAgfSk7XG5cbiAgICBjb25zdCBoZWFkZXJIZWlnaHQgPSA4MDtcbiAgICBwYWdlLmRyYXdSZWN0YW5nbGUoe1xuICAgICAgeDogY2FyZFgsXG4gICAgICB5OiBjYXJkWSArIGNhcmRIZWlnaHQgLSBoZWFkZXJIZWlnaHQsXG4gICAgICB3aWR0aDogY2FyZFdpZHRoLFxuICAgICAgaGVpZ2h0OiBoZWFkZXJIZWlnaHQsXG4gICAgICBjb2xvcjogZnJvbnRIZWFkZXIsXG4gICAgfSk7XG5cbiAgICBsZXQgaGVhZGVyVGV4dFggPSBjYXJkWCArIDM2O1xuICAgIGNvbnN0IGhlYWRlclRleHRZID0gY2FyZFkgKyBjYXJkSGVpZ2h0IC0gaGVhZGVySGVpZ2h0IC8gMiArIDg7XG5cbiAgICBpZiAobG9nb0ltYWdlKSB7XG4gICAgICBjb25zdCB0YXJnZXRIZWlnaHQgPSA0NDtcbiAgICAgIGNvbnN0IHRhcmdldFdpZHRoID0gKGxvZ29JbWFnZS53aWR0aCAvIGxvZ29JbWFnZS5oZWlnaHQpICogdGFyZ2V0SGVpZ2h0O1xuICAgICAgcGFnZS5kcmF3SW1hZ2UobG9nb0ltYWdlLCB7XG4gICAgICAgIHg6IGNhcmRYICsgMzIsXG4gICAgICAgIHk6IGhlYWRlclRleHRZIC0gdGFyZ2V0SGVpZ2h0IC8gMixcbiAgICAgICAgd2lkdGg6IHRhcmdldFdpZHRoLFxuICAgICAgICBoZWlnaHQ6IHRhcmdldEhlaWdodCxcbiAgICAgIH0pO1xuICAgICAgaGVhZGVyVGV4dFggKz0gdGFyZ2V0V2lkdGggKyAyNDtcbiAgICB9XG5cbiAgICBwYWdlLmRyYXdUZXh0KFwiUldBTkRBIFVOSU9OIE1JU1NJT05cIiwge1xuICAgICAgeDogaGVhZGVyVGV4dFgsXG4gICAgICB5OiBoZWFkZXJUZXh0WSArIDE0LFxuICAgICAgc2l6ZTogMjAsXG4gICAgICBmb250OiBib2xkRm9udCxcbiAgICAgIGNvbG9yOiB3aGl0ZSxcbiAgICB9KTtcblxuICAgIHBhZ2UuZHJhd1RleHQoXCJPRkZJQ0lBTCBVTVVHQU5EQSBQQVNTXCIsIHtcbiAgICAgIHg6IGhlYWRlclRleHRYLFxuICAgICAgeTogaGVhZGVyVGV4dFkgLSAxMCxcbiAgICAgIHNpemU6IDEyLFxuICAgICAgZm9udDogcmVndWxhckZvbnQsXG4gICAgICBjb2xvcjogbXV0ZWRUZXh0LFxuICAgIH0pO1xuXG4gICAgY29uc3QgbGVmdENvbHVtblggPSBjYXJkWCArIDQwO1xuICAgIGNvbnN0IGNvbnRlbnRUb3AgPSBjYXJkWSArIGNhcmRIZWlnaHQgLSBoZWFkZXJIZWlnaHQgLSA0MDtcbiAgICBjb25zdCBiYWRnZVJhZGl1cyA9IDQwO1xuICAgIGNvbnN0IGJhZGdlQ2VudGVyWCA9IGxlZnRDb2x1bW5YICsgYmFkZ2VSYWRpdXM7XG4gICAgY29uc3QgYmFkZ2VDZW50ZXJZID0gY29udGVudFRvcCAtIGJhZGdlUmFkaXVzICsgNjtcblxuICAgIHBhZ2UuZHJhd0NpcmNsZSh7IHg6IGJhZGdlQ2VudGVyWCwgeTogYmFkZ2VDZW50ZXJZLCBzaXplOiBiYWRnZVJhZGl1cywgY29sb3I6IGJhZGdlQmx1ZSB9KTtcbiAgICBjb25zdCBpbml0aWFsc1dpZHRoID0gYm9sZEZvbnQud2lkdGhPZlRleHRBdFNpemUoaW5pdGlhbHMsIDIyKTtcbiAgICBwYWdlLmRyYXdUZXh0KGluaXRpYWxzLCB7XG4gICAgICB4OiBiYWRnZUNlbnRlclggLSBpbml0aWFsc1dpZHRoIC8gMixcbiAgICAgIHk6IGJhZGdlQ2VudGVyWSAtIDgsXG4gICAgICBzaXplOiAyMixcbiAgICAgIGZvbnQ6IGJvbGRGb250LFxuICAgICAgY29sb3I6IHdoaXRlLFxuICAgIH0pO1xuXG4gICAgY29uc3QgbmFtZVggPSBsZWZ0Q29sdW1uWCArIGJhZGdlUmFkaXVzICogMiArIDI0O1xuICAgIHBhZ2UuZHJhd1RleHQoZGlzcGxheU5hbWUsIHtcbiAgICAgIHg6IG5hbWVYLFxuICAgICAgeTogY29udGVudFRvcCAtIDYsXG4gICAgICBzaXplOiAyMCxcbiAgICAgIGZvbnQ6IGJvbGRGb250LFxuICAgICAgY29sb3I6IGZyb250VGV4dCxcbiAgICB9KTtcblxuICAgIHBhZ2UuZHJhd1RleHQoXCJDb21tdW5pdHkgU2VydmljZSBNZW1iZXJcIiwge1xuICAgICAgeDogbmFtZVgsXG4gICAgICB5OiBjb250ZW50VG9wIC0gMjgsXG4gICAgICBzaXplOiAxMixcbiAgICAgIGZvbnQ6IHJlZ3VsYXJGb250LFxuICAgICAgY29sb3I6IGhpZ2hsaWdodCxcbiAgICB9KTtcblxuICAgIGNvbnN0IGRldGFpbFN0YXJ0WSA9IGNvbnRlbnRUb3AgLSA2MDtcbiAgICBjb25zdCBsaW5lU3BhY2luZyA9IDMwO1xuICAgIGNvbnN0IGRldGFpbExhYmVsczogQXJyYXk8eyBsYWJlbDogc3RyaW5nOyB2YWx1ZTogc3RyaW5nIH0+ID0gW1xuICAgICAgeyBsYWJlbDogXCJDaHVyY2hcIiwgdmFsdWU6IGNodXJjaExhYmVsIH0sXG4gICAgICB7IGxhYmVsOiBcIk5hdGlvbmFsIElEXCIsIHZhbHVlOiBuYXRpb25hbElkIHx8IFwiTm90IHByb3ZpZGVkXCIgfSxcbiAgICAgIHsgbGFiZWw6IFwiUGhvbmUgbnVtYmVyXCIsIHZhbHVlOiBwaG9uZUxhYmVsIH0sXG4gICAgICB7IGxhYmVsOiBcIk1lbWJlciBwYXNzXCIsIHZhbHVlOiBwYXNzVG9rZW4gfSxcbiAgICBdO1xuXG4gICAgZGV0YWlsTGFiZWxzLmZvckVhY2goKHsgbGFiZWwsIHZhbHVlIH0sIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCB5ID0gZGV0YWlsU3RhcnRZIC0gbGluZVNwYWNpbmcgKiBpbmRleDtcbiAgICAgIHBhZ2UuZHJhd1RleHQobGFiZWwudG9VcHBlckNhc2UoKSwge1xuICAgICAgICB4OiBsZWZ0Q29sdW1uWCxcbiAgICAgICAgeSxcbiAgICAgICAgc2l6ZTogMTAsXG4gICAgICAgIGZvbnQ6IGJvbGRGb250LFxuICAgICAgICBjb2xvcjogaGlnaGxpZ2h0LFxuICAgICAgfSk7XG4gICAgICBwYWdlLmRyYXdUZXh0KHZhbHVlLCB7XG4gICAgICAgIHg6IGxlZnRDb2x1bW5YLFxuICAgICAgICB5OiB5IC0gMTYsXG4gICAgICAgIHNpemU6IDEzLFxuICAgICAgICBmb250OiByZWd1bGFyRm9udCxcbiAgICAgICAgY29sb3I6IGZyb250VGV4dCxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcXJCb3hXaWR0aCA9IDE5MDtcbiAgICBjb25zdCBxckJveEhlaWdodCA9IDE5MDtcbiAgICBjb25zdCBxckJveFggPSBjYXJkWCArIGNhcmRXaWR0aCAtIHFyQm94V2lkdGggLSA0ODtcbiAgICBjb25zdCBxckJveFkgPSBjYXJkWSArIDY4O1xuXG4gICAgcGFnZS5kcmF3UmVjdGFuZ2xlKHtcbiAgICAgIHg6IHFyQm94WCxcbiAgICAgIHk6IHFyQm94WSxcbiAgICAgIHdpZHRoOiBxckJveFdpZHRoLFxuICAgICAgaGVpZ2h0OiBxckJveEhlaWdodCxcbiAgICAgIGNvbG9yOiB3aGl0ZSxcbiAgICAgIGJvcmRlckNvbG9yOiBtdXRlZFRleHQsXG4gICAgICBib3JkZXJXaWR0aDogMSxcbiAgICAgIG9wYWNpdHk6IDAuOTIsXG4gICAgfSk7XG5cbiAgICBpZiAocXJEYXRhKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBxckJ5dGVzID0gQnVmZmVyLmZyb20ocXJEYXRhLCBcImJhc2U2NFwiKTtcbiAgICAgICAgY29uc3QgcXJJbWFnZSA9IGF3YWl0IHBkZkRvYy5lbWJlZFBuZyhxckJ5dGVzKTtcbiAgICAgICAgY29uc3QgcXJTaXplID0gTWF0aC5taW4ocXJCb3hXaWR0aCAtIDM2LCBxckJveEhlaWdodCAtIDQ4KTtcbiAgICAgICAgcGFnZS5kcmF3SW1hZ2UocXJJbWFnZSwge1xuICAgICAgICAgIHg6IHFyQm94WCArIChxckJveFdpZHRoIC0gcXJTaXplKSAvIDIsXG4gICAgICAgICAgeTogcXJCb3hZICsgKHFyQm94SGVpZ2h0IC0gcXJTaXplKSAvIDIgKyAxMixcbiAgICAgICAgICB3aWR0aDogcXJTaXplLFxuICAgICAgICAgIGhlaWdodDogcXJTaXplLFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKHFyRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlVuYWJsZSB0byBlbWJlZCBRUiBjb2RlIGluIHBhc3MgUERGXCIsIHFyRXJyb3IpO1xuICAgICAgICBwYWdlLmRyYXdUZXh0KFwiUVIgdW5hdmFpbGFibGVcIiwge1xuICAgICAgICAgIHg6IHFyQm94WCArIDM2LFxuICAgICAgICAgIHk6IHFyQm94WSArIHFyQm94SGVpZ2h0IC8gMixcbiAgICAgICAgICBzaXplOiAxMixcbiAgICAgICAgICBmb250OiByZWd1bGFyRm9udCxcbiAgICAgICAgICBjb2xvcjogbXV0ZWRUZXh0LFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS5kcmF3VGV4dChcIlFSIHVuYXZhaWxhYmxlXCIsIHtcbiAgICAgICAgeDogcXJCb3hYICsgMzYsXG4gICAgICAgIHk6IHFyQm94WSArIHFyQm94SGVpZ2h0IC8gMixcbiAgICAgICAgc2l6ZTogMTIsXG4gICAgICAgIGZvbnQ6IHJlZ3VsYXJGb250LFxuICAgICAgICBjb2xvcjogbXV0ZWRUZXh0LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcGFnZS5kcmF3VGV4dChcIk9GRklDSUFMIFNDQU5cIiwge1xuICAgICAgeDogcXJCb3hYICsgNTQsXG4gICAgICB5OiBxckJveFkgKyAxNixcbiAgICAgIHNpemU6IDExLFxuICAgICAgZm9udDogYm9sZEZvbnQsXG4gICAgICBjb2xvcjogaGlnaGxpZ2h0LFxuICAgIH0pO1xuXG4gICAgZHJhd1BhcmFncmFwaChwYWdlLCBcIk9mZmljaWFsIFJ3YW5kYSBVbmlvbiBNaXNzaW9uIHBhc3MuIFByZXNlbnQgd2l0aCB5b3VyIG5hdGlvbmFsIElEIG9uIFVtdWdhbmRhIGRheS4gTm9uLXRyYW5zZmVyYWJsZSDigJQgcmVwb3J0IG1pc3VzZSwgbG9zcywgb3IgZGFtYWdlIGltbWVkaWF0ZWx5LlwiLCB7XG4gICAgICB4OiBjYXJkWCArIDQwLFxuICAgICAgeTogY2FyZFkgKyA0NCxcbiAgICAgIG1heFdpZHRoOiBjYXJkV2lkdGggLSA4MCxcbiAgICAgIGxpbmVIZWlnaHQ6IDEyLFxuICAgICAgZm9udDogcmVndWxhckZvbnQsXG4gICAgICBzaXplOiAxMCxcbiAgICAgIGNvbG9yOiBzbGF0ZSxcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBkcmF3QmFja0NhcmQgPSAocGFnZTogYW55KSA9PiB7XG4gICAgcGFnZS5kcmF3UmVjdGFuZ2xlKHsgeDogMCwgeTogMCwgd2lkdGg6IHBhZ2VXaWR0aCwgaGVpZ2h0OiBwYWdlSGVpZ2h0LCBjb2xvcjogbWlkbmlnaHQgfSk7XG5cbiAgICBwYWdlLmRyYXdSZWN0YW5nbGUoe1xuICAgICAgeDogY2FyZFgsXG4gICAgICB5OiBjYXJkWSxcbiAgICAgIHdpZHRoOiBjYXJkV2lkdGgsXG4gICAgICBoZWlnaHQ6IGNhcmRIZWlnaHQsXG4gICAgICBjb2xvcjogYmFja1BhbmVsLFxuICAgICAgYm9yZGVyQ29sb3I6IGZyb250Qm9yZGVyLFxuICAgICAgYm9yZGVyV2lkdGg6IDEuMixcbiAgICB9KTtcblxuICAgIHBhZ2UuZHJhd1JlY3RhbmdsZSh7XG4gICAgICB4OiBjYXJkWCxcbiAgICAgIHk6IGNhcmRZICsgY2FyZEhlaWdodCAtIDcyLFxuICAgICAgd2lkdGg6IGNhcmRXaWR0aCxcbiAgICAgIGhlaWdodDogNzIsXG4gICAgICBjb2xvcjogZnJvbnRIZWFkZXIsXG4gICAgfSk7XG5cbiAgICBsZXQgaGVhZGVyVGV4dFggPSBjYXJkWCArIDM2O1xuICAgIGlmIChsb2dvSW1hZ2UpIHtcbiAgICAgIGNvbnN0IHRhcmdldEhlaWdodCA9IDQwO1xuICAgICAgY29uc3QgdGFyZ2V0V2lkdGggPSAobG9nb0ltYWdlLndpZHRoIC8gbG9nb0ltYWdlLmhlaWdodCkgKiB0YXJnZXRIZWlnaHQ7XG4gICAgICBwYWdlLmRyYXdJbWFnZShsb2dvSW1hZ2UsIHtcbiAgICAgICAgeDogY2FyZFggKyAzMixcbiAgICAgICAgeTogY2FyZFkgKyBjYXJkSGVpZ2h0IC0gNTIsXG4gICAgICAgIHdpZHRoOiB0YXJnZXRXaWR0aCxcbiAgICAgICAgaGVpZ2h0OiB0YXJnZXRIZWlnaHQsXG4gICAgICB9KTtcbiAgICAgIGhlYWRlclRleHRYICs9IHRhcmdldFdpZHRoICsgMjQ7XG4gICAgfVxuXG4gICAgcGFnZS5kcmF3VGV4dChcIlJXQU5EQSBVTklPTiBNSVNTSU9OXCIsIHtcbiAgICAgIHg6IGhlYWRlclRleHRYLFxuICAgICAgeTogY2FyZFkgKyBjYXJkSGVpZ2h0IC0gMjQsXG4gICAgICBzaXplOiAxOCxcbiAgICAgIGZvbnQ6IGJvbGRGb250LFxuICAgICAgY29sb3I6IHdoaXRlLFxuICAgIH0pO1xuXG4gICAgcGFnZS5kcmF3VGV4dChcIkNvbW11bml0eSBTZXJ2aWNlIElkZW50aWZpY2F0aW9uXCIsIHtcbiAgICAgIHg6IGNhcmRYICsgNDAsXG4gICAgICB5OiBjYXJkWSArIGNhcmRIZWlnaHQgLSA5NixcbiAgICAgIHNpemU6IDE0LFxuICAgICAgZm9udDogYm9sZEZvbnQsXG4gICAgICBjb2xvcjogd2hpdGUsXG4gICAgfSk7XG5cbiAgICBwYWdlLmRyYXdUZXh0KFwiTWVtYmVyIE9ibGlnYXRpb25zICYgVmVyaWZpY2F0aW9uXCIsIHtcbiAgICAgIHg6IGNhcmRYICsgNDAsXG4gICAgICB5OiBjYXJkWSArIGNhcmRIZWlnaHQgLSAxMTYsXG4gICAgICBzaXplOiAxMSxcbiAgICAgIGZvbnQ6IHJlZ3VsYXJGb250LFxuICAgICAgY29sb3I6IGhpZ2hsaWdodCxcbiAgICB9KTtcblxuICAgIGNvbnN0IGNvbHVtbldpZHRoID0gKGNhcmRXaWR0aCAtIDEyMCkgLyAyO1xuICAgIGNvbnN0IGNvbHVtbkhlaWdodCA9IDE0MDtcbiAgICBjb25zdCBjb2x1bW5ZID0gY2FyZFkgKyBjYXJkSGVpZ2h0IC0gMTY4IC0gY29sdW1uSGVpZ2h0O1xuXG4gICAgcGFnZS5kcmF3UmVjdGFuZ2xlKHtcbiAgICAgIHg6IGNhcmRYICsgNDAsXG4gICAgICB5OiBjb2x1bW5ZLFxuICAgICAgd2lkdGg6IGNvbHVtbldpZHRoLFxuICAgICAgaGVpZ2h0OiBjb2x1bW5IZWlnaHQsXG4gICAgICBjb2xvcjogYmFja1NlY3Rpb24sXG4gICAgfSk7XG5cbiAgICBwYWdlLmRyYXdSZWN0YW5nbGUoe1xuICAgICAgeDogY2FyZFggKyA4MCArIGNvbHVtbldpZHRoLFxuICAgICAgeTogY29sdW1uWSxcbiAgICAgIHdpZHRoOiBjb2x1bW5XaWR0aCxcbiAgICAgIGhlaWdodDogY29sdW1uSGVpZ2h0LFxuICAgICAgY29sb3I6IGJhY2tTZWN0aW9uLFxuICAgIH0pO1xuXG4gICAgcGFnZS5kcmF3VGV4dChcIlVzYWdlIEd1aWRlbGluZXNcIiwge1xuICAgICAgeDogY2FyZFggKyA0OCxcbiAgICAgIHk6IGNvbHVtblkgKyBjb2x1bW5IZWlnaHQgLSAyNCxcbiAgICAgIHNpemU6IDEyLFxuICAgICAgZm9udDogYm9sZEZvbnQsXG4gICAgICBjb2xvcjogd2hpdGUsXG4gICAgfSk7XG5cbiAgICBkcmF3UGFyYWdyYXBoKHBhZ2UsIFwiQ2FycnkgdGhpcyBwYXNzIHdpdGggeW91ciBuYXRpb25hbCBJRCBkdXJpbmcgVW11Z2FuZGEgYWN0aXZpdGllcy4gUHJvdmlkZSBib3RoIGRvY3VtZW50cyB3aGVuIHZlcmlmaWNhdGlvbiBpcyByZXF1ZXN0ZWQuIEtlZXAgdGhlIHBhc3MgY2xlYW4gYW5kIGxlZ2libGUuIERhbWFnZWQgY3JlZGVudGlhbHMgbXVzdCBiZSByZXR1cm5lZCB0byB5b3VyIGNodXJjaCBhZG1pbmlzdHJhdG9yIGZvciByZXBsYWNlbWVudC5cIiwge1xuICAgICAgeDogY2FyZFggKyA0OCxcbiAgICAgIHk6IGNvbHVtblkgKyBjb2x1bW5IZWlnaHQgLSA0NCxcbiAgICAgIG1heFdpZHRoOiBjb2x1bW5XaWR0aCAtIDIwLFxuICAgICAgbGluZUhlaWdodDogMTIsXG4gICAgICBmb250OiByZWd1bGFyRm9udCxcbiAgICAgIHNpemU6IDEwLFxuICAgICAgY29sb3I6IG11dGVkVGV4dCxcbiAgICB9KTtcblxuICAgIGNvbnN0IGNvbXBsaWFuY2VYID0gY2FyZFggKyA4OCArIGNvbHVtbldpZHRoO1xuICAgIHBhZ2UuZHJhd1RleHQoXCJDb21wbGlhbmNlIE5vdGljZVwiLCB7XG4gICAgICB4OiBjb21wbGlhbmNlWCxcbiAgICAgIHk6IGNvbHVtblkgKyBjb2x1bW5IZWlnaHQgLSAyNCxcbiAgICAgIHNpemU6IDEyLFxuICAgICAgZm9udDogYm9sZEZvbnQsXG4gICAgICBjb2xvcjogd2hpdGUsXG4gICAgfSk7XG5cbiAgICBkcmF3UGFyYWdyYXBoKHBhZ2UsIFwiUHJvcGVydHkgb2YgdGhlIFNldmVudGgtZGF5IEFkdmVudGlzdCBDaHVyY2gg4oCTIFJ3YW5kYSBVbmlvbiBNaXNzaW9uLiBBbnkgYWx0ZXJhdGlvbiwgZHVwbGljYXRpb24sIGxlbmRpbmcsIG9yIG1pc3VzZSB2b2lkcyB0aGlzIHBhc3MgYW5kIG1heSByZXN1bHQgaW4gZGlzY2lwbGluYXJ5IG9yIGxlZ2FsIGFjdGlvbi4gVXBkYXRlIHlvdXIgY29udGFjdCBkZXRhaWxzIHdpdGggeW91ciBjaHVyY2ggYWRtaW5pc3RyYXRvciB3aXRoaW4gNDggaG91cnMgb2YgYW55IGNoYW5nZS5cIiwge1xuICAgICAgeDogY29tcGxpYW5jZVgsXG4gICAgICB5OiBjb2x1bW5ZICsgY29sdW1uSGVpZ2h0IC0gNDQsXG4gICAgICBtYXhXaWR0aDogY29sdW1uV2lkdGggLSAyMCxcbiAgICAgIGxpbmVIZWlnaHQ6IDEyLFxuICAgICAgZm9udDogcmVndWxhckZvbnQsXG4gICAgICBzaXplOiAxMCxcbiAgICAgIGNvbG9yOiBtdXRlZFRleHQsXG4gICAgfSk7XG5cbiAgICBjb25zdCBjb250YWN0QmxvY2tIZWlnaHQgPSA5NjtcbiAgICBjb25zdCBjb250YWN0WSA9IGNhcmRZICsgNjQ7XG4gICAgcGFnZS5kcmF3UmVjdGFuZ2xlKHtcbiAgICAgIHg6IGNhcmRYICsgNDAsXG4gICAgICB5OiBjb250YWN0WSxcbiAgICAgIHdpZHRoOiBjYXJkV2lkdGggLSA4MCxcbiAgICAgIGhlaWdodDogY29udGFjdEJsb2NrSGVpZ2h0LFxuICAgICAgY29sb3I6IGJhY2tTZWN0aW9uLFxuICAgIH0pO1xuXG4gICAgcGFnZS5kcmF3VGV4dChcIlVuaW9uIENvbnRhY3RcIiwge1xuICAgICAgeDogY2FyZFggKyA1MixcbiAgICAgIHk6IGNvbnRhY3RZICsgY29udGFjdEJsb2NrSGVpZ2h0IC0gMjYsXG4gICAgICBzaXplOiAxMixcbiAgICAgIGZvbnQ6IGJvbGRGb250LFxuICAgICAgY29sb3I6IHdoaXRlLFxuICAgIH0pO1xuXG4gICAgcGFnZS5kcmF3VGV4dChcIktOIDEyMyBTdCwgS2lnYWxpIMK3IFRlbCArMjUwIDc4OCAwMDAgMDAwXCIsIHtcbiAgICAgIHg6IGNhcmRYICsgNTIsXG4gICAgICB5OiBjb250YWN0WSArIGNvbnRhY3RCbG9ja0hlaWdodCAtIDUwLFxuICAgICAgc2l6ZTogMTEsXG4gICAgICBmb250OiByZWd1bGFyRm9udCxcbiAgICAgIGNvbG9yOiBtdXRlZFRleHQsXG4gICAgfSk7XG5cbiAgICBwYWdlLmRyYXdUZXh0KFwic3VwcG9ydEB1bXVnYW5kYS5ydyDCtyBSZXBvcnQgbG9zdCBvciBzdG9sZW4gcGFzc2VzIGltbWVkaWF0ZWx5LlwiLCB7XG4gICAgICB4OiBjYXJkWCArIDUyLFxuICAgICAgeTogY29udGFjdFkgKyBjb250YWN0QmxvY2tIZWlnaHQgLSA3MCxcbiAgICAgIHNpemU6IDExLFxuICAgICAgZm9udDogcmVndWxhckZvbnQsXG4gICAgICBjb2xvcjogbXV0ZWRUZXh0LFxuICAgIH0pO1xuXG4gICAgcGFnZS5kcmF3VGV4dChcIktlZXAgdGhpcyBjcmVkZW50aWFsIHdpdGggeW91ciBuYXRpb25hbCBJRC4gUmV0dXJuIHRoZSBwYXNzIHdpdGhpbiA3IGRheXMgaWYgeW91IHRyYW5zZmVyIHRvIGFub3RoZXIgY2h1cmNoLlwiLCB7XG4gICAgICB4OiBjYXJkWCArIDUyLFxuICAgICAgeTogY29udGFjdFkgKyAxNixcbiAgICAgIHNpemU6IDEwLFxuICAgICAgZm9udDogcmVndWxhckZvbnQsXG4gICAgICBjb2xvcjogbXV0ZWRUZXh0LFxuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGZyb250UGFnZSA9IHBkZkRvYy5hZGRQYWdlKFtwYWdlV2lkdGgsIHBhZ2VIZWlnaHRdKTtcbiAgYXdhaXQgZHJhd0Zyb250Q2FyZChmcm9udFBhZ2UpO1xuXG4gIGNvbnN0IGJhY2tQYWdlID0gcGRmRG9jLmFkZFBhZ2UoW3BhZ2VXaWR0aCwgcGFnZUhlaWdodF0pO1xuICBkcmF3QmFja0NhcmQoYmFja1BhZ2UpO1xuXG4gIGNvbnN0IHBkZkJ5dGVzID0gYXdhaXQgcGRmRG9jLnNhdmUoKTtcbiAgcmV0dXJuIEJ1ZmZlci5mcm9tKHBkZkJ5dGVzKTtcbn07XG5cbmV4cG9ydCBjb25zdCBzZW5kTWVtYmVyV2VsY29tZUVtYWlsID0gYXN5bmMgKHtcbiAgdG8sXG4gIGZpcnN0TmFtZSxcbiAgbGFzdE5hbWUsXG4gIHBob25lTnVtYmVyLFxuICBwYXNzd29yZCxcbiAgbmF0aW9uYWxJZCxcbiAgY2h1cmNoTmFtZSxcbiAgbG9naW5VcmwsXG4gIHBhc3NVcmwsXG4gIHFyUGF5bG9hZCxcbiAgcGFzc1Rva2VuLFxufTogU2VuZE1lbWJlcldlbGNvbWVFbWFpbE9wdGlvbnMpID0+IHtcbiAgY29uc3Qgc3ViamVjdCA9IFwiWW91ciBVbXVnYW5kYSBTREEgbWVtYmVyIGNyZWRlbnRpYWxzXCI7XG4gIGNvbnN0IGdyZWV0aW5nID0gZmlyc3ROYW1lPy50cmltKCkgPyBmaXJzdE5hbWUudHJpbSgpIDogXCJ0aGVyZVwiO1xuICBjb25zdCB0ZXh0ID0gW1xuICAgIGBIZWxsbyAke2dyZWV0aW5nfSxgLFxuICAgIFwiXCIsXG4gICAgXCJXZWxjb21lIHRvIHRoZSBVbXVnYW5kYSBTREEgY29tbXVuaXR5IHNlcnZpY2UgcGxhdGZvcm0uXCIsXG4gICAgXCJcIixcbiAgICBcIkxvZyBpbiB1c2luZyB0aGUgbWVtYmVyIHBvcnRhbDpcIixcbiAgICBgUGhvbmUgbnVtYmVyOiAke3Bob25lTnVtYmVyfWAsXG4gICAgYFBhc3N3b3JkOiAke3Bhc3N3b3JkfWAsXG4gICAgYExpbms6ICR7bG9naW5Vcmx9YCxcbiAgICBcIlwiLFxuICAgIGBOYXRpb25hbCBJRDogJHtuYXRpb25hbElkfWAsXG4gICAgXCJcIixcbiAgICBcIllvdSBjYW4gYWx3YXlzIGFjY2VzcyB5b3VyIGRpZ2l0YWwgcGFzcyBoZXJlOlwiLFxuICAgIHBhc3NVcmwsXG4gICAgXCJcIixcbiAgICBcIkEgUERGIGNvcHkgb2YgeW91ciBvZmZpY2lhbCBVbXVnYW5kYSBwYXNzIGlzIGF0dGFjaGVkIGZvciBwcmludGluZy5cIixcbiAgICBcIlwiLFxuICAgIFwiS2VlcCB0aGlzIGluZm9ybWF0aW9uIHNlY3VyZSBhbmQgY2hhbmdlIHRoZSBwYXNzd29yZCBhZnRlciB5b3VyIGZpcnN0IHNpZ24taW4uXCIsXG4gIF0uam9pbihcIlxcblwiKTtcblxuICBsZXQgYXR0YWNobWVudHM6IE1haWxBdHRhY2htZW50W10gfCB1bmRlZmluZWQ7XG4gIHRyeSB7XG4gICAgY29uc3QgcGRmQnVmZmVyID0gYXdhaXQgYnVpbGRNZW1iZXJQYXNzUGRmKHtcbiAgICAgIGZpcnN0TmFtZSxcbiAgICAgIGxhc3ROYW1lLFxuICAgICAgcGhvbmVOdW1iZXIsXG4gICAgICBuYXRpb25hbElkLFxuICAgICAgY2h1cmNoTmFtZSxcbiAgICAgIHFyUGF5bG9hZCxcbiAgICAgIHBhc3NUb2tlbixcbiAgICB9KTtcblxuICAgIGF0dGFjaG1lbnRzID0gW1xuICAgICAge1xuICAgICAgICBmaWxlbmFtZTogYFVtdWdhbmRhLXBhc3MtJHtwYXNzVG9rZW59LnBkZmAsXG4gICAgICAgIGNvbnRlbnQ6IHBkZkJ1ZmZlcixcbiAgICAgICAgY29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vcGRmXCIsXG4gICAgICB9LFxuICAgIF07XG4gIH0gY2F0Y2ggKHBkZkVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBnZW5lcmF0ZSBtZW1iZXIgcGFzcyBQREZcIiwgcGRmRXJyb3IpO1xuICB9XG5cbiAgY29uc3QgaHRtbCA9IGBcbiAgICA8ZGl2IHN0eWxlPVwiZm9udC1mYW1pbHk6J1NlZ29lIFVJJyxBcmlhbCxzYW5zLXNlcmlmO2JhY2tncm91bmQ6IzBmMTcyYTtwYWRkaW5nOjMycHg7Y29sb3I6I2UyZThmMDtcIj5cbiAgICAgIDxkaXYgc3R5bGU9XCJtYXgtd2lkdGg6NzIwcHg7bWFyZ2luOjAgYXV0bztiYWNrZ3JvdW5kOiMwZjE3MmE7Ym9yZGVyLXJhZGl1czoyOHB4O3BhZGRpbmc6MzJweDtcIj5cbiAgICAgICAgPHAgc3R5bGU9XCJtYXJnaW46MCAwIDEycHggMDtmb250LXNpemU6MThweDtmb250LXdlaWdodDo2MDA7XCI+SGVsbG8gJHtlc2NhcGVIdG1sKGdyZWV0aW5nKX0sPC9wPlxuICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjowIDAgMThweCAwO2ZvbnQtc2l6ZToxNXB4O2xpbmUtaGVpZ2h0OjEuNjtjb2xvcjojY2JkNWY1O1wiPlxuICAgICAgICAgIFlvdXIgVW11Z2FuZGEgU0RBIG1lbWJlciBhY2NvdW50IGhhcyBiZWVuIGNyZWF0ZWQgYnkgeW91ciBjaHVyY2ggYWRtaW5pc3RyYXRvci4gVXNlIHRoZSBjcmVkZW50aWFscyBiZWxvdyB0byBzaWduIGluXG4gICAgICAgICAgYW5kIGRvd25sb2FkIHlvdXIgZGlnaXRhbCBwYXNzIGFoZWFkIG9mIHRoZSBuZXh0IGNvbW11bml0eSBzZXJ2aWNlIGRheS5cbiAgICAgICAgPC9wPlxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDpyZ2JhKDE1LDIzLDQyLDAuNjUpO2JvcmRlcjoxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjM1KTtib3JkZXItcmFkaXVzOjIwcHg7cGFkZGluZzoyMHB4IDI0cHg7bWFyZ2luLWJvdHRvbToyNHB4O1wiPlxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJmb250LXNpemU6MTNweDtsZXR0ZXItc3BhY2luZzowLjE4ZW07dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlO2NvbG9yOiM5NGEzYjg7Zm9udC13ZWlnaHQ6NjAwO21hcmdpbi1ib3R0b206MTJweDtcIj5NZW1iZXIgY3JlZGVudGlhbHM8L2Rpdj5cbiAgICAgICAgICA8ZGl2IHN0eWxlPVwiZGlzcGxheTpmbGV4O2ZsZXgtd3JhcDp3cmFwO2dhcDoxNnB4O2NvbG9yOiNmOGZhZmM7Zm9udC1zaXplOjE1cHg7XCI+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZmxleDoxIDEgMjIwcHg7XCI+XG4gICAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJjb2xvcjojOTRhM2I4O2ZvbnQtc2l6ZToxM3B4O2xldHRlci1zcGFjaW5nOjAuMDhlbTt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bWFyZ2luLWJvdHRvbTo0cHg7XCI+UGhvbmUgbnVtYmVyPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJmb250LXdlaWdodDo2MDA7XCI+JHtlc2NhcGVIdG1sKHBob25lTnVtYmVyKX08L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBzdHlsZT1cImZsZXg6MSAxIDIyMHB4O1wiPlxuICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwiY29sb3I6Izk0YTNiODtmb250LXNpemU6MTNweDtsZXR0ZXItc3BhY2luZzowLjA4ZW07dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlO21hcmdpbi1ib3R0b206NHB4O1wiPlBhc3N3b3JkPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJmb250LXdlaWdodDo2MDA7XCI+JHtlc2NhcGVIdG1sKHBhc3N3b3JkKX08L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBzdHlsZT1cImZsZXg6MSAxIDIyMHB4O1wiPlxuICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwiY29sb3I6Izk0YTNiODtmb250LXNpemU6MTNweDtsZXR0ZXItc3BhY2luZzowLjE4ZW07dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlO21hcmdpbi1ib3R0b206NHB4O1wiPkxvZ2luIGxpbms8L2Rpdj5cbiAgICAgICAgICAgICAgPGEgaHJlZj1cIiR7bG9naW5Vcmx9XCIgc3R5bGU9XCJjb2xvcjojMzhiZGY4O2ZvbnQtd2VpZ2h0OjYwMDt0ZXh0LWRlY29yYXRpb246bm9uZTtcIj4ke2VzY2FwZUh0bWwobG9naW5VcmwpfTwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJtYXJnaW4tdG9wOjE4cHg7Zm9udC1zaXplOjEzcHg7Y29sb3I6I2NiZDVmNTtcIj5OYXRpb25hbCBJRDogPHN0cm9uZz4ke2VzY2FwZUh0bWwobmF0aW9uYWxJZCl9PC9zdHJvbmc+PC9kaXY+XG4gICAgICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbi10b3A6NHB4O2ZvbnQtc2l6ZToxMnB4O2NvbG9yOiM5NGEzYjg7XCI+QSBwcmludGFibGUgUERGIHdpdGggZnJvbnQgYW5kIGJhY2sgY2FyZCBsYXlvdXRzIGlzIGF0dGFjaGVkLjwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQ6cmdiYSgxNSwyMyw0MiwwLjQ1KTtib3JkZXItcmFkaXVzOjE4cHg7cGFkZGluZzoyMHB4IDI0cHg7Y29sb3I6I2UyZThmMDtcIj5cbiAgICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjowIDAgMTBweCAwO2ZvbnQtc2l6ZToxNHB4O2xpbmUtaGVpZ2h0OjEuNjtcIj5cbiAgICAgICAgICAgIFByaW50IHRoZSBhdHRhY2hlZCBjYXJkIG9uIGJvdGggc2lkZXMgYW5kIGNhcnJ5IGl0IHRvZ2V0aGVyIHdpdGggeW91ciBuYXRpb25hbCBJRCBvbiBVbXVnYW5kYSBkYXkuIFByZXNlbnQgYm90aCBkb2N1bWVudHNcbiAgICAgICAgICAgIHdoZW4gdmVyaWZpY2F0aW9uIGlzIHJlcXVlc3RlZC5cbiAgICAgICAgICA8L3A+XG4gICAgICAgICAgPHAgc3R5bGU9XCJtYXJnaW46MDtmb250LXNpemU6MTNweDtjb2xvcjojOTRhM2I4O1wiPlxuICAgICAgICAgICAgSWYgeW91IGRpZCBub3QgZXhwZWN0IHRoaXMgZW1haWwsIGNvbnRhY3QgeW91ciBjaHVyY2ggYWRtaW5pc3RyYXRvciBpbW1lZGlhdGVseS5cbiAgICAgICAgICA8L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIGA7XG5cbiAgcmV0dXJuIHNlbmRFbWFpbCh7XG4gICAgdG8sXG4gICAgc3ViamVjdCxcbiAgICB0ZXh0LFxuICAgIGh0bWwsXG4gICAgYXR0YWNobWVudHMsXG4gIH0pO1xufTtcbiJdLCJuYW1lcyI6WyJSb2xlIiwicHJvbWlzZXMiLCJmcyIsIm5vZGVtYWlsZXIiLCJwYXRoIiwiUERGRG9jdW1lbnQiLCJyZ2IiLCJTdGFuZGFyZEZvbnRzIiwiZW52IiwiY29uc29sZSIsImxvZyIsImhhc1VzZXIiLCJHTUFJTF9VU0VSIiwiaGFzUGFzcyIsIkdNQUlMX0FQUF9QQVNTV09SRCIsInNtdHBIb3N0IiwiU01UUF9IT1NUIiwic210cFBvcnQiLCJTTVRQX1BPUlQiLCJzbXRwU2VjdXJlIiwiU01UUF9TRUNVUkUiLCJkZXZFbWFpbFN0b3JlIiwidHJhbnNwb3J0ZXIiLCJjcmVhdGVUcmFuc3BvcnQiLCJob3N0IiwicG9ydCIsInBhcnNlSW50Iiwic2VjdXJlIiwiYXV0aCIsInVzZXIiLCJwYXNzIiwidGxzIiwicmVqZWN0VW5hdXRob3JpemVkIiwidmVyaWZ5IiwiZXJyb3IiLCJzZW5kRW1haWwiLCJ0byIsInN1YmplY3QiLCJ0ZXh0IiwiaHRtbCIsImF0dGFjaG1lbnRzIiwid2FybiIsInB1c2giLCJzdWNjZXNzIiwiZGV2TW9kZSIsInN0b3JlZCIsImZyb20iLCJHTUFJTF9GUk9NX05BTUUiLCJpbmZvIiwic2VuZE1haWwiLCJtZXNzYWdlSWQiLCJwcm9jZXNzIiwiRXJyb3IiLCJnZXRTdG9yZWRFbWFpbHMiLCJzZW5kUGFzc3dvcmRSZXNldEVtYWlsIiwiZW1haWwiLCJ0b2tlbiIsImV4cGlyZXNJbk1pbnV0ZXMiLCJyZXNldExpbmsiLCJQUklNQVJZX09SSUdJTiIsImVuY29kZVVSSUNvbXBvbmVudCIsInJlc29sdmVSb2xlTGFiZWwiLCJyb2xlIiwiVU5JT05fQURNSU4iLCJESVNUUklDVF9BRE1JTiIsIkNIVVJDSF9BRE1JTiIsImVzY2FwZUh0bWwiLCJ2YWx1ZSIsInJlcGxhY2UiLCJzZW5kQWNjb3VudENyZWRlbnRpYWxzRW1haWwiLCJmaXJzdE5hbWUiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwibG9naW5VcmwiLCJyb2xlTGFiZWwiLCJncmVldGluZ05hbWUiLCJ0cmltIiwidG9Mb3dlckNhc2UiLCJqb2luIiwibG9nb0Fzc2V0UGF0aCIsInJlc29sdmUiLCJjd2QiLCJjYWNoZWRMb2dvQnl0ZXMiLCJsb2FkTG9nb0J5dGVzIiwicmVhZEZpbGUiLCJoZXhUb1JnYiIsImhleCIsIm5vcm1hbGl6ZWQiLCJyIiwiZyIsImIiLCJidWlsZE1lbWJlclBhc3NQZGYiLCJsYXN0TmFtZSIsInBob25lTnVtYmVyIiwibmF0aW9uYWxJZCIsImNodXJjaE5hbWUiLCJxclBheWxvYWQiLCJwYXNzVG9rZW4iLCJwZGZEb2MiLCJjcmVhdGUiLCJwYWdlV2lkdGgiLCJwYWdlSGVpZ2h0IiwiY2FyZFdpZHRoIiwiY2FyZEhlaWdodCIsImNhcmRYIiwiY2FyZFkiLCJtaWRuaWdodCIsImZyb250SGVhZGVyIiwiZnJvbnRCb3JkZXIiLCJmcm9udEJvZHkiLCJmcm9udFRleHQiLCJtdXRlZFRleHQiLCJzbGF0ZSIsImhpZ2hsaWdodCIsImJhZGdlQmx1ZSIsImJhY2tQYW5lbCIsImJhY2tTZWN0aW9uIiwid2hpdGUiLCJib2xkRm9udCIsImVtYmVkRm9udCIsIkhlbHZldGljYUJvbGQiLCJyZWd1bGFyRm9udCIsIkhlbHZldGljYSIsImxvZ29JbWFnZSIsImxvZ29CeXRlcyIsImVtYmVkUG5nIiwibG9nb0Vycm9yIiwiZHJhd1BhcmFncmFwaCIsInBhZ2UiLCJ4IiwieSIsIm1heFdpZHRoIiwibGluZUhlaWdodCIsImZvbnQiLCJzaXplIiwiY29sb3IiLCJ3b3JkcyIsInNwbGl0IiwibGluZXMiLCJjdXJyZW50TGluZSIsImZvckVhY2giLCJ3b3JkIiwiY2FuZGlkYXRlIiwid2lkdGhPZlRleHRBdFNpemUiLCJsaW5lIiwiaW5kZXgiLCJkcmF3VGV4dCIsInRvdGFsSGVpZ2h0IiwibGVuZ3RoIiwiaW5pdGlhbHMiLCJ0b1VwcGVyQ2FzZSIsImRpc3BsYXlOYW1lIiwiY2h1cmNoTGFiZWwiLCJwaG9uZUxhYmVsIiwicXJEYXRhIiwic3RhcnRzV2l0aCIsImRyYXdGcm9udENhcmQiLCJkcmF3UmVjdGFuZ2xlIiwid2lkdGgiLCJoZWlnaHQiLCJib3JkZXJDb2xvciIsImJvcmRlcldpZHRoIiwib3BhY2l0eSIsImhlYWRlckhlaWdodCIsImhlYWRlclRleHRYIiwiaGVhZGVyVGV4dFkiLCJ0YXJnZXRIZWlnaHQiLCJ0YXJnZXRXaWR0aCIsImRyYXdJbWFnZSIsImxlZnRDb2x1bW5YIiwiY29udGVudFRvcCIsImJhZGdlUmFkaXVzIiwiYmFkZ2VDZW50ZXJYIiwiYmFkZ2VDZW50ZXJZIiwiZHJhd0NpcmNsZSIsImluaXRpYWxzV2lkdGgiLCJuYW1lWCIsImRldGFpbFN0YXJ0WSIsImxpbmVTcGFjaW5nIiwiZGV0YWlsTGFiZWxzIiwibGFiZWwiLCJxckJveFdpZHRoIiwicXJCb3hIZWlnaHQiLCJxckJveFgiLCJxckJveFkiLCJxckJ5dGVzIiwiQnVmZmVyIiwicXJJbWFnZSIsInFyU2l6ZSIsIk1hdGgiLCJtaW4iLCJxckVycm9yIiwiZHJhd0JhY2tDYXJkIiwiY29sdW1uV2lkdGgiLCJjb2x1bW5IZWlnaHQiLCJjb2x1bW5ZIiwiY29tcGxpYW5jZVgiLCJjb250YWN0QmxvY2tIZWlnaHQiLCJjb250YWN0WSIsImZyb250UGFnZSIsImFkZFBhZ2UiLCJiYWNrUGFnZSIsInBkZkJ5dGVzIiwic2F2ZSIsInNlbmRNZW1iZXJXZWxjb21lRW1haWwiLCJwYXNzVXJsIiwiZ3JlZXRpbmciLCJwZGZCdWZmZXIiLCJmaWxlbmFtZSIsImNvbnRlbnQiLCJjb250ZW50VHlwZSIsInBkZkVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/email.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/env.ts":
/*!************************!*\
  !*** ./src/lib/env.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   env: () => (/* binding */ env)\n/* harmony export */ });\nconst requireEnv = (key)=>{\n    const value = process.env[key];\n    if (!value) {\n        throw new Error(`Missing required environment variable: ${key}`);\n    }\n    return value;\n};\nconst DEFAULT_ORIGIN = \"http://localhost:3000\";\nconst parseOrigins = (value)=>value.split(\",\").map((origin)=>origin.trim()).filter(Boolean);\nconst parsedOrigins = parseOrigins(process.env.CORS_ORIGIN ?? DEFAULT_ORIGIN);\nconst env = {\n    // Required\n    DATABASE_URL: requireEnv(\"DATABASE_URL\"),\n    JWT_SECRET: requireEnv(\"JWT_SECRET\"),\n    // Optional with defaults\n    SMS_API_KEY: process.env.SMS_API_KEY ?? \"\",\n    CORS_ORIGIN: process.env.CORS_ORIGIN ?? DEFAULT_ORIGIN,\n    PRIMARY_ORIGIN: parsedOrigins[0] ?? DEFAULT_ORIGIN,\n    TWILIO_ACCOUNT_SID: process.env.TWILIO_ACCOUNT_SID ?? \"\",\n    TWILIO_AUTH_TOKEN: process.env.TWILIO_AUTH_TOKEN ?? \"\",\n    TWILIO_FROM_NUMBER: process.env.TWILIO_FROM_NUMBER ?? \"\",\n    // Email configuration\n    GMAIL_USER: process.env.GMAIL_USER,\n    GMAIL_APP_PASSWORD: process.env.GMAIL_APP_PASSWORD,\n    GMAIL_FROM_NAME: process.env.GMAIL_FROM_NAME || \"Umuganda SDA\",\n    SMTP_HOST: process.env.SMTP_HOST || \"smtp.gmail.com\",\n    SMTP_PORT: process.env.SMTP_PORT || \"587\",\n    SMTP_SECURE: process.env.SMTP_SECURE || \"false\"\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2Vudi50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsTUFBTUEsYUFBYSxDQUFDQztJQUNsQixNQUFNQyxRQUFRQyxRQUFRQyxHQUFHLENBQUNILElBQUk7SUFDOUIsSUFBSSxDQUFDQyxPQUFPO1FBQ1YsTUFBTSxJQUFJRyxNQUFNLENBQUMsdUNBQXVDLEVBQUVKLElBQUksQ0FBQztJQUNqRTtJQUNBLE9BQU9DO0FBQ1Q7QUFtQkEsTUFBTUksaUJBQWlCO0FBRXZCLE1BQU1DLGVBQWUsQ0FBQ0wsUUFDcEJBLE1BQ0dNLEtBQUssQ0FBQyxLQUNOQyxHQUFHLENBQUMsQ0FBQ0MsU0FBV0EsT0FBT0MsSUFBSSxJQUMzQkMsTUFBTSxDQUFDQztBQUVaLE1BQU1DLGdCQUFnQlAsYUFBYUosUUFBUUMsR0FBRyxDQUFDVyxXQUFXLElBQUlUO0FBRXZELE1BQU1GLE1BQVc7SUFDdEIsV0FBVztJQUNYWSxjQUFjaEIsV0FBVztJQUN6QmlCLFlBQVlqQixXQUFXO0lBRXZCLHlCQUF5QjtJQUN6QmtCLGFBQWFmLFFBQVFDLEdBQUcsQ0FBQ2MsV0FBVyxJQUFJO0lBQ3hDSCxhQUFhWixRQUFRQyxHQUFHLENBQUNXLFdBQVcsSUFBSVQ7SUFDeENhLGdCQUFnQkwsYUFBYSxDQUFDLEVBQUUsSUFBSVI7SUFDcENjLG9CQUFvQmpCLFFBQVFDLEdBQUcsQ0FBQ2dCLGtCQUFrQixJQUFJO0lBQ3REQyxtQkFBbUJsQixRQUFRQyxHQUFHLENBQUNpQixpQkFBaUIsSUFBSTtJQUNwREMsb0JBQW9CbkIsUUFBUUMsR0FBRyxDQUFDa0Isa0JBQWtCLElBQUk7SUFFdEQsc0JBQXNCO0lBQ3RCQyxZQUFZcEIsUUFBUUMsR0FBRyxDQUFDbUIsVUFBVTtJQUNsQ0Msb0JBQW9CckIsUUFBUUMsR0FBRyxDQUFDb0Isa0JBQWtCO0lBQ2xEQyxpQkFBaUJ0QixRQUFRQyxHQUFHLENBQUNxQixlQUFlLElBQUk7SUFDaERDLFdBQVd2QixRQUFRQyxHQUFHLENBQUNzQixTQUFTLElBQUk7SUFDcENDLFdBQVd4QixRQUFRQyxHQUFHLENBQUN1QixTQUFTLElBQUk7SUFDcENDLGFBQWF6QixRQUFRQyxHQUFHLENBQUN3QixXQUFXLElBQUk7QUFDMUMsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NkYS1iYWNrZW5kLy4vc3JjL2xpYi9lbnYudHM/ODQ4NSJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCByZXF1aXJlRW52ID0gKGtleTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgY29uc3QgdmFsdWUgPSBwcm9jZXNzLmVudltrZXldO1xuICBpZiAoIXZhbHVlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlOiAke2tleX1gKTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59O1xuXG50eXBlIEVudiA9IHtcbiAgREFUQUJBU0VfVVJMOiBzdHJpbmc7XG4gIEpXVF9TRUNSRVQ6IHN0cmluZztcbiAgU01TX0FQSV9LRVk6IHN0cmluZztcbiAgQ09SU19PUklHSU46IHN0cmluZztcbiAgUFJJTUFSWV9PUklHSU46IHN0cmluZztcbiAgVFdJTElPX0FDQ09VTlRfU0lEOiBzdHJpbmc7XG4gIFRXSUxJT19BVVRIX1RPS0VOOiBzdHJpbmc7XG4gIFRXSUxJT19GUk9NX05VTUJFUjogc3RyaW5nO1xuICBHTUFJTF9VU0VSPzogc3RyaW5nO1xuICBHTUFJTF9BUFBfUEFTU1dPUkQ/OiBzdHJpbmc7XG4gIEdNQUlMX0ZST01fTkFNRT86IHN0cmluZztcbiAgU01UUF9IT1NUPzogc3RyaW5nO1xuICBTTVRQX1BPUlQ/OiBzdHJpbmc7XG4gIFNNVFBfU0VDVVJFPzogc3RyaW5nO1xufTtcblxuY29uc3QgREVGQVVMVF9PUklHSU4gPSBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiO1xuXG5jb25zdCBwYXJzZU9yaWdpbnMgPSAodmFsdWU6IHN0cmluZyk6IHN0cmluZ1tdID0+XG4gIHZhbHVlXG4gICAgLnNwbGl0KFwiLFwiKVxuICAgIC5tYXAoKG9yaWdpbikgPT4gb3JpZ2luLnRyaW0oKSlcbiAgICAuZmlsdGVyKEJvb2xlYW4pO1xuXG5jb25zdCBwYXJzZWRPcmlnaW5zID0gcGFyc2VPcmlnaW5zKHByb2Nlc3MuZW52LkNPUlNfT1JJR0lOID8/IERFRkFVTFRfT1JJR0lOKTtcblxuZXhwb3J0IGNvbnN0IGVudjogRW52ID0ge1xuICAvLyBSZXF1aXJlZFxuICBEQVRBQkFTRV9VUkw6IHJlcXVpcmVFbnYoXCJEQVRBQkFTRV9VUkxcIiksXG4gIEpXVF9TRUNSRVQ6IHJlcXVpcmVFbnYoXCJKV1RfU0VDUkVUXCIpLFxuICBcbiAgLy8gT3B0aW9uYWwgd2l0aCBkZWZhdWx0c1xuICBTTVNfQVBJX0tFWTogcHJvY2Vzcy5lbnYuU01TX0FQSV9LRVkgPz8gXCJcIixcbiAgQ09SU19PUklHSU46IHByb2Nlc3MuZW52LkNPUlNfT1JJR0lOID8/IERFRkFVTFRfT1JJR0lOLFxuICBQUklNQVJZX09SSUdJTjogcGFyc2VkT3JpZ2luc1swXSA/PyBERUZBVUxUX09SSUdJTixcbiAgVFdJTElPX0FDQ09VTlRfU0lEOiBwcm9jZXNzLmVudi5UV0lMSU9fQUNDT1VOVF9TSUQgPz8gXCJcIixcbiAgVFdJTElPX0FVVEhfVE9LRU46IHByb2Nlc3MuZW52LlRXSUxJT19BVVRIX1RPS0VOID8/IFwiXCIsXG4gIFRXSUxJT19GUk9NX05VTUJFUjogcHJvY2Vzcy5lbnYuVFdJTElPX0ZST01fTlVNQkVSID8/IFwiXCIsXG4gIFxuICAvLyBFbWFpbCBjb25maWd1cmF0aW9uXG4gIEdNQUlMX1VTRVI6IHByb2Nlc3MuZW52LkdNQUlMX1VTRVIsXG4gIEdNQUlMX0FQUF9QQVNTV09SRDogcHJvY2Vzcy5lbnYuR01BSUxfQVBQX1BBU1NXT1JELFxuICBHTUFJTF9GUk9NX05BTUU6IHByb2Nlc3MuZW52LkdNQUlMX0ZST01fTkFNRSB8fCAnVW11Z2FuZGEgU0RBJyxcbiAgU01UUF9IT1NUOiBwcm9jZXNzLmVudi5TTVRQX0hPU1QgfHwgJ3NtdHAuZ21haWwuY29tJyxcbiAgU01UUF9QT1JUOiBwcm9jZXNzLmVudi5TTVRQX1BPUlQgfHwgJzU4NycsXG4gIFNNVFBfU0VDVVJFOiBwcm9jZXNzLmVudi5TTVRQX1NFQ1VSRSB8fCAnZmFsc2UnLFxufTtcbiJdLCJuYW1lcyI6WyJyZXF1aXJlRW52Iiwia2V5IiwidmFsdWUiLCJwcm9jZXNzIiwiZW52IiwiRXJyb3IiLCJERUZBVUxUX09SSUdJTiIsInBhcnNlT3JpZ2lucyIsInNwbGl0IiwibWFwIiwib3JpZ2luIiwidHJpbSIsImZpbHRlciIsIkJvb2xlYW4iLCJwYXJzZWRPcmlnaW5zIiwiQ09SU19PUklHSU4iLCJEQVRBQkFTRV9VUkwiLCJKV1RfU0VDUkVUIiwiU01TX0FQSV9LRVkiLCJQUklNQVJZX09SSUdJTiIsIlRXSUxJT19BQ0NPVU5UX1NJRCIsIlRXSUxJT19BVVRIX1RPS0VOIiwiVFdJTElPX0ZST01fTlVNQkVSIiwiR01BSUxfVVNFUiIsIkdNQUlMX0FQUF9QQVNTV09SRCIsIkdNQUlMX0ZST01fTkFNRSIsIlNNVFBfSE9TVCIsIlNNVFBfUE9SVCIsIlNNVFBfU0VDVVJFIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/env.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/errors.ts":
/*!***************************!*\
  !*** ./src/lib/errors.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppError: () => (/* binding */ AppError),\n/* harmony export */   ConflictError: () => (/* binding */ ConflictError),\n/* harmony export */   ForbiddenError: () => (/* binding */ ForbiddenError),\n/* harmony export */   NotFoundError: () => (/* binding */ NotFoundError),\n/* harmony export */   UnauthorizedError: () => (/* binding */ UnauthorizedError),\n/* harmony export */   ValidationError: () => (/* binding */ ValidationError),\n/* harmony export */   isAppError: () => (/* binding */ isAppError)\n/* harmony export */ });\nclass AppError extends Error {\n    constructor(message, status = 400, details){\n        super(message);\n        this.name = \"AppError\";\n        this.status = status;\n        this.details = details;\n    }\n}\nclass UnauthorizedError extends AppError {\n    constructor(message = \"Unauthorized\"){\n        super(message, 401);\n        this.name = \"UnauthorizedError\";\n    }\n}\nclass ForbiddenError extends AppError {\n    constructor(message = \"Forbidden\"){\n        super(message, 403);\n        this.name = \"ForbiddenError\";\n    }\n}\nclass NotFoundError extends AppError {\n    constructor(message = \"Resource not found\"){\n        super(message, 404);\n        this.name = \"NotFoundError\";\n    }\n}\nclass ConflictError extends AppError {\n    constructor(message = \"Conflict\"){\n        super(message, 409);\n        this.name = \"ConflictError\";\n    }\n}\nclass ValidationError extends AppError {\n    constructor(message = \"Validation failed\", details){\n        super(message, 422, details);\n        this.name = \"ValidationError\";\n    }\n}\nconst isAppError = (error)=>{\n    return error instanceof AppError;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2Vycm9ycy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQU8sTUFBTUEsaUJBQWlCQztJQUk1QkMsWUFBWUMsT0FBZSxFQUFFQyxTQUFTLEdBQUcsRUFBRUMsT0FBaUIsQ0FBRTtRQUM1RCxLQUFLLENBQUNGO1FBQ04sSUFBSSxDQUFDRyxJQUFJLEdBQUc7UUFDWixJQUFJLENBQUNGLE1BQU0sR0FBR0E7UUFDZCxJQUFJLENBQUNDLE9BQU8sR0FBR0E7SUFDakI7QUFDRjtBQUVPLE1BQU1FLDBCQUEwQlA7SUFDckNFLFlBQVlDLFVBQVUsY0FBYyxDQUFFO1FBQ3BDLEtBQUssQ0FBQ0EsU0FBUztRQUNmLElBQUksQ0FBQ0csSUFBSSxHQUFHO0lBQ2Q7QUFDRjtBQUVPLE1BQU1FLHVCQUF1QlI7SUFDbENFLFlBQVlDLFVBQVUsV0FBVyxDQUFFO1FBQ2pDLEtBQUssQ0FBQ0EsU0FBUztRQUNmLElBQUksQ0FBQ0csSUFBSSxHQUFHO0lBQ2Q7QUFDRjtBQUVPLE1BQU1HLHNCQUFzQlQ7SUFDakNFLFlBQVlDLFVBQVUsb0JBQW9CLENBQUU7UUFDMUMsS0FBSyxDQUFDQSxTQUFTO1FBQ2YsSUFBSSxDQUFDRyxJQUFJLEdBQUc7SUFDZDtBQUNGO0FBRU8sTUFBTUksc0JBQXNCVjtJQUNqQ0UsWUFBWUMsVUFBVSxVQUFVLENBQUU7UUFDaEMsS0FBSyxDQUFDQSxTQUFTO1FBQ2YsSUFBSSxDQUFDRyxJQUFJLEdBQUc7SUFDZDtBQUNGO0FBRU8sTUFBTUssd0JBQXdCWDtJQUNuQ0UsWUFBWUMsVUFBVSxtQkFBbUIsRUFBRUUsT0FBaUIsQ0FBRTtRQUM1RCxLQUFLLENBQUNGLFNBQVMsS0FBS0U7UUFDcEIsSUFBSSxDQUFDQyxJQUFJLEdBQUc7SUFDZDtBQUNGO0FBRU8sTUFBTU0sYUFBYSxDQUFDQztJQUN6QixPQUFPQSxpQkFBaUJiO0FBQzFCLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZGEtYmFja2VuZC8uL3NyYy9saWIvZXJyb3JzLnRzPzQ1MWEiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIEFwcEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBzdGF0dXM6IG51bWJlcjtcbiAgZGV0YWlscz86IHVua25vd247XG5cbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBzdGF0dXMgPSA0MDAsIGRldGFpbHM/OiB1bmtub3duKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gXCJBcHBFcnJvclwiO1xuICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzO1xuICAgIHRoaXMuZGV0YWlscyA9IGRldGFpbHM7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFVuYXV0aG9yaXplZEVycm9yIGV4dGVuZHMgQXBwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlID0gXCJVbmF1dGhvcml6ZWRcIikge1xuICAgIHN1cGVyKG1lc3NhZ2UsIDQwMSk7XG4gICAgdGhpcy5uYW1lID0gXCJVbmF1dGhvcml6ZWRFcnJvclwiO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGb3JiaWRkZW5FcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSA9IFwiRm9yYmlkZGVuXCIpIHtcbiAgICBzdXBlcihtZXNzYWdlLCA0MDMpO1xuICAgIHRoaXMubmFtZSA9IFwiRm9yYmlkZGVuRXJyb3JcIjtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTm90Rm91bmRFcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSA9IFwiUmVzb3VyY2Ugbm90IGZvdW5kXCIpIHtcbiAgICBzdXBlcihtZXNzYWdlLCA0MDQpO1xuICAgIHRoaXMubmFtZSA9IFwiTm90Rm91bmRFcnJvclwiO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBDb25mbGljdEVycm9yIGV4dGVuZHMgQXBwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlID0gXCJDb25mbGljdFwiKSB7XG4gICAgc3VwZXIobWVzc2FnZSwgNDA5KTtcbiAgICB0aGlzLm5hbWUgPSBcIkNvbmZsaWN0RXJyb3JcIjtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgVmFsaWRhdGlvbkVycm9yIGV4dGVuZHMgQXBwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlID0gXCJWYWxpZGF0aW9uIGZhaWxlZFwiLCBkZXRhaWxzPzogdW5rbm93bikge1xuICAgIHN1cGVyKG1lc3NhZ2UsIDQyMiwgZGV0YWlscyk7XG4gICAgdGhpcy5uYW1lID0gXCJWYWxpZGF0aW9uRXJyb3JcIjtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgaXNBcHBFcnJvciA9IChlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIEFwcEVycm9yID0+IHtcbiAgcmV0dXJuIGVycm9yIGluc3RhbmNlb2YgQXBwRXJyb3I7XG59O1xuIl0sIm5hbWVzIjpbIkFwcEVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJkZXRhaWxzIiwibmFtZSIsIlVuYXV0aG9yaXplZEVycm9yIiwiRm9yYmlkZGVuRXJyb3IiLCJOb3RGb3VuZEVycm9yIiwiQ29uZmxpY3RFcnJvciIsIlZhbGlkYXRpb25FcnJvciIsImlzQXBwRXJyb3IiLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/errors.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/http.ts":
/*!*************************!*\
  !*** ./src/lib/http.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handleRequest: () => (/* binding */ handleRequest),\n/* harmony export */   jsonResponse: () => (/* binding */ jsonResponse)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/ZodError.js\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/errors */ \"(rsc)/./src/lib/errors.ts\");\n/* harmony import */ var _lib_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/env */ \"(rsc)/./src/lib/env.ts\");\n\n\n\n\nconst jsonResponse = (data, init)=>{\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(data, init);\n};\nconst handleRequest = async (req, handler)=>{\n    // Handle preflight requests\n    if (req.method === \"OPTIONS\") {\n        const response = new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n            status: 204\n        });\n        return applyCors(response, req);\n    }\n    try {\n        const data = await handler();\n        let response;\n        if (data instanceof next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse) {\n            response = data;\n        } else {\n            response = jsonResponse({\n                data\n            });\n        }\n        // Ensure CORS is applied to successful responses\n        return applyCors(response, req);\n    } catch (err) {\n        const error = err;\n        let response;\n        if (error instanceof zod__WEBPACK_IMPORTED_MODULE_3__.ZodError) {\n            const validationError = new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.ValidationError(\"Validation failed\", error.flatten());\n            response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: validationError.message,\n                details: validationError.details\n            }, {\n                status: validationError.status\n            });\n        } else if ((0,_lib_errors__WEBPACK_IMPORTED_MODULE_1__.isAppError)(error)) {\n            response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: error.message,\n                details: error.details\n            }, {\n                status: error.status\n            });\n        } else if (error instanceof Error) {\n            console.error(error);\n            response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Internal Server Error\"\n            }, {\n                status: 500\n            });\n        } else {\n            console.error(\"Unknown error\", error);\n            response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Internal Server Error\"\n            }, {\n                status: 500\n            });\n        }\n        // Ensure CORS is applied to error responses\n        return applyCors(response, req);\n    }\n};\nconst stripQuotes = (origin)=>origin.replace(/^\"|\"$/g, \"\").replace(/^'|'$/g, \"\");\nconst normalizeOrigin = (origin)=>stripQuotes(origin).replace(/\\/$/, \"\");\nconst parseAllowedOrigins = ()=>{\n    if (!_lib_env__WEBPACK_IMPORTED_MODULE_2__.env.CORS_ORIGIN) {\n        return [];\n    }\n    return _lib_env__WEBPACK_IMPORTED_MODULE_2__.env.CORS_ORIGIN.split(\",\").map((value)=>value.trim()).filter(Boolean).map((value)=>normalizeOrigin(value));\n};\nconst applyCors = (response, request)=>{\n    const allowedOrigins = parseAllowedOrigins();\n    if (!allowedOrigins.length) {\n        return response;\n    }\n    const requestOriginHeader = request?.headers.get(\"origin\") ?? null;\n    const requestOrigin = requestOriginHeader ? normalizeOrigin(requestOriginHeader) : null;\n    if (true) {\n        console.log(\"[cors] request origin:\", requestOrigin, \"allowed origins:\", allowedOrigins);\n    }\n    let allowOrigin = null;\n    if (requestOrigin && allowedOrigins.includes(requestOrigin)) {\n        allowOrigin = requestOrigin;\n    } else if (requestOrigin && allowedOrigins.includes(\"*\")) {\n        allowOrigin = requestOrigin;\n    } else if (allowedOrigins.length === 1) {\n        allowOrigin = allowedOrigins[0];\n    }\n    if (!allowOrigin && allowedOrigins.length) {\n        allowOrigin = allowedOrigins[0];\n    }\n    if (true) {\n        console.log(\"[cors] resolved allowOrigin:\", allowOrigin);\n    }\n    if (!allowOrigin) {\n        return response;\n    }\n    response.headers.set(\"Access-Control-Allow-Origin\", allowOrigin);\n    if (true) {\n        console.log(\"[cors] setting Access-Control-Allow-Origin=\", allowOrigin);\n    }\n    const requestedHeaders = request?.headers.get(\"access-control-request-headers\");\n    response.headers.set(\"Access-Control-Allow-Methods\", \"GET,POST,PUT,PATCH,DELETE,OPTIONS\");\n    response.headers.set(\"Access-Control-Allow-Headers\", requestedHeaders && requestedHeaders.length ? requestedHeaders : \"Content-Type,Authorization,Accept\");\n    response.headers.set(\"Access-Control-Allow-Credentials\", \"true\");\n    response.headers.set(\"Access-Control-Max-Age\", \"600\");\n    response.headers.set(\"Vary\", \"Origin\");\n    return response;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MDgzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgWm9kRXJyb3IgfSBmcm9tIFwiem9kXCI7XG5cbmltcG9ydCB7IEFwcEVycm9yLCBpc0FwcEVycm9yLCBWYWxpZGF0aW9uRXJyb3IgfSBmcm9tIFwiQC9saWIvZXJyb3JzXCI7XG5pbXBvcnQgeyBlbnYgfSBmcm9tIFwiQC9saWIvZW52XCI7XG5cbmludGVyZmFjZSBIYW5kbGVyRm48UmV0dXJuVHlwZT4ge1xuICAoKTogUHJvbWlzZTxSZXR1cm5UeXBlPjtcbn1cblxuZXhwb3J0IGNvbnN0IGpzb25SZXNwb25zZSA9IDxUPihkYXRhOiBULCBpbml0PzogUmVzcG9uc2VJbml0KSA9PiB7XG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihkYXRhLCBpbml0KTtcbn07XG5cbmV4cG9ydCBjb25zdCBoYW5kbGVSZXF1ZXN0ID0gYXN5bmMgPFQ+KHJlcTogUmVxdWVzdCwgaGFuZGxlcjogSGFuZGxlckZuPFQ+KSA9PiB7XG4gIC8vIEhhbmRsZSBwcmVmbGlnaHQgcmVxdWVzdHNcbiAgaWYgKHJlcS5tZXRob2QgPT09IFwiT1BUSU9OU1wiKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBuZXcgTmV4dFJlc3BvbnNlKG51bGwsIHsgc3RhdHVzOiAyMDQgfSk7XG4gICAgcmV0dXJuIGFwcGx5Q29ycyhyZXNwb25zZSwgcmVxKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IGhhbmRsZXIoKTtcbiAgICBsZXQgcmVzcG9uc2U6IE5leHRSZXNwb25zZTtcbiAgICBcbiAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIE5leHRSZXNwb25zZSkge1xuICAgICAgcmVzcG9uc2UgPSBkYXRhO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXNwb25zZSA9IGpzb25SZXNwb25zZSh7IGRhdGEgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEVuc3VyZSBDT1JTIGlzIGFwcGxpZWQgdG8gc3VjY2Vzc2Z1bCByZXNwb25zZXNcbiAgICByZXR1cm4gYXBwbHlDb3JzKHJlc3BvbnNlLCByZXEpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zdCBlcnJvciA9IGVyciBhcyB1bmtub3duO1xuICAgIGxldCByZXNwb25zZTogTmV4dFJlc3BvbnNlO1xuXG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgWm9kRXJyb3IpIHtcbiAgICAgIGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IG5ldyBWYWxpZGF0aW9uRXJyb3IoXCJWYWxpZGF0aW9uIGZhaWxlZFwiLCBlcnJvci5mbGF0dGVuKCkpO1xuICAgICAgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAge1xuICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uRXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiB2YWxpZGF0aW9uRXJyb3IuZGV0YWlscyxcbiAgICAgICAgfSxcbiAgICAgICAgeyBzdGF0dXM6IHZhbGlkYXRpb25FcnJvci5zdGF0dXMgfSxcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChpc0FwcEVycm9yKGVycm9yKSkge1xuICAgICAgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAge1xuICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLmRldGFpbHMsXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiBlcnJvci5zdGF0dXMgfSxcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfSxcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJVbmtub3duIGVycm9yXCIsIGVycm9yKTtcbiAgICAgIHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfSxcbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIC8vIEVuc3VyZSBDT1JTIGlzIGFwcGxpZWQgdG8gZXJyb3IgcmVzcG9uc2VzXG4gICAgcmV0dXJuIGFwcGx5Q29ycyhyZXNwb25zZSwgcmVxKTtcbiAgfVxufTtcblxuY29uc3Qgc3RyaXBRdW90ZXMgPSAob3JpZ2luOiBzdHJpbmcpID0+IG9yaWdpbi5yZXBsYWNlKC9eXCJ8XCIkL2csIFwiXCIpLnJlcGxhY2UoL14nfCckL2csIFwiXCIpO1xuXG5jb25zdCBub3JtYWxpemVPcmlnaW4gPSAob3JpZ2luOiBzdHJpbmcpID0+IHN0cmlwUXVvdGVzKG9yaWdpbikucmVwbGFjZSgvXFwvJC8sIFwiXCIpO1xuXG5jb25zdCBwYXJzZUFsbG93ZWRPcmlnaW5zID0gKCkgPT4ge1xuICBpZiAoIWVudi5DT1JTX09SSUdJTikge1xuICAgIHJldHVybiBbXSBhcyBzdHJpbmdbXTtcbiAgfVxuXG4gIHJldHVybiBlbnYuQ09SU19PUklHSU4uc3BsaXQoXCIsXCIpXG4gICAgLm1hcCgodmFsdWUpID0+IHZhbHVlLnRyaW0oKSlcbiAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgLm1hcCgodmFsdWUpID0+IG5vcm1hbGl6ZU9yaWdpbih2YWx1ZSkpO1xufTtcblxuY29uc3QgYXBwbHlDb3JzID0gKHJlc3BvbnNlOiBOZXh0UmVzcG9uc2UsIHJlcXVlc3Q/OiBSZXF1ZXN0KSA9PiB7XG4gIGNvbnN0IGFsbG93ZWRPcmlnaW5zID0gcGFyc2VBbGxvd2VkT3JpZ2lucygpO1xuXG4gIGlmICghYWxsb3dlZE9yaWdpbnMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIHJlc3BvbnNlO1xuICB9XG5cbiAgY29uc3QgcmVxdWVzdE9yaWdpbkhlYWRlciA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwib3JpZ2luXCIpID8/IG51bGw7XG4gIGNvbnN0IHJlcXVlc3RPcmlnaW4gPSByZXF1ZXN0T3JpZ2luSGVhZGVyID8gbm9ybWFsaXplT3JpZ2luKHJlcXVlc3RPcmlnaW5IZWFkZXIpIDogbnVsbDtcblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgY29uc29sZS5sb2coXCJbY29yc10gcmVxdWVzdCBvcmlnaW46XCIsIHJlcXVlc3RPcmlnaW4sIFwiYWxsb3dlZCBvcmlnaW5zOlwiLCBhbGxvd2VkT3JpZ2lucyk7XG4gIH1cblxuICBsZXQgYWxsb3dPcmlnaW46IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gIGlmIChyZXF1ZXN0T3JpZ2luICYmIGFsbG93ZWRPcmlnaW5zLmluY2x1ZGVzKHJlcXVlc3RPcmlnaW4pKSB7XG4gICAgYWxsb3dPcmlnaW4gPSByZXF1ZXN0T3JpZ2luO1xuICB9IGVsc2UgaWYgKHJlcXVlc3RPcmlnaW4gJiYgYWxsb3dlZE9yaWdpbnMuaW5jbHVkZXMoXCIqXCIpKSB7XG4gICAgYWxsb3dPcmlnaW4gPSByZXF1ZXN0T3JpZ2luO1xuICB9IGVsc2UgaWYgKGFsbG93ZWRPcmlnaW5zLmxlbmd0aCA9PT0gMSkge1xuICAgIGFsbG93T3JpZ2luID0gYWxsb3dlZE9yaWdpbnNbMF07XG4gIH1cblxuICBpZiAoIWFsbG93T3JpZ2luICYmIGFsbG93ZWRPcmlnaW5zLmxlbmd0aCkge1xuICAgIGFsbG93T3JpZ2luID0gYWxsb3dlZE9yaWdpbnNbMF07XG4gIH1cblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgY29uc29sZS5sb2coXCJbY29yc10gcmVzb2x2ZWQgYWxsb3dPcmlnaW46XCIsIGFsbG93T3JpZ2luKTtcbiAgfVxuXG4gIGlmICghYWxsb3dPcmlnaW4pIHtcbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cblxuICByZXNwb25zZS5oZWFkZXJzLnNldChcIkFjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpblwiLCBhbGxvd09yaWdpbik7XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIGNvbnNvbGUubG9nKFwiW2NvcnNdIHNldHRpbmcgQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luPVwiLCBhbGxvd09yaWdpbik7XG4gIH1cbiAgY29uc3QgcmVxdWVzdGVkSGVhZGVycyA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwiYWNjZXNzLWNvbnRyb2wtcmVxdWVzdC1oZWFkZXJzXCIpO1xuXG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kc1wiLCBcIkdFVCxQT1NULFBVVCxQQVRDSCxERUxFVEUsT1BUSU9OU1wiKTtcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoXG4gICAgXCJBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzXCIsXG4gICAgcmVxdWVzdGVkSGVhZGVycyAmJiByZXF1ZXN0ZWRIZWFkZXJzLmxlbmd0aFxuICAgICAgPyByZXF1ZXN0ZWRIZWFkZXJzXG4gICAgICA6IFwiQ29udGVudC1UeXBlLEF1dGhvcml6YXRpb24sQWNjZXB0XCIsXG4gICk7XG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctQ3JlZGVudGlhbHNcIiwgXCJ0cnVlXCIpO1xuICByZXNwb25zZS5oZWFkZXJzLnNldChcIkFjY2Vzcy1Db250cm9sLU1heC1BZ2VcIiwgXCI2MDBcIik7XG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KFwiVmFyeVwiLCBcIk9yaWdpblwiKTtcblxuICByZXR1cm4gcmVzcG9uc2U7XG59O1xuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIlpvZEVycm9yIiwiaXNBcHBFcnJvciIsIlZhbGlkYXRpb25FcnJvciIsImVudiIsImpzb25SZXNwb25zZSIsImRhdGEiLCJpbml0IiwianNvbiIsImhhbmRsZVJlcXVlc3QiLCJyZXEiLCJoYW5kbGVyIiwibWV0aG9kIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJhcHBseUNvcnMiLCJlcnIiLCJlcnJvciIsInZhbGlkYXRpb25FcnJvciIsImZsYXR0ZW4iLCJtZXNzYWdlIiwiZGV0YWlscyIsIkVycm9yIiwiY29uc29sZSIsInN0cmlwUXVvdGVzIiwib3JpZ2luIiwicmVwbGFjZSIsIm5vcm1hbGl6ZU9yaWdpbiIsInBhcnNlQWxsb3dlZE9yaWdpbnMiLCJDT1JTX09SSUdJTiIsInNwbGl0IiwibWFwIiwidmFsdWUiLCJ0cmltIiwiZmlsdGVyIiwiQm9vbGVhbiIsInJlcXVlc3QiLCJhbGxvd2VkT3JpZ2lucyIsImxlbmd0aCIsInJlcXVlc3RPcmlnaW5IZWFkZXIiLCJoZWFkZXJzIiwiZ2V0IiwicmVxdWVzdE9yaWdpbiIsInByb2Nlc3MiLCJsb2ciLCJhbGxvd09yaWdpbiIsImluY2x1ZGVzIiwic2V0IiwicmVxdWVzdGVkSGVhZGVycyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/http.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) {\n    globalForPrisma.prisma = prisma;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBOEM7QUFFOUMsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUNYRixnQkFBZ0JFLE1BQU0sSUFDdEIsSUFBSUgsd0RBQVlBLENBQUM7SUFDZkksS0FBS0MsS0FBc0MsR0FBRztRQUFDO1FBQVM7UUFBUztLQUFPLEdBQUcsQ0FBUztBQUN0RixHQUFHO0FBRUwsSUFBSUEsSUFBcUMsRUFBRTtJQUN6Q0osZ0JBQWdCRSxNQUFNLEdBQUdBO0FBQzNCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2RhLWJhY2tlbmQvLi9zcmMvbGliL3ByaXNtYS50cz8wMWQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xuXG5jb25zdCBnbG9iYWxGb3JQcmlzbWEgPSBnbG9iYWxUaGlzIGFzIHVua25vd24gYXMge1xuICBwcmlzbWE/OiBQcmlzbWFDbGllbnQ7XG59O1xuXG5leHBvcnQgY29uc3QgcHJpc21hID1cbiAgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/P1xuICBuZXcgUHJpc21hQ2xpZW50KHtcbiAgICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgPyBbXCJxdWVyeVwiLCBcImVycm9yXCIsIFwid2FyblwiXSA6IFtcImVycm9yXCJdLFxuICB9KTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hO1xufVxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbFRoaXMiLCJwcmlzbWEiLCJsb2ciLCJwcm9jZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/route.ts":
/*!**************************!*\
  !*** ./src/lib/route.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createHandler: () => (/* binding */ createHandler)\n/* harmony export */ });\n/* harmony import */ var _lib_http__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/http */ \"(rsc)/./src/lib/http.ts\");\n\nconst createHandler = ({ middlewares = [], controller })=>{\n    return async (req, ctx)=>{\n        return (0,_lib_http__WEBPACK_IMPORTED_MODULE_0__.handleRequest)(req, async ()=>{\n            const url = new URL(req.url);\n            let context = {\n                req,\n                params: ctx?.params ?? {},\n                query: url.searchParams\n            };\n            for (const middleware of middlewares){\n                context = await middleware(context);\n            }\n            return controller({\n                ...context,\n                params: context.params\n            });\n        });\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQTJDO0FBZ0JwQyxNQUFNQyxnQkFBZ0IsQ0FHM0IsRUFBRUMsY0FBYyxFQUFFLEVBQUVDLFVBQVUsRUFBMkM7SUFDekUsT0FBTyxPQUFPQyxLQUFjQztRQUMxQixPQUFPTCx3REFBYUEsQ0FBQ0ksS0FBSztZQUN4QixNQUFNRSxNQUFNLElBQUlDLElBQUlILElBQUlFLEdBQUc7WUFDM0IsSUFBSUUsVUFBNkI7Z0JBQy9CSjtnQkFDQUssUUFBUUosS0FBS0ksVUFBVSxDQUFDO2dCQUN4QkMsT0FBT0osSUFBSUssWUFBWTtZQUN6QjtZQUVBLEtBQUssTUFBTUMsY0FBY1YsWUFBYTtnQkFDcENNLFVBQVUsTUFBTUksV0FBV0o7WUFDN0I7WUFFQSxPQUFPTCxXQUFXO2dCQUFFLEdBQUdLLE9BQU87Z0JBQUVDLFFBQVFELFFBQVFDLE1BQU07WUFBQztRQUN6RDtJQUNGO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NkYS1iYWNrZW5kLy4vc3JjL2xpYi9yb3V0ZS50cz85ZTgzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGhhbmRsZVJlcXVlc3QgfSBmcm9tIFwiQC9saWIvaHR0cFwiO1xuaW1wb3J0IHR5cGUge1xuICBDb250cm9sbGVyQWN0aW9uLFxuICBNaWRkbGV3YXJlLFxuICBNaWRkbGV3YXJlQ29udGV4dCxcbiAgUm91dGVQYXJhbXMsXG59IGZyb20gXCJAL21pZGRsZXdhcmVzL3R5cGVzXCI7XG5cbmludGVyZmFjZSBDcmVhdGVIYW5kbGVyT3B0aW9uczxcbiAgVFJlc3VsdCxcbiAgVENvbnRleHQgZXh0ZW5kcyBNaWRkbGV3YXJlQ29udGV4dCA9IE1pZGRsZXdhcmVDb250ZXh0LFxuPiB7XG4gIG1pZGRsZXdhcmVzPzogTWlkZGxld2FyZVtdO1xuICBjb250cm9sbGVyOiBDb250cm9sbGVyQWN0aW9uPFRSZXN1bHQsIFRDb250ZXh0Pjtcbn1cblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUhhbmRsZXIgPSA8XG4gIFRSZXN1bHQsXG4gIFRDb250ZXh0IGV4dGVuZHMgTWlkZGxld2FyZUNvbnRleHQgPSBNaWRkbGV3YXJlQ29udGV4dCxcbj4oeyBtaWRkbGV3YXJlcyA9IFtdLCBjb250cm9sbGVyIH06IENyZWF0ZUhhbmRsZXJPcHRpb25zPFRSZXN1bHQsIFRDb250ZXh0PikgPT4ge1xuICByZXR1cm4gYXN5bmMgKHJlcTogUmVxdWVzdCwgY3R4PzogeyBwYXJhbXM/OiBSb3V0ZVBhcmFtcyB9KSA9PiB7XG4gICAgcmV0dXJuIGhhbmRsZVJlcXVlc3QocmVxLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcS51cmwpO1xuICAgICAgbGV0IGNvbnRleHQ6IE1pZGRsZXdhcmVDb250ZXh0ID0ge1xuICAgICAgICByZXEsXG4gICAgICAgIHBhcmFtczogY3R4Py5wYXJhbXMgPz8ge30sXG4gICAgICAgIHF1ZXJ5OiB1cmwuc2VhcmNoUGFyYW1zLFxuICAgICAgfTtcblxuICAgICAgZm9yIChjb25zdCBtaWRkbGV3YXJlIG9mIG1pZGRsZXdhcmVzKSB7XG4gICAgICAgIGNvbnRleHQgPSBhd2FpdCBtaWRkbGV3YXJlKGNvbnRleHQpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY29udHJvbGxlcih7IC4uLmNvbnRleHQsIHBhcmFtczogY29udGV4dC5wYXJhbXMgfSBhcyBUQ29udGV4dCk7XG4gICAgfSk7XG4gIH07XG59O1xuIl0sIm5hbWVzIjpbImhhbmRsZVJlcXVlc3QiLCJjcmVhdGVIYW5kbGVyIiwibWlkZGxld2FyZXMiLCJjb250cm9sbGVyIiwicmVxIiwiY3R4IiwidXJsIiwiVVJMIiwiY29udGV4dCIsInBhcmFtcyIsInF1ZXJ5Iiwic2VhcmNoUGFyYW1zIiwibWlkZGxld2FyZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/sms.ts":
/*!************************!*\
  !*** ./src/lib/sms.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sendSms: () => (/* binding */ sendSms)\n/* harmony export */ });\n/* harmony import */ var twilio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! twilio */ \"(rsc)/./node_modules/twilio/lib/index.js\");\n/* harmony import */ var twilio__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(twilio__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/env */ \"(rsc)/./src/lib/env.ts\");\n\n\nlet twilioClient = null;\nconst getTwilioClient = ()=>{\n    if (!twilioClient) {\n        if (!_lib_env__WEBPACK_IMPORTED_MODULE_1__.env.TWILIO_ACCOUNT_SID || !_lib_env__WEBPACK_IMPORTED_MODULE_1__.env.TWILIO_AUTH_TOKEN) {\n            throw new Error(\"Twilio credentials are not configured\");\n        }\n        twilioClient = twilio__WEBPACK_IMPORTED_MODULE_0___default()(_lib_env__WEBPACK_IMPORTED_MODULE_1__.env.TWILIO_ACCOUNT_SID, _lib_env__WEBPACK_IMPORTED_MODULE_1__.env.TWILIO_AUTH_TOKEN);\n    }\n    return twilioClient;\n};\nconst sendSms = async ({ to, message })=>{\n    if (!to) {\n        throw new Error(\"Missing receiver phone number\");\n    }\n    const fromNumber = _lib_env__WEBPACK_IMPORTED_MODULE_1__.env.TWILIO_FROM_NUMBER;\n    if (!_lib_env__WEBPACK_IMPORTED_MODULE_1__.env.TWILIO_ACCOUNT_SID || !_lib_env__WEBPACK_IMPORTED_MODULE_1__.env.TWILIO_AUTH_TOKEN || !fromNumber) {\n        if (true) {\n            console.warn(\"Twilio configuration missing; SMS not sent. Message preview:\", {\n                to,\n                from: fromNumber || \"(unset)\",\n                message\n            });\n            return;\n        }\n        throw new Error(\"Twilio configuration missing\");\n    }\n    if (true) {\n        console.info(`SMS preview  ${to}: ${message}`);\n    }\n    const client = getTwilioClient();\n    const twilioMessage = await client.messages.create({\n        to,\n        from: fromNumber,\n        body: message\n    });\n    if (true) {\n        console.info(`[Twilio] SMS dispatched to ${to} (sid: ${twilioMessage.sid})`);\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Ntcy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTZDO0FBRWI7QUFPaEMsSUFBSUUsZUFBOEI7QUFFbEMsTUFBTUMsa0JBQWtCO0lBQ3RCLElBQUksQ0FBQ0QsY0FBYztRQUNqQixJQUFJLENBQUNELHlDQUFHQSxDQUFDRyxrQkFBa0IsSUFBSSxDQUFDSCx5Q0FBR0EsQ0FBQ0ksaUJBQWlCLEVBQUU7WUFDckQsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO1FBQ0FKLGVBQWVGLDZDQUFNQSxDQUFDQyx5Q0FBR0EsQ0FBQ0csa0JBQWtCLEVBQUVILHlDQUFHQSxDQUFDSSxpQkFBaUI7SUFDckU7SUFDQSxPQUFPSDtBQUNUO0FBRU8sTUFBTUssVUFBVSxPQUFPLEVBQUVDLEVBQUUsRUFBRUMsT0FBTyxFQUFjO0lBQ3ZELElBQUksQ0FBQ0QsSUFBSTtRQUNQLE1BQU0sSUFBSUYsTUFBTTtJQUNsQjtJQUVBLE1BQU1JLGFBQWFULHlDQUFHQSxDQUFDVSxrQkFBa0I7SUFFekMsSUFBSSxDQUFDVix5Q0FBR0EsQ0FBQ0csa0JBQWtCLElBQUksQ0FBQ0gseUNBQUdBLENBQUNJLGlCQUFpQixJQUFJLENBQUNLLFlBQVk7UUFDcEUsSUFBSUUsSUFBcUMsRUFBRTtZQUN6Q0MsUUFBUUMsSUFBSSxDQUFDLGdFQUFnRTtnQkFDM0VOO2dCQUNBTyxNQUFNTCxjQUFjO2dCQUNwQkQ7WUFDRjtZQUNBO1FBQ0Y7UUFDQSxNQUFNLElBQUlILE1BQU07SUFDbEI7SUFFQSxJQUFJTSxJQUFxQyxFQUFFO1FBQ3pDQyxRQUFRRyxJQUFJLENBQUMsQ0FBQyxjQUFjLEVBQUVSLEdBQUcsRUFBRSxFQUFFQyxRQUFRLENBQUM7SUFDaEQ7SUFFQSxNQUFNUSxTQUFTZDtJQUNmLE1BQU1lLGdCQUFnQixNQUFNRCxPQUFPRSxRQUFRLENBQUNDLE1BQU0sQ0FBQztRQUFFWjtRQUFJTyxNQUFNTDtRQUFZVyxNQUFNWjtJQUFRO0lBRXpGLElBQUlHLElBQXFDLEVBQUU7UUFDekNDLFFBQVFHLElBQUksQ0FBQyxDQUFDLDJCQUEyQixFQUFFUixHQUFHLE9BQU8sRUFBRVUsY0FBY0ksR0FBRyxDQUFDLENBQUMsQ0FBQztJQUM3RTtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZGEtYmFja2VuZC8uL3NyYy9saWIvc21zLnRzPzQ4NTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR3aWxpbywgeyB0eXBlIFR3aWxpbyB9IGZyb20gXCJ0d2lsaW9cIjtcblxuaW1wb3J0IHsgZW52IH0gZnJvbSBcIkAvbGliL2VudlwiO1xuXG5leHBvcnQgdHlwZSBTbXNQYXlsb2FkID0ge1xuICB0bzogc3RyaW5nO1xuICBtZXNzYWdlOiBzdHJpbmc7XG59O1xuXG5sZXQgdHdpbGlvQ2xpZW50OiBUd2lsaW8gfCBudWxsID0gbnVsbDtcblxuY29uc3QgZ2V0VHdpbGlvQ2xpZW50ID0gKCkgPT4ge1xuICBpZiAoIXR3aWxpb0NsaWVudCkge1xuICAgIGlmICghZW52LlRXSUxJT19BQ0NPVU5UX1NJRCB8fCAhZW52LlRXSUxJT19BVVRIX1RPS0VOKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUd2lsaW8gY3JlZGVudGlhbHMgYXJlIG5vdCBjb25maWd1cmVkXCIpO1xuICAgIH1cbiAgICB0d2lsaW9DbGllbnQgPSB0d2lsaW8oZW52LlRXSUxJT19BQ0NPVU5UX1NJRCwgZW52LlRXSUxJT19BVVRIX1RPS0VOKTtcbiAgfVxuICByZXR1cm4gdHdpbGlvQ2xpZW50O1xufTtcblxuZXhwb3J0IGNvbnN0IHNlbmRTbXMgPSBhc3luYyAoeyB0bywgbWVzc2FnZSB9OiBTbXNQYXlsb2FkKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIGlmICghdG8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIHJlY2VpdmVyIHBob25lIG51bWJlclwiKTtcbiAgfVxuXG4gIGNvbnN0IGZyb21OdW1iZXIgPSBlbnYuVFdJTElPX0ZST01fTlVNQkVSO1xuXG4gIGlmICghZW52LlRXSUxJT19BQ0NPVU5UX1NJRCB8fCAhZW52LlRXSUxJT19BVVRIX1RPS0VOIHx8ICFmcm9tTnVtYmVyKSB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgY29uc29sZS53YXJuKFwiVHdpbGlvIGNvbmZpZ3VyYXRpb24gbWlzc2luZzsgU01TIG5vdCBzZW50LiBNZXNzYWdlIHByZXZpZXc6XCIsIHtcbiAgICAgICAgdG8sXG4gICAgICAgIGZyb206IGZyb21OdW1iZXIgfHwgXCIodW5zZXQpXCIsXG4gICAgICAgIG1lc3NhZ2UsXG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVHdpbGlvIGNvbmZpZ3VyYXRpb24gbWlzc2luZ1wiKTtcbiAgfVxuXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICBjb25zb2xlLmluZm8oYFNNUyBwcmV2aWV3IOKGkiAke3RvfTogJHttZXNzYWdlfWApO1xuICB9XG5cbiAgY29uc3QgY2xpZW50ID0gZ2V0VHdpbGlvQ2xpZW50KCk7XG4gIGNvbnN0IHR3aWxpb01lc3NhZ2UgPSBhd2FpdCBjbGllbnQubWVzc2FnZXMuY3JlYXRlKHsgdG8sIGZyb206IGZyb21OdW1iZXIsIGJvZHk6IG1lc3NhZ2UgfSk7XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIGNvbnNvbGUuaW5mbyhgW1R3aWxpb10gU01TIGRpc3BhdGNoZWQgdG8gJHt0b30gKHNpZDogJHt0d2lsaW9NZXNzYWdlLnNpZH0pYCk7XG4gIH1cbn07XG4iXSwibmFtZXMiOlsidHdpbGlvIiwiZW52IiwidHdpbGlvQ2xpZW50IiwiZ2V0VHdpbGlvQ2xpZW50IiwiVFdJTElPX0FDQ09VTlRfU0lEIiwiVFdJTElPX0FVVEhfVE9LRU4iLCJFcnJvciIsInNlbmRTbXMiLCJ0byIsIm1lc3NhZ2UiLCJmcm9tTnVtYmVyIiwiVFdJTElPX0ZST01fTlVNQkVSIiwicHJvY2VzcyIsImNvbnNvbGUiLCJ3YXJuIiwiZnJvbSIsImluZm8iLCJjbGllbnQiLCJ0d2lsaW9NZXNzYWdlIiwibWVzc2FnZXMiLCJjcmVhdGUiLCJib2R5Iiwic2lkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/sms.ts\n");

/***/ }),

/***/ "(rsc)/./src/middlewares/auth.middleware.ts":
/*!********************************************!*\
  !*** ./src/middlewares/auth.middleware.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   optionalAuthMiddleware: () => (/* binding */ optionalAuthMiddleware),\n/* harmony export */   requireAuthMiddleware: () => (/* binding */ requireAuthMiddleware)\n/* harmony export */ });\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/errors */ \"(rsc)/./src/lib/errors.ts\");\n/* harmony import */ var _services_auth_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/services/auth.service */ \"(rsc)/./src/services/auth.service.ts\");\n\n\nconst extractTokenFromRequest = (req)=>{\n    const authorization = req.headers.get(\"authorization\") ?? req.headers.get(\"Authorization\");\n    if (!authorization) {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_0__.UnauthorizedError(\"Missing Authorization header\");\n    }\n    const parts = authorization.split(\" \");\n    if (parts.length !== 2 || parts[0] !== \"Bearer\") {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_0__.UnauthorizedError(\"Malformed Authorization header\");\n    }\n    return parts[1];\n};\nconst requireAuthMiddleware = (allowedRoles)=>{\n    return async (context)=>{\n        const token = extractTokenFromRequest(context.req);\n        const user = await (0,_services_auth_service__WEBPACK_IMPORTED_MODULE_1__.getUserFromToken)(token);\n        if (allowedRoles && !allowedRoles.includes(user.role)) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_0__.UnauthorizedError(\"Insufficient permissions\");\n        }\n        return {\n            ...context,\n            user\n        };\n    };\n};\nconst optionalAuthMiddleware = async (context)=>{\n    try {\n        const authorization = context.req.headers.get(\"authorization\") ?? context.req.headers.get(\"Authorization\");\n        if (!authorization) {\n            return context;\n        }\n        const token = extractTokenFromRequest(context.req);\n        const user = await (0,_services_auth_service__WEBPACK_IMPORTED_MODULE_1__.getUserFromToken)(token);\n        return {\n            ...context,\n            user\n        };\n    } catch (error) {\n        if (error instanceof _lib_errors__WEBPACK_IMPORTED_MODULE_0__.UnauthorizedError) {\n            return context;\n        }\n        throw error;\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbWlkZGxld2FyZXMvYXV0aC5taWRkbGV3YXJlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFFaUQ7QUFDVTtBQUkzRCxNQUFNRSwwQkFBMEIsQ0FBQ0M7SUFDL0IsTUFBTUMsZ0JBQWdCRCxJQUFJRSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxvQkFBb0JILElBQUlFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO0lBRTFFLElBQUksQ0FBQ0YsZUFBZTtRQUNsQixNQUFNLElBQUlKLDBEQUFpQkEsQ0FBQztJQUM5QjtJQUVBLE1BQU1PLFFBQVFILGNBQWNJLEtBQUssQ0FBQztJQUNsQyxJQUFJRCxNQUFNRSxNQUFNLEtBQUssS0FBS0YsS0FBSyxDQUFDLEVBQUUsS0FBSyxVQUFVO1FBQy9DLE1BQU0sSUFBSVAsMERBQWlCQSxDQUFDO0lBQzlCO0lBRUEsT0FBT08sS0FBSyxDQUFDLEVBQUU7QUFDakI7QUFFTyxNQUFNRyx3QkFBd0IsQ0FDbkNDO0lBRUEsT0FBTyxPQUFPQztRQUNaLE1BQU1DLFFBQVFYLHdCQUF3QlUsUUFBUVQsR0FBRztRQUNqRCxNQUFNVyxPQUFPLE1BQU1iLHdFQUFnQkEsQ0FBQ1k7UUFFcEMsSUFBSUYsZ0JBQWdCLENBQUNBLGFBQWFJLFFBQVEsQ0FBQ0QsS0FBS0UsSUFBSSxHQUFHO1lBQ3JELE1BQU0sSUFBSWhCLDBEQUFpQkEsQ0FBQztRQUM5QjtRQUVBLE9BQU87WUFDTCxHQUFHWSxPQUFPO1lBQ1ZFO1FBQ0Y7SUFDRjtBQUNGLEVBQUU7QUFFSyxNQUFNRyx5QkFBcUMsT0FBT0w7SUFDdkQsSUFBSTtRQUNGLE1BQU1SLGdCQUFnQlEsUUFBUVQsR0FBRyxDQUFDRSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxvQkFBb0JNLFFBQVFULEdBQUcsQ0FBQ0UsT0FBTyxDQUFDQyxHQUFHLENBQUM7UUFDMUYsSUFBSSxDQUFDRixlQUFlO1lBQ2xCLE9BQU9RO1FBQ1Q7UUFFQSxNQUFNQyxRQUFRWCx3QkFBd0JVLFFBQVFULEdBQUc7UUFDakQsTUFBTVcsT0FBTyxNQUFNYix3RUFBZ0JBLENBQUNZO1FBRXBDLE9BQU87WUFDTCxHQUFHRCxPQUFPO1lBQ1ZFO1FBQ0Y7SUFDRixFQUFFLE9BQU9JLE9BQU87UUFDZCxJQUFJQSxpQkFBaUJsQiwwREFBaUJBLEVBQUU7WUFDdEMsT0FBT1k7UUFDVDtRQUVBLE1BQU1NO0lBQ1I7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2RhLWJhY2tlbmQvLi9zcmMvbWlkZGxld2FyZXMvYXV0aC5taWRkbGV3YXJlLnRzPzViOWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBSb2xlIH0gZnJvbSBcIkBwcmlzbWEvY2xpZW50XCI7XG5cbmltcG9ydCB7IFVuYXV0aG9yaXplZEVycm9yIH0gZnJvbSBcIkAvbGliL2Vycm9yc1wiO1xuaW1wb3J0IHsgZ2V0VXNlckZyb21Ub2tlbiB9IGZyb20gXCJAL3NlcnZpY2VzL2F1dGguc2VydmljZVwiO1xuXG5pbXBvcnQgdHlwZSB7IEF1dGhlbnRpY2F0ZWRDb250ZXh0LCBNaWRkbGV3YXJlLCBNaWRkbGV3YXJlQ29udGV4dCB9IGZyb20gXCIuL3R5cGVzXCI7XG5cbmNvbnN0IGV4dHJhY3RUb2tlbkZyb21SZXF1ZXN0ID0gKHJlcTogUmVxdWVzdCk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IGF1dGhvcml6YXRpb24gPSByZXEuaGVhZGVycy5nZXQoXCJhdXRob3JpemF0aW9uXCIpID8/IHJlcS5oZWFkZXJzLmdldChcIkF1dGhvcml6YXRpb25cIik7XG5cbiAgaWYgKCFhdXRob3JpemF0aW9uKSB7XG4gICAgdGhyb3cgbmV3IFVuYXV0aG9yaXplZEVycm9yKFwiTWlzc2luZyBBdXRob3JpemF0aW9uIGhlYWRlclwiKTtcbiAgfVxuXG4gIGNvbnN0IHBhcnRzID0gYXV0aG9yaXphdGlvbi5zcGxpdChcIiBcIik7XG4gIGlmIChwYXJ0cy5sZW5ndGggIT09IDIgfHwgcGFydHNbMF0gIT09IFwiQmVhcmVyXCIpIHtcbiAgICB0aHJvdyBuZXcgVW5hdXRob3JpemVkRXJyb3IoXCJNYWxmb3JtZWQgQXV0aG9yaXphdGlvbiBoZWFkZXJcIik7XG4gIH1cblxuICByZXR1cm4gcGFydHNbMV07XG59O1xuXG5leHBvcnQgY29uc3QgcmVxdWlyZUF1dGhNaWRkbGV3YXJlID0gKFxuICBhbGxvd2VkUm9sZXM/OiBSb2xlW10sXG4pOiBNaWRkbGV3YXJlPE1pZGRsZXdhcmVDb250ZXh0LCBBdXRoZW50aWNhdGVkQ29udGV4dD4gPT4ge1xuICByZXR1cm4gYXN5bmMgKGNvbnRleHQpID0+IHtcbiAgICBjb25zdCB0b2tlbiA9IGV4dHJhY3RUb2tlbkZyb21SZXF1ZXN0KGNvbnRleHQucmVxKTtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0VXNlckZyb21Ub2tlbih0b2tlbik7XG5cbiAgICBpZiAoYWxsb3dlZFJvbGVzICYmICFhbGxvd2VkUm9sZXMuaW5jbHVkZXModXNlci5yb2xlKSkge1xuICAgICAgdGhyb3cgbmV3IFVuYXV0aG9yaXplZEVycm9yKFwiSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAuLi5jb250ZXh0LFxuICAgICAgdXNlcixcbiAgICB9IHNhdGlzZmllcyBBdXRoZW50aWNhdGVkQ29udGV4dDtcbiAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBvcHRpb25hbEF1dGhNaWRkbGV3YXJlOiBNaWRkbGV3YXJlID0gYXN5bmMgKGNvbnRleHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBhdXRob3JpemF0aW9uID0gY29udGV4dC5yZXEuaGVhZGVycy5nZXQoXCJhdXRob3JpemF0aW9uXCIpID8/IGNvbnRleHQucmVxLmhlYWRlcnMuZ2V0KFwiQXV0aG9yaXphdGlvblwiKTtcbiAgICBpZiAoIWF1dGhvcml6YXRpb24pIHtcbiAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH1cblxuICAgIGNvbnN0IHRva2VuID0gZXh0cmFjdFRva2VuRnJvbVJlcXVlc3QoY29udGV4dC5yZXEpO1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRVc2VyRnJvbVRva2VuKHRva2VuKTtcblxuICAgIHJldHVybiB7XG4gICAgICAuLi5jb250ZXh0LFxuICAgICAgdXNlcixcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFVuYXV0aG9yaXplZEVycm9yKSB7XG4gICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcbiJdLCJuYW1lcyI6WyJVbmF1dGhvcml6ZWRFcnJvciIsImdldFVzZXJGcm9tVG9rZW4iLCJleHRyYWN0VG9rZW5Gcm9tUmVxdWVzdCIsInJlcSIsImF1dGhvcml6YXRpb24iLCJoZWFkZXJzIiwiZ2V0IiwicGFydHMiLCJzcGxpdCIsImxlbmd0aCIsInJlcXVpcmVBdXRoTWlkZGxld2FyZSIsImFsbG93ZWRSb2xlcyIsImNvbnRleHQiLCJ0b2tlbiIsInVzZXIiLCJpbmNsdWRlcyIsInJvbGUiLCJvcHRpb25hbEF1dGhNaWRkbGV3YXJlIiwiZXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/middlewares/auth.middleware.ts\n");

/***/ }),

/***/ "(rsc)/./src/middlewares/params.middleware.ts":
/*!**********************************************!*\
  !*** ./src/middlewares/params.middleware.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   paramsSchemaMiddleware: () => (/* binding */ paramsSchemaMiddleware)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/ZodError.js\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/errors */ \"(rsc)/./src/lib/errors.ts\");\n\n\nconst paramsSchemaMiddleware = (schema)=>{\n    return async (context)=>{\n        try {\n            const parsed = schema.parse(context.params);\n            return {\n                ...context,\n                paramsData: parsed\n            };\n        } catch (error) {\n            if (error instanceof zod__WEBPACK_IMPORTED_MODULE_1__.ZodError) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_0__.ValidationError(\"Invalid route parameters\", error.flatten());\n            }\n            throw error;\n        }\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbWlkZGxld2FyZXMvcGFyYW1zLm1pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQWdEO0FBRUQ7QUFHeEMsTUFBTUUseUJBQXlCLENBSXBDQztJQUVBLE9BQU8sT0FBT0M7UUFDWixJQUFJO1lBQ0YsTUFBTUMsU0FBU0YsT0FBT0csS0FBSyxDQUFDRixRQUFRRyxNQUFNO1lBQzFDLE9BQU87Z0JBQ0wsR0FBR0gsT0FBTztnQkFDVkksWUFBWUg7WUFDZDtRQUNGLEVBQUUsT0FBT0ksT0FBTztZQUNkLElBQUlBLGlCQUFpQlQseUNBQVFBLEVBQUU7Z0JBQzdCLE1BQU0sSUFBSUMsd0RBQWVBLENBQUMsNEJBQTRCUSxNQUFNQyxPQUFPO1lBQ3JFO1lBRUEsTUFBTUQ7UUFDUjtJQUNGO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NkYS1iYWNrZW5kLy4vc3JjL21pZGRsZXdhcmVzL3BhcmFtcy5taWRkbGV3YXJlLnRzP2Y0N2EiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgWm9kRXJyb3IsIHR5cGUgWm9kVHlwZUFueSB9IGZyb20gXCJ6b2RcIjtcblxuaW1wb3J0IHsgVmFsaWRhdGlvbkVycm9yIH0gZnJvbSBcIkAvbGliL2Vycm9yc1wiO1xuaW1wb3J0IHR5cGUgeyBNaWRkbGV3YXJlLCBNaWRkbGV3YXJlQ29udGV4dCwgUGFyYW1zQ29udGV4dCB9IGZyb20gXCJAL21pZGRsZXdhcmVzL3R5cGVzXCI7XG5cbmV4cG9ydCBjb25zdCBwYXJhbXNTY2hlbWFNaWRkbGV3YXJlID0gPFxuICBUU2NoZW1hIGV4dGVuZHMgWm9kVHlwZUFueSxcbiAgVElucHV0IGV4dGVuZHMgTWlkZGxld2FyZUNvbnRleHQgPSBNaWRkbGV3YXJlQ29udGV4dCxcbj4oXG4gIHNjaGVtYTogVFNjaGVtYSxcbik6IE1pZGRsZXdhcmU8VElucHV0LCBUSW5wdXQgJiBQYXJhbXNDb250ZXh0PFJldHVyblR5cGU8VFNjaGVtYVtcInBhcnNlXCJdPj4+ID0+IHtcbiAgcmV0dXJuIGFzeW5jIChjb250ZXh0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhcnNlZCA9IHNjaGVtYS5wYXJzZShjb250ZXh0LnBhcmFtcyk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5jb250ZXh0LFxuICAgICAgICBwYXJhbXNEYXRhOiBwYXJzZWQsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBab2RFcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFwiSW52YWxpZCByb3V0ZSBwYXJhbWV0ZXJzXCIsIGVycm9yLmZsYXR0ZW4oKSk7XG4gICAgICB9XG5cbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfTtcbn07XG4iXSwibmFtZXMiOlsiWm9kRXJyb3IiLCJWYWxpZGF0aW9uRXJyb3IiLCJwYXJhbXNTY2hlbWFNaWRkbGV3YXJlIiwic2NoZW1hIiwiY29udGV4dCIsInBhcnNlZCIsInBhcnNlIiwicGFyYW1zIiwicGFyYW1zRGF0YSIsImVycm9yIiwiZmxhdHRlbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/middlewares/params.middleware.ts\n");

/***/ }),

/***/ "(rsc)/./src/models/church.model.ts":
/*!************************************!*\
  !*** ./src/models/church.model.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChurchModel: () => (/* binding */ ChurchModel)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n\nconst ChurchModel = {\n    findById: (id, args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.church.findUnique({\n            ...args ?? {},\n            where: {\n                id\n            }\n        }),\n    findMany: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.church.findMany(args),\n    create: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.church.create(args),\n    update: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.church.update(args),\n    delete: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.church.delete(args),\n    count: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.church.count(args)\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbW9kZWxzL2NodXJjaC5tb2RlbC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUVzQztBQUUvQixNQUFNQyxjQUFjO0lBQ3pCQyxVQUFVLENBQ1JDLElBQ0FDLE9BRUFKLCtDQUFNQSxDQUFDSyxNQUFNLENBQUNDLFVBQVUsQ0FBQztZQUN2QixHQUFJRixRQUFRLENBQUMsQ0FBQztZQUNkRyxPQUFPO2dCQUFFSjtZQUFHO1FBQ2Q7SUFFRkssVUFBVSxDQUFDSixPQUFxQ0osK0NBQU1BLENBQUNLLE1BQU0sQ0FBQ0csUUFBUSxDQUFDSjtJQUV2RUssUUFBUSxDQUFDTCxPQUFrQ0osK0NBQU1BLENBQUNLLE1BQU0sQ0FBQ0ksTUFBTSxDQUFDTDtJQUVoRU0sUUFBUSxDQUFDTixPQUFrQ0osK0NBQU1BLENBQUNLLE1BQU0sQ0FBQ0ssTUFBTSxDQUFDTjtJQUVoRU8sUUFBUSxDQUFDUCxPQUFrQ0osK0NBQU1BLENBQUNLLE1BQU0sQ0FBQ00sTUFBTSxDQUFDUDtJQUVoRVEsT0FBTyxDQUFDUixPQUFrQ0osK0NBQU1BLENBQUNLLE1BQU0sQ0FBQ08sS0FBSyxDQUFDUjtBQUNoRSxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2RhLWJhY2tlbmQvLi9zcmMvbW9kZWxzL2NodXJjaC5tb2RlbC50cz8wNjNmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQ2h1cmNoLCBQcmlzbWEgfSBmcm9tIFwiQHByaXNtYS9jbGllbnRcIjtcblxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xuXG5leHBvcnQgY29uc3QgQ2h1cmNoTW9kZWwgPSB7XG4gIGZpbmRCeUlkOiA8VCBleHRlbmRzIFByaXNtYS5DaHVyY2hGaW5kVW5pcXVlQXJncz4oXG4gICAgaWQ6IHN0cmluZyxcbiAgICBhcmdzPzogUHJpc21hLlNlbGVjdFN1YnNldDxULCBQcmlzbWEuQ2h1cmNoRmluZFVuaXF1ZUFyZ3M+LFxuICApID0+XG4gICAgcHJpc21hLmNodXJjaC5maW5kVW5pcXVlKHtcbiAgICAgIC4uLihhcmdzID8/IHt9KSxcbiAgICAgIHdoZXJlOiB7IGlkIH0sXG4gICAgfSBhcyBQcmlzbWEuU2VsZWN0U3Vic2V0PFQsIFByaXNtYS5DaHVyY2hGaW5kVW5pcXVlQXJncz4pLFxuXG4gIGZpbmRNYW55OiAoYXJncz86IFByaXNtYS5DaHVyY2hGaW5kTWFueUFyZ3MpID0+IHByaXNtYS5jaHVyY2guZmluZE1hbnkoYXJncyksXG5cbiAgY3JlYXRlOiAoYXJnczogUHJpc21hLkNodXJjaENyZWF0ZUFyZ3MpID0+IHByaXNtYS5jaHVyY2guY3JlYXRlKGFyZ3MpLFxuXG4gIHVwZGF0ZTogKGFyZ3M6IFByaXNtYS5DaHVyY2hVcGRhdGVBcmdzKSA9PiBwcmlzbWEuY2h1cmNoLnVwZGF0ZShhcmdzKSxcblxuICBkZWxldGU6IChhcmdzOiBQcmlzbWEuQ2h1cmNoRGVsZXRlQXJncykgPT4gcHJpc21hLmNodXJjaC5kZWxldGUoYXJncyksXG5cbiAgY291bnQ6IChhcmdzPzogUHJpc21hLkNodXJjaENvdW50QXJncykgPT4gcHJpc21hLmNodXJjaC5jb3VudChhcmdzKSxcbn07XG5cbmV4cG9ydCB0eXBlIENodXJjaEVudGl0eSA9IENodXJjaDtcbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJDaHVyY2hNb2RlbCIsImZpbmRCeUlkIiwiaWQiLCJhcmdzIiwiY2h1cmNoIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiZmluZE1hbnkiLCJjcmVhdGUiLCJ1cGRhdGUiLCJkZWxldGUiLCJjb3VudCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/models/church.model.ts\n");

/***/ }),

/***/ "(rsc)/./src/models/pass.model.ts":
/*!**********************************!*\
  !*** ./src/models/pass.model.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PassModel: () => (/* binding */ PassModel)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n\nconst PassModel = {\n    findById: (id, args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.pass.findUnique({\n            where: {\n                id\n            },\n            ...args\n        }),\n    findByToken: (token, args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.pass.findUnique({\n            where: {\n                token\n            },\n            ...args\n        }),\n    findMany: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.pass.findMany(args),\n    create: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.pass.create(args),\n    update: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.pass.update(args),\n    upsert: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.pass.upsert(args),\n    delete: (id)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.pass.delete({\n            where: {\n                id\n            }\n        })\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbW9kZWxzL3Bhc3MubW9kZWwudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFc0M7QUFFL0IsTUFBTUMsWUFBWTtJQUN2QkMsVUFBVSxDQUNSQyxJQUNBQyxPQUNHSiwrQ0FBTUEsQ0FBQ0ssSUFBSSxDQUFDQyxVQUFVLENBQUM7WUFBRUMsT0FBTztnQkFBRUo7WUFBRztZQUFHLEdBQUdDLElBQUk7UUFBQztJQUVyREksYUFBYSxDQUNYQyxPQUNBTCxPQUNHSiwrQ0FBTUEsQ0FBQ0ssSUFBSSxDQUFDQyxVQUFVLENBQUM7WUFBRUMsT0FBTztnQkFBRUU7WUFBTTtZQUFHLEdBQUdMLElBQUk7UUFBQztJQUV4RE0sVUFBVSxDQUFDTixPQUFtQ0osK0NBQU1BLENBQUNLLElBQUksQ0FBQ0ssUUFBUSxDQUFDTjtJQUVuRU8sUUFBUSxDQUFDUCxPQUFnQ0osK0NBQU1BLENBQUNLLElBQUksQ0FBQ00sTUFBTSxDQUFDUDtJQUU1RFEsUUFBUSxDQUFDUixPQUFnQ0osK0NBQU1BLENBQUNLLElBQUksQ0FBQ08sTUFBTSxDQUFDUjtJQUU1RFMsUUFBUSxDQUFDVCxPQUFnQ0osK0NBQU1BLENBQUNLLElBQUksQ0FBQ1EsTUFBTSxDQUFDVDtJQUU1RFUsUUFBUSxDQUFDWCxLQUFlSCwrQ0FBTUEsQ0FBQ0ssSUFBSSxDQUFDUyxNQUFNLENBQUM7WUFBRVAsT0FBTztnQkFBRUo7WUFBRztRQUFFO0FBQzdELEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZGEtYmFja2VuZC8uL3NyYy9tb2RlbHMvcGFzcy5tb2RlbC50cz84M2NkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgUGFzcywgUHJpc21hIH0gZnJvbSBcIkBwcmlzbWEvY2xpZW50XCI7XG5cbmltcG9ydCB7IHByaXNtYSB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcblxuZXhwb3J0IGNvbnN0IFBhc3NNb2RlbCA9IHtcbiAgZmluZEJ5SWQ6IDxUIGV4dGVuZHMgUHJpc21hLlBhc3NGaW5kVW5pcXVlQXJncz4oXG4gICAgaWQ6IHN0cmluZyxcbiAgICBhcmdzPzogT21pdDxULCBcIndoZXJlXCI+XG4gICkgPT4gcHJpc21hLnBhc3MuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkIH0sIC4uLmFyZ3MgfSksXG5cbiAgZmluZEJ5VG9rZW46IDxUIGV4dGVuZHMgUHJpc21hLlBhc3NGaW5kVW5pcXVlQXJncz4oXG4gICAgdG9rZW46IHN0cmluZyxcbiAgICBhcmdzPzogT21pdDxULCBcIndoZXJlXCI+XG4gICkgPT4gcHJpc21hLnBhc3MuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IHRva2VuIH0sIC4uLmFyZ3MgfSksXG5cbiAgZmluZE1hbnk6IChhcmdzPzogUHJpc21hLlBhc3NGaW5kTWFueUFyZ3MpID0+IHByaXNtYS5wYXNzLmZpbmRNYW55KGFyZ3MpLFxuXG4gIGNyZWF0ZTogKGFyZ3M6IFByaXNtYS5QYXNzQ3JlYXRlQXJncykgPT4gcHJpc21hLnBhc3MuY3JlYXRlKGFyZ3MpLFxuXG4gIHVwZGF0ZTogKGFyZ3M6IFByaXNtYS5QYXNzVXBkYXRlQXJncykgPT4gcHJpc21hLnBhc3MudXBkYXRlKGFyZ3MpLFxuXG4gIHVwc2VydDogKGFyZ3M6IFByaXNtYS5QYXNzVXBzZXJ0QXJncykgPT4gcHJpc21hLnBhc3MudXBzZXJ0KGFyZ3MpLFxuXG4gIGRlbGV0ZTogKGlkOiBzdHJpbmcpID0+IHByaXNtYS5wYXNzLmRlbGV0ZSh7IHdoZXJlOiB7IGlkIH0gfSksXG59O1xuXG5leHBvcnQgdHlwZSBQYXNzRW50aXR5ID0gUGFzcztcbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJQYXNzTW9kZWwiLCJmaW5kQnlJZCIsImlkIiwiYXJncyIsInBhc3MiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJmaW5kQnlUb2tlbiIsInRva2VuIiwiZmluZE1hbnkiLCJjcmVhdGUiLCJ1cGRhdGUiLCJ1cHNlcnQiLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/models/pass.model.ts\n");

/***/ }),

/***/ "(rsc)/./src/models/user.model.ts":
/*!**********************************!*\
  !*** ./src/models/user.model.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UserModel: () => (/* binding */ UserModel)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n\nconst UserModel = {\n    findById: (id, args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n            where: {\n                id\n            },\n            ...args ?? {}\n        }),\n    findByUsername: (username, args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n            where: {\n                username\n            },\n            ...args ?? {}\n        }),\n    findByEmail: (email, args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n            where: {\n                email\n            },\n            ...args ?? {}\n        }),\n    findByPhoneNumber: (phoneNumber, args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n            where: {\n                phoneNumber\n            },\n            ...args ?? {}\n        }),\n    findByNationalId: (nationalId, args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n            where: {\n                nationalId\n            },\n            ...args ?? {}\n        }),\n    findMany: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findMany(args),\n    count: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.count(args),\n    create: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.create(args),\n    update: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.update(args),\n    delete: (args)=>_lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.delete(args)\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbW9kZWxzL3VzZXIubW9kZWwudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFc0M7QUFJL0IsTUFBTUMsWUFBWTtJQUN2QkMsVUFBVSxDQUFDQyxJQUFZQyxPQUNyQkosK0NBQU1BLENBQUNLLElBQUksQ0FBQ0MsVUFBVSxDQUFDO1lBQUVDLE9BQU87Z0JBQUVKO1lBQUc7WUFBRyxHQUFJQyxRQUFRLENBQUMsQ0FBQztRQUFFO0lBRTFESSxnQkFBZ0IsQ0FBQ0MsVUFBa0JMLE9BQ2pDSiwrQ0FBTUEsQ0FBQ0ssSUFBSSxDQUFDQyxVQUFVLENBQUM7WUFBRUMsT0FBTztnQkFBRUU7WUFBUztZQUFHLEdBQUlMLFFBQVEsQ0FBQyxDQUFDO1FBQUU7SUFFaEVNLGFBQWEsQ0FBQ0MsT0FBZVAsT0FDM0JKLCtDQUFNQSxDQUFDSyxJQUFJLENBQUNDLFVBQVUsQ0FBQztZQUFFQyxPQUFPO2dCQUFFSTtZQUFNO1lBQUcsR0FBSVAsUUFBUSxDQUFDLENBQUM7UUFBRTtJQUU3RFEsbUJBQW1CLENBQ2pCQyxhQUNBVCxPQUVBSiwrQ0FBTUEsQ0FBQ0ssSUFBSSxDQUFDQyxVQUFVLENBQUM7WUFDckJDLE9BQU87Z0JBQUVNO1lBQVk7WUFDckIsR0FBSVQsUUFBUSxDQUFDLENBQUM7UUFDaEI7SUFFRlUsa0JBQWtCLENBQUNDLFlBQW9CWCxPQUNyQ0osK0NBQU1BLENBQUNLLElBQUksQ0FBQ0MsVUFBVSxDQUFDO1lBQUVDLE9BQU87Z0JBQUVRO1lBQVc7WUFBRyxHQUFJWCxRQUFRLENBQUMsQ0FBQztRQUFFO0lBRWxFWSxVQUFVLENBQUNaLE9BQW1DSiwrQ0FBTUEsQ0FBQ0ssSUFBSSxDQUFDVyxRQUFRLENBQUNaO0lBRW5FYSxPQUFPLENBQUNiLE9BQWdDSiwrQ0FBTUEsQ0FBQ0ssSUFBSSxDQUFDWSxLQUFLLENBQUNiO0lBRTFEYyxRQUFRLENBQ05kLE9BQ0dKLCtDQUFNQSxDQUFDSyxJQUFJLENBQUNhLE1BQU0sQ0FBSWQ7SUFFM0JlLFFBQVEsQ0FBQ2YsT0FBZ0NKLCtDQUFNQSxDQUFDSyxJQUFJLENBQUNjLE1BQU0sQ0FBQ2Y7SUFFNURnQixRQUFRLENBQUNoQixPQUFnQ0osK0NBQU1BLENBQUNLLElBQUksQ0FBQ2UsTUFBTSxDQUFDaEI7QUFDOUQsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NkYS1iYWNrZW5kLy4vc3JjL21vZGVscy91c2VyLm1vZGVsLnRzPzBlOTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBQcmlzbWEsIFVzZXIgfSBmcm9tIFwiQHByaXNtYS9jbGllbnRcIjtcblxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xuXG50eXBlIFVzZXJGaW5kVW5pcXVlQXJnc1dpdGhvdXRXaGVyZSA9IE9taXQ8UHJpc21hLlVzZXJGaW5kVW5pcXVlQXJncywgXCJ3aGVyZVwiPjtcblxuZXhwb3J0IGNvbnN0IFVzZXJNb2RlbCA9IHtcbiAgZmluZEJ5SWQ6IChpZDogc3RyaW5nLCBhcmdzPzogVXNlckZpbmRVbmlxdWVBcmdzV2l0aG91dFdoZXJlKSA9PlxuICAgIHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZCB9LCAuLi4oYXJncyA/PyB7fSkgfSksXG5cbiAgZmluZEJ5VXNlcm5hbWU6ICh1c2VybmFtZTogc3RyaW5nLCBhcmdzPzogVXNlckZpbmRVbmlxdWVBcmdzV2l0aG91dFdoZXJlKSA9PlxuICAgIHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyB1c2VybmFtZSB9LCAuLi4oYXJncyA/PyB7fSkgfSksXG5cbiAgZmluZEJ5RW1haWw6IChlbWFpbDogc3RyaW5nLCBhcmdzPzogVXNlckZpbmRVbmlxdWVBcmdzV2l0aG91dFdoZXJlKSA9PlxuICAgIHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBlbWFpbCB9LCAuLi4oYXJncyA/PyB7fSkgfSksXG5cbiAgZmluZEJ5UGhvbmVOdW1iZXI6IChcbiAgICBwaG9uZU51bWJlcjogc3RyaW5nLFxuICAgIGFyZ3M/OiBVc2VyRmluZFVuaXF1ZUFyZ3NXaXRob3V0V2hlcmUsXG4gICkgPT5cbiAgICBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICAgIHdoZXJlOiB7IHBob25lTnVtYmVyIH0gYXMgUHJpc21hLlVzZXJXaGVyZVVuaXF1ZUlucHV0LFxuICAgICAgLi4uKGFyZ3MgPz8ge30pLFxuICAgIH0pLFxuXG4gIGZpbmRCeU5hdGlvbmFsSWQ6IChuYXRpb25hbElkOiBzdHJpbmcsIGFyZ3M/OiBVc2VyRmluZFVuaXF1ZUFyZ3NXaXRob3V0V2hlcmUpID0+XG4gICAgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IG5hdGlvbmFsSWQgfSwgLi4uKGFyZ3MgPz8ge30pIH0pLFxuXG4gIGZpbmRNYW55OiAoYXJncz86IFByaXNtYS5Vc2VyRmluZE1hbnlBcmdzKSA9PiBwcmlzbWEudXNlci5maW5kTWFueShhcmdzKSxcblxuICBjb3VudDogKGFyZ3M/OiBQcmlzbWEuVXNlckNvdW50QXJncykgPT4gcHJpc21hLnVzZXIuY291bnQoYXJncyksXG5cbiAgY3JlYXRlOiA8VCBleHRlbmRzIFByaXNtYS5Vc2VyQ3JlYXRlQXJncz4oXG4gICAgYXJnczogUHJpc21hLlNlbGVjdFN1YnNldDxULCBQcmlzbWEuVXNlckNyZWF0ZUFyZ3M+LFxuICApID0+IHByaXNtYS51c2VyLmNyZWF0ZTxUPihhcmdzKSxcblxuICB1cGRhdGU6IChhcmdzOiBQcmlzbWEuVXNlclVwZGF0ZUFyZ3MpID0+IHByaXNtYS51c2VyLnVwZGF0ZShhcmdzKSxcblxuICBkZWxldGU6IChhcmdzOiBQcmlzbWEuVXNlckRlbGV0ZUFyZ3MpID0+IHByaXNtYS51c2VyLmRlbGV0ZShhcmdzKSxcbn07XG5cbmV4cG9ydCB0eXBlIFVzZXJXaXRoQ29udGV4dCA9IFVzZXI7XG4iXSwibmFtZXMiOlsicHJpc21hIiwiVXNlck1vZGVsIiwiZmluZEJ5SWQiLCJpZCIsImFyZ3MiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiZmluZEJ5VXNlcm5hbWUiLCJ1c2VybmFtZSIsImZpbmRCeUVtYWlsIiwiZW1haWwiLCJmaW5kQnlQaG9uZU51bWJlciIsInBob25lTnVtYmVyIiwiZmluZEJ5TmF0aW9uYWxJZCIsIm5hdGlvbmFsSWQiLCJmaW5kTWFueSIsImNvdW50IiwiY3JlYXRlIiwidXBkYXRlIiwiZGVsZXRlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/models/user.model.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/audit-log.service.ts":
/*!*******************************************!*\
  !*** ./src/services/audit-log.service.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   listAuditLogsForUnionAdmin: () => (/* binding */ listAuditLogsForUnionAdmin),\n/* harmony export */   recordAuditLog: () => (/* binding */ recordAuditLog)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/errors */ \"(rsc)/./src/lib/errors.ts\");\n\n\nconst extractIpAddress = (req)=>{\n    const forwardedFor = req.headers.get(\"x-forwarded-for\") ?? req.headers.get(\"X-Forwarded-For\");\n    if (forwardedFor) {\n        return forwardedFor.split(\",\").map((value)=>value.trim()).find(Boolean) ?? null;\n    }\n    const realIp = req.headers.get(\"x-real-ip\") ?? req.headers.get(\"X-Real-Ip\") ?? req.headers.get(\"cf-connecting-ip\") ?? req.headers.get(\"CF-Connecting-Ip\");\n    if (realIp) {\n        return realIp;\n    }\n    return null;\n};\nconst buildUserDisplayName = (user)=>{\n    if (!user) {\n        return \"Unknown\";\n    }\n    const fullName = `${user.firstName ?? \"\"} ${user.lastName ?? \"\"}`.trim();\n    if (fullName) {\n        return fullName;\n    }\n    return user.username ?? \"Unknown\";\n};\nconst recordAuditLog = async ({ req, user, action, details })=>{\n    try {\n        const ipAddress = extractIpAddress(req);\n        const userAgent = req.headers.get(\"user-agent\") ?? req.headers.get(\"User-Agent\") ?? null;\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.create({\n            data: {\n                action,\n                userName: buildUserDisplayName(user),\n                userRole: user?.role ?? null,\n                userId: user?.id ?? null,\n                unionId: user?.unionId ?? null,\n                districtId: user?.districtId ?? null,\n                churchId: user?.churchId ?? null,\n                ipAddress,\n                userAgent,\n                details: details ?? undefined\n            }\n        });\n    } catch (error) {\n        // Audit logging should never block core flow; surface during development only.\n        console.error(\"Failed to record audit log\", error);\n    }\n};\nconst buildSearchWhere = (search)=>{\n    if (!search) {\n        return undefined;\n    }\n    return {\n        OR: [\n            {\n                userName: {\n                    contains: search,\n                    mode: \"insensitive\"\n                }\n            },\n            {\n                action: {\n                    contains: search,\n                    mode: \"insensitive\"\n                }\n            },\n            {\n                ipAddress: {\n                    contains: search,\n                    mode: \"insensitive\"\n                }\n            },\n            {\n                userAgent: {\n                    contains: search,\n                    mode: \"insensitive\"\n                }\n            }\n        ]\n    };\n};\nconst listAuditLogsForUnionAdmin = async (user, { action, role, search, cursor, limit = 25 })=>{\n    if (user.role !== \"UNION_ADMIN\") {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.ForbiddenError(\"Only union admins can view audit logs\");\n    }\n    if (!user.unionId) {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_1__.ForbiddenError(\"Union context is required to view audit logs\");\n    }\n    const where = {\n        unionId: user.unionId,\n        ...action ? {\n            action\n        } : {},\n        ...role ? {\n            userRole: role\n        } : {}\n    };\n    const searchWhere = buildSearchWhere(search);\n    if (searchWhere) {\n        where.AND = where.AND ?? [];\n        where.AND.push(searchWhere);\n    }\n    const take = Math.min(Math.max(limit, 1), 100);\n    const logs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.findMany({\n        where,\n        orderBy: {\n            createdAt: \"desc\"\n        },\n        take: take + 1,\n        cursor: cursor ? {\n            id: cursor\n        } : undefined,\n        skip: cursor ? 1 : 0\n    });\n    const totalPromise = _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.count({\n        where\n    });\n    const countsByActionPromise = _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.groupBy({\n        where,\n        by: [\n            \"action\"\n        ],\n        _count: {\n            action: true\n        }\n    });\n    const countsByRolePromise = _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.groupBy({\n        where,\n        by: [\n            \"userRole\"\n        ],\n        _count: {\n            userRole: true\n        }\n    });\n    const [total, countsByActionRaw, countsByRoleRaw] = await Promise.all([\n        totalPromise,\n        countsByActionPromise,\n        countsByRolePromise\n    ]);\n    let nextCursor = null;\n    if (logs.length > take) {\n        const nextItem = logs.pop();\n        nextCursor = nextItem ? nextItem.id : null;\n    }\n    return {\n        logs,\n        total,\n        countsByAction: countsByActionRaw.map((row)=>({\n                action: row.action,\n                count: row._count.action\n            })),\n        countsByRole: countsByRoleRaw.map((row)=>({\n                role: row.userRole ?? null,\n                count: row._count.userRole\n            })),\n        nextCursor\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmljZXMvYXVkaXQtbG9nLnNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUVzQztBQUNRO0FBZTlDLE1BQU1FLG1CQUFtQixDQUFDQztJQUN4QixNQUFNQyxlQUFlRCxJQUFJRSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxzQkFBc0JILElBQUlFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO0lBQzNFLElBQUlGLGNBQWM7UUFDaEIsT0FBT0EsYUFBYUcsS0FBSyxDQUFDLEtBQUtDLEdBQUcsQ0FBQyxDQUFDQyxRQUFVQSxNQUFNQyxJQUFJLElBQUlDLElBQUksQ0FBQ0MsWUFBWTtJQUMvRTtJQUVBLE1BQU1DLFNBQ0pWLElBQUlFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGdCQUNoQkgsSUFBSUUsT0FBTyxDQUFDQyxHQUFHLENBQUMsZ0JBQ2hCSCxJQUFJRSxPQUFPLENBQUNDLEdBQUcsQ0FBQyx1QkFDaEJILElBQUlFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO0lBQ2xCLElBQUlPLFFBQVE7UUFDVixPQUFPQTtJQUNUO0lBRUEsT0FBTztBQUNUO0FBRUEsTUFBTUMsdUJBQXVCLENBQUNDO0lBQzVCLElBQUksQ0FBQ0EsTUFBTTtRQUNULE9BQU87SUFDVDtJQUVBLE1BQU1DLFdBQVcsQ0FBQyxFQUFFRCxLQUFLRSxTQUFTLElBQUksR0FBRyxDQUFDLEVBQUVGLEtBQUtHLFFBQVEsSUFBSSxHQUFHLENBQUMsQ0FBQ1IsSUFBSTtJQUN0RSxJQUFJTSxVQUFVO1FBQ1osT0FBT0E7SUFDVDtJQUVBLE9BQU9ELEtBQUtJLFFBQVEsSUFBSTtBQUMxQjtBQVNPLE1BQU1DLGlCQUFpQixPQUFPLEVBQUVqQixHQUFHLEVBQUVZLElBQUksRUFBRU0sTUFBTSxFQUFFQyxPQUFPLEVBQXVCO0lBQ3RGLElBQUk7UUFDRixNQUFNQyxZQUFZckIsaUJBQWlCQztRQUNuQyxNQUFNcUIsWUFBWXJCLElBQUlFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGlCQUFpQkgsSUFB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TUMsUUFBUUMsR0FBRyxDQUFDO1FBQ3BFWDtRQUNBRTtRQUNBSTtLQUNEO0lBRUQsSUFBSU0sYUFBNEI7SUFDaEMsSUFBSWpCLEtBQUtrQixNQUFNLEdBQUd0QixNQUFNO1FBQ3RCLE1BQU11QixXQUFXbkIsS0FBS29CLEdBQUc7UUFDekJILGFBQWFFLFdBQVdBLFNBQVMxQyxFQUFFLEdBQUc7SUFDeEM7SUFFQSxPQUFPO1FBQ0x1QjtRQUNBWTtRQUNBUyxnQkFBZ0JSLGtCQUFrQjVELEdBQUcsQ0FBQyxDQUFDcUUsTUFBUztnQkFBRXhELFFBQVF3RCxJQUFJeEQsTUFBTTtnQkFBRXdDLE9BQU9nQixJQUFJWixNQUFNLENBQUM1QyxNQUFNO1lBQUM7UUFDL0Z5RCxjQUFjVCxnQkFBZ0I3RCxHQUFHLENBQUMsQ0FBQ3FFLE1BQVM7Z0JBQUUvQyxNQUFNK0MsSUFBSWhELFFBQVEsSUFBSTtnQkFBTWdDLE9BQU9nQixJQUFJWixNQUFNLENBQUNwQyxRQUFRO1lBQUM7UUFDckcyQztJQUNGO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NkYS1iYWNrZW5kLy4vc3JjL3NlcnZpY2VzL2F1ZGl0LWxvZy5zZXJ2aWNlLnRzP2Q4MDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBQcmlzbWEsIFJvbGUsIFVzZXIgfSBmcm9tIFwiQHByaXNtYS9jbGllbnRcIjtcblxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xuaW1wb3J0IHsgRm9yYmlkZGVuRXJyb3IgfSBmcm9tIFwiQC9saWIvZXJyb3JzXCI7XG5cbnR5cGUgTnVsbGFibGU8VD4gPSBUIHwgbnVsbCB8IHVuZGVmaW5lZDtcblxudHlwZSBBdWRpdFVzZXJDb250ZXh0ID0ge1xuICBpZD86IHN0cmluZyB8IG51bGw7XG4gIHJvbGU/OiBSb2xlIHwgbnVsbDtcbiAgZmlyc3ROYW1lPzogc3RyaW5nIHwgbnVsbDtcbiAgbGFzdE5hbWU/OiBzdHJpbmcgfCBudWxsO1xuICB1c2VybmFtZT86IHN0cmluZyB8IG51bGw7XG4gIHVuaW9uSWQ/OiBzdHJpbmcgfCBudWxsO1xuICBkaXN0cmljdElkPzogc3RyaW5nIHwgbnVsbDtcbiAgY2h1cmNoSWQ/OiBzdHJpbmcgfCBudWxsO1xufTtcblxuY29uc3QgZXh0cmFjdElwQWRkcmVzcyA9IChyZXE6IFJlcXVlc3QpOiBzdHJpbmcgfCBudWxsID0+IHtcbiAgY29uc3QgZm9yd2FyZGVkRm9yID0gcmVxLmhlYWRlcnMuZ2V0KFwieC1mb3J3YXJkZWQtZm9yXCIpID8/IHJlcS5oZWFkZXJzLmdldChcIlgtRm9yd2FyZGVkLUZvclwiKTtcbiAgaWYgKGZvcndhcmRlZEZvcikge1xuICAgIHJldHVybiBmb3J3YXJkZWRGb3Iuc3BsaXQoXCIsXCIpLm1hcCgodmFsdWUpID0+IHZhbHVlLnRyaW0oKSkuZmluZChCb29sZWFuKSA/PyBudWxsO1xuICB9XG5cbiAgY29uc3QgcmVhbElwID1cbiAgICByZXEuaGVhZGVycy5nZXQoXCJ4LXJlYWwtaXBcIikgPz9cbiAgICByZXEuaGVhZGVycy5nZXQoXCJYLVJlYWwtSXBcIikgPz9cbiAgICByZXEuaGVhZGVycy5nZXQoXCJjZi1jb25uZWN0aW5nLWlwXCIpID8/XG4gICAgcmVxLmhlYWRlcnMuZ2V0KFwiQ0YtQ29ubmVjdGluZy1JcFwiKTtcbiAgaWYgKHJlYWxJcCkge1xuICAgIHJldHVybiByZWFsSXA7XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn07XG5cbmNvbnN0IGJ1aWxkVXNlckRpc3BsYXlOYW1lID0gKHVzZXI6IE51bGxhYmxlPEF1ZGl0VXNlckNvbnRleHQ+KTogc3RyaW5nID0+IHtcbiAgaWYgKCF1c2VyKSB7XG4gICAgcmV0dXJuIFwiVW5rbm93blwiO1xuICB9XG5cbiAgY29uc3QgZnVsbE5hbWUgPSBgJHt1c2VyLmZpcnN0TmFtZSA/PyBcIlwifSAke3VzZXIubGFzdE5hbWUgPz8gXCJcIn1gLnRyaW0oKTtcbiAgaWYgKGZ1bGxOYW1lKSB7XG4gICAgcmV0dXJuIGZ1bGxOYW1lO1xuICB9XG5cbiAgcmV0dXJuIHVzZXIudXNlcm5hbWUgPz8gXCJVbmtub3duXCI7XG59O1xuXG5leHBvcnQgdHlwZSBSZWNvcmRBdWRpdExvZ0lucHV0ID0ge1xuICByZXE6IFJlcXVlc3Q7XG4gIHVzZXI/OiBOdWxsYWJsZTxBdWRpdFVzZXJDb250ZXh0PjtcbiAgYWN0aW9uOiBzdHJpbmc7XG4gIGRldGFpbHM/OiBQcmlzbWEuSW5wdXRKc29uVmFsdWU7XG59O1xuXG5leHBvcnQgY29uc3QgcmVjb3JkQXVkaXRMb2cgPSBhc3luYyAoeyByZXEsIHVzZXIsIGFjdGlvbiwgZGV0YWlscyB9OiBSZWNvcmRBdWRpdExvZ0lucHV0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgaXBBZGRyZXNzID0gZXh0cmFjdElwQWRkcmVzcyhyZXEpO1xuICAgIGNvbnN0IHVzZXJBZ2VudCA9IHJlcS5oZWFkZXJzLmdldChcInVzZXItYWdlbnRcIikgPz8gcmVxLmhlYWRlcnMuZ2V0KFwiVXNlci1BZ2VudFwiKSA/PyBudWxsO1xuXG4gICAgYXdhaXQgcHJpc21hLmF1ZGl0TG9nLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGFjdGlvbixcbiAgICAgICAgdXNlck5hbWU6IGJ1aWxkVXNlckRpc3BsYXlOYW1lKHVzZXIpLFxuICAgICAgICB1c2VyUm9sZTogdXNlcj8ucm9sZSA/PyBudWxsLFxuICAgICAgICB1c2VySWQ6IHVzZXI/LmlkID8/IG51bGwsXG4gICAgICAgIHVuaW9uSWQ6IHVzZXI/LnVuaW9uSWQgPz8gbnVsbCxcbiAgICAgICAgZGlzdHJpY3RJZDogdXNlcj8uZGlzdHJpY3RJZCA/PyBudWxsLFxuICAgICAgICBjaHVyY2hJZDogdXNlcj8uY2h1cmNoSWQgPz8gbnVsbCxcbiAgICAgICAgaXBBZGRyZXNzLFxuICAgICAgICB1c2VyQWdlbnQsXG4gICAgICAgIGRldGFpbHM6IGRldGFpbHMgPz8gdW5kZWZpbmVkLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAvLyBBdWRpdCBsb2dnaW5nIHNob3VsZCBuZXZlciBibG9jayBjb3JlIGZsb3c7IHN1cmZhY2UgZHVyaW5nIGRldmVsb3BtZW50IG9ubHkuXG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byByZWNvcmQgYXVkaXQgbG9nXCIsIGVycm9yKTtcbiAgfVxufTtcblxuZXhwb3J0IHR5cGUgQXVkaXRMb2dGaWx0ZXJzID0ge1xuICBhY3Rpb24/OiBzdHJpbmc7XG4gIHJvbGU/OiBSb2xlO1xuICBzZWFyY2g/OiBzdHJpbmc7XG4gIGN1cnNvcj86IHN0cmluZztcbiAgbGltaXQ/OiBudW1iZXI7XG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIEF1ZGl0TG9nTGlzdFJlc3VsdCB7XG4gIGxvZ3M6IEF3YWl0ZWQ8UmV0dXJuVHlwZTx0eXBlb2YgcHJpc21hLmF1ZGl0TG9nLmZpbmRNYW55Pj47XG4gIHRvdGFsOiBudW1iZXI7XG4gIGNvdW50c0J5QWN0aW9uOiBBcnJheTx7IGFjdGlvbjogc3RyaW5nOyBjb3VudDogbnVtYmVyIH0+O1xuICBjb3VudHNCeVJvbGU6IEFycmF5PHsgcm9sZTogUm9sZSB8IG51bGw7IGNvdW50OiBudW1iZXIgfT47XG4gIG5leHRDdXJzb3I6IHN0cmluZyB8IG51bGw7XG59XG5cbmNvbnN0IGJ1aWxkU2VhcmNoV2hlcmUgPSAoc2VhcmNoPzogc3RyaW5nKTogUHJpc21hLkF1ZGl0TG9nV2hlcmVJbnB1dCB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICghc2VhcmNoKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgT1I6IFtcbiAgICAgIHsgdXNlck5hbWU6IHsgY29udGFpbnM6IHNlYXJjaCwgbW9kZTogXCJpbnNlbnNpdGl2ZVwiIH0gfSxcbiAgICAgIHsgYWN0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6IFwiaW5zZW5zaXRpdmVcIiB9IH0sXG4gICAgICB7IGlwQWRkcmVzczogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiBcImluc2Vuc2l0aXZlXCIgfSB9LFxuICAgICAgeyB1c2VyQWdlbnQ6IHsgY29udGFpbnM6IHNlYXJjaCwgbW9kZTogXCJpbnNlbnNpdGl2ZVwiIH0gfSxcbiAgICBdLFxuICB9IHNhdGlzZmllcyBQcmlzbWEuQXVkaXRMb2dXaGVyZUlucHV0O1xufTtcblxuZXhwb3J0IGNvbnN0IGxpc3RBdWRpdExvZ3NGb3JVbmlvbkFkbWluID0gYXN5bmMgKFxuICB1c2VyOiBVc2VyLFxuICB7IGFjdGlvbiwgcm9sZSwgc2VhcmNoLCBjdXJzb3IsIGxpbWl0ID0gMjUgfTogQXVkaXRMb2dGaWx0ZXJzLFxuKTogUHJvbWlzZTxBdWRpdExvZ0xpc3RSZXN1bHQ+ID0+IHtcbiAgaWYgKHVzZXIucm9sZSAhPT0gXCJVTklPTl9BRE1JTlwiKSB7XG4gICAgdGhyb3cgbmV3IEZvcmJpZGRlbkVycm9yKFwiT25seSB1bmlvbiBhZG1pbnMgY2FuIHZpZXcgYXVkaXQgbG9nc1wiKTtcbiAgfVxuXG4gIGlmICghdXNlci51bmlvbklkKSB7XG4gICAgdGhyb3cgbmV3IEZvcmJpZGRlbkVycm9yKFwiVW5pb24gY29udGV4dCBpcyByZXF1aXJlZCB0byB2aWV3IGF1ZGl0IGxvZ3NcIik7XG4gIH1cblxuICBjb25zdCB3aGVyZTogUHJpc21hLkF1ZGl0TG9nV2hlcmVJbnB1dCA9IHtcbiAgICB1bmlvbklkOiB1c2VyLnVuaW9uSWQsXG4gICAgLi4uKGFjdGlvbiA/IHsgYWN0aW9uIH0gOiB7fSksXG4gICAgLi4uKHJvbGUgPyB7IHVzZXJSb2xlOiByb2xlIH0gOiB7fSksXG4gIH07XG5cbiAgY29uc3Qgc2VhcmNoV2hlcmUgPSBidWlsZFNlYXJjaFdoZXJlKHNlYXJjaCk7XG4gIGlmIChzZWFyY2hXaGVyZSkge1xuICAgIHdoZXJlLkFORCA9IHdoZXJlLkFORCA/PyBbXTtcbiAgICB3aGVyZS5BTkQucHVzaChzZWFyY2hXaGVyZSk7XG4gIH1cblxuICBjb25zdCB0YWtlID0gTWF0aC5taW4oTWF0aC5tYXgobGltaXQsIDEpLCAxMDApO1xuXG4gIGNvbnN0IGxvZ3MgPSBhd2FpdCBwcmlzbWEuYXVkaXRMb2cuZmluZE1hbnkoe1xuICAgIHdoZXJlLFxuICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiBcImRlc2NcIiB9LFxuICAgIHRha2U6IHRha2UgKyAxLFxuICAgIGN1cnNvcjogY3Vyc29yID8geyBpZDogY3Vyc29yIH0gOiB1bmRlZmluZWQsXG4gICAgc2tpcDogY3Vyc29yID8gMSA6IDAsXG4gIH0pO1xuXG4gIGNvbnN0IHRvdGFsUHJvbWlzZSA9IHByaXNtYS5hdWRpdExvZy5jb3VudCh7IHdoZXJlIH0pO1xuICBjb25zdCBjb3VudHNCeUFjdGlvblByb21pc2UgPSBwcmlzbWEuYXVkaXRMb2cuZ3JvdXBCeSh7XG4gICAgd2hlcmUsXG4gICAgYnk6IFtcImFjdGlvblwiXSxcbiAgICBfY291bnQ6IHsgYWN0aW9uOiB0cnVlIH0sXG4gIH0pO1xuICBjb25zdCBjb3VudHNCeVJvbGVQcm9taXNlID0gcHJpc21hLmF1ZGl0TG9nLmdyb3VwQnkoe1xuICAgIHdoZXJlLFxuICAgIGJ5OiBbXCJ1c2VyUm9sZVwiXSxcbiAgICBfY291bnQ6IHsgdXNlclJvbGU6IHRydWUgfSxcbiAgfSk7XG5cbiAgY29uc3QgW3RvdGFsLCBjb3VudHNCeUFjdGlvblJhdywgY291bnRzQnlSb2xlUmF3XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICB0b3RhbFByb21pc2UsXG4gICAgY291bnRzQnlBY3Rpb25Qcm9taXNlLFxuICAgIGNvdW50c0J5Um9sZVByb21pc2UsXG4gIF0pO1xuXG4gIGxldCBuZXh0Q3Vyc29yOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgaWYgKGxvZ3MubGVuZ3RoID4gdGFrZSkge1xuICAgIGNvbnN0IG5leHRJdGVtID0gbG9ncy5wb3AoKTtcbiAgICBuZXh0Q3Vyc29yID0gbmV4dEl0ZW0gPyBuZXh0SXRlbS5pZCA6IG51bGw7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGxvZ3MsXG4gICAgdG90YWwsXG4gICAgY291bnRzQnlBY3Rpb246IGNvdW50c0J5QWN0aW9uUmF3Lm1hcCgocm93KSA9PiAoeyBhY3Rpb246IHJvdy5hY3Rpb24sIGNvdW50OiByb3cuX2NvdW50LmFjdGlvbiB9KSksXG4gICAgY291bnRzQnlSb2xlOiBjb3VudHNCeVJvbGVSYXcubWFwKChyb3cpID0+ICh7IHJvbGU6IHJvdy51c2VyUm9sZSA/PyBudWxsLCBjb3VudDogcm93Ll9jb3VudC51c2VyUm9sZSB9KSksXG4gICAgbmV4dEN1cnNvcixcbiAgfSBzYXRpc2ZpZXMgQXVkaXRMb2dMaXN0UmVzdWx0O1xufTtcbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJGb3JiaWRkZW5FcnJvciIsImV4dHJhY3RJcEFkZHJlc3MiLCJyZXEiLCJmb3J3YXJkZWRGb3IiLCJoZWFkZXJzIiwiZ2V0Iiwic3BsaXQiLCJtYXAiLCJ2YWx1ZSIsInRyaW0iLCJmaW5kIiwiQm9vbGVhbiIsInJlYWxJcCIsImJ1aWxkVXNlckRpc3BsYXlOYW1lIiwidXNlciIsImZ1bGxOYW1lIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJ1c2VybmFtZSIsInJlY29yZEF1ZGl0TG9nIiwiYWN0aW9uIiwiZGV0YWlscyIsImlwQWRkcmVzcyIsInVzZXJBZ2VudCIsImF1ZGl0TG9nIiwiY3JlYXRlIiwiZGF0YSIsInVzZXJOYW1lIiwidXNlclJvbGUiLCJyb2xlIiwidXNlcklkIiwiaWQiLCJ1bmlvbklkIiwiZGlzdHJpY3RJZCIsImNodXJjaElkIiwidW5kZWZpbmVkIiwiZXJyb3IiLCJjb25zb2xlIiwiYnVpbGRTZWFyY2hXaGVyZSIsInNlYXJjaCIsIk9SIiwiY29udGFpbnMiLCJtb2RlIiwibGlzdEF1ZGl0TG9nc0ZvclVuaW9uQWRtaW4iLCJjdXJzb3IiLCJsaW1pdCIsIndoZXJlIiwic2VhcmNoV2hlcmUiLCJBTkQiLCJwdXNoIiwidGFrZSIsIk1hdGgiLCJtaW4iLCJtYXgiLCJsb2dzIiwiZmluZE1hbnkiLCJvcmRlckJ5IiwiY3JlYXRlZEF0Iiwic2tpcCIsInRvdGFsUHJvbWlzZSIsImNvdW50IiwiY291bnRzQnlBY3Rpb25Qcm9taXNlIiwiZ3JvdXBCeSIsImJ5IiwiX2NvdW50IiwiY291bnRzQnlSb2xlUHJvbWlzZSIsInRvdGFsIiwiY291bnRzQnlBY3Rpb25SYXciLCJjb3VudHNCeVJvbGVSYXciLCJQcm9taXNlIiwiYWxsIiwibmV4dEN1cnNvciIsImxlbmd0aCIsIm5leHRJdGVtIiwicG9wIiwiY291bnRzQnlBY3Rpb24iLCJyb3ciLCJjb3VudHNCeVJvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/services/audit-log.service.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/auth.service.ts":
/*!**************************************!*\
  !*** ./src/services/auth.service.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authenticateWithCredentials: () => (/* binding */ authenticateWithCredentials),\n/* harmony export */   getUserFromToken: () => (/* binding */ getUserFromToken),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   signToken: () => (/* binding */ signToken),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/env */ \"(rsc)/./src/lib/env.ts\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/errors */ \"(rsc)/./src/lib/errors.ts\");\n/* harmony import */ var _models_user_model__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/models/user.model */ \"(rsc)/./src/models/user.model.ts\");\n\n\n\n\n\n\n\nconst TOKEN_TTL_SECONDS = 60 * 60 * 12; // 12 hours\nconst hashPassword = async (password)=>{\n    const salt = await bcryptjs__WEBPACK_IMPORTED_MODULE_0___default().genSalt(10);\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_0___default().hash(password, salt);\n};\nconst verifyPassword = async (password, hash)=>{\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_0___default().compare(password, hash);\n};\nconst signToken = (user)=>{\n    const payload = {\n        sub: user.id,\n        role: user.role,\n        unionId: user.unionId,\n        districtId: user.districtId,\n        churchId: user.churchId\n    };\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().sign(payload, _lib_env__WEBPACK_IMPORTED_MODULE_4__.env.JWT_SECRET, {\n        expiresIn: TOKEN_TTL_SECONDS\n    });\n};\nconst getUserFromToken = async (token)=>{\n    try {\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().verify(token, _lib_env__WEBPACK_IMPORTED_MODULE_4__.env.JWT_SECRET);\n        const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.user.findUnique({\n            where: {\n                id: decoded.sub\n            }\n        });\n        if (!user) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError(\"User not found\");\n        }\n        if (!user.isActive) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError(\"Account disabled\");\n        }\n        return user;\n    } catch (error) {\n        if (error instanceof _lib_errors__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError) {\n            throw error;\n        }\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError(\"Invalid token\");\n    }\n};\nconst authenticateWithCredentials = async ({ email, phoneNumber, password })=>{\n    let user = null;\n    if (phoneNumber) {\n        user = await _models_user_model__WEBPACK_IMPORTED_MODULE_6__.UserModel.findByPhoneNumber(phoneNumber);\n        if (!user || !user.isActive) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError(\"Invalid credentials\");\n        }\n        if (user.role !== _prisma_client__WEBPACK_IMPORTED_MODULE_2__.Role.MEMBER) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError(\"Phone number login is restricted to members\");\n        }\n    } else if (email) {\n        user = await _models_user_model__WEBPACK_IMPORTED_MODULE_6__.UserModel.findByEmail(email);\n        if (!user || !user.isActive) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError(\"Invalid credentials\");\n        }\n        if (user.role === _prisma_client__WEBPACK_IMPORTED_MODULE_2__.Role.MEMBER) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError(\"Members must sign in with their phone number\");\n        }\n    } else {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError(\"Email or phone number is required\");\n    }\n    const validPassword = await verifyPassword(password, user.passwordHash);\n    if (!validPassword) {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError(\"Invalid credentials\");\n    }\n    const token = signToken({\n        id: user.id,\n        role: user.role,\n        unionId: user.unionId,\n        districtId: user.districtId,\n        churchId: user.churchId\n    });\n    const { passwordHash, ...safeUser } = user;\n    return {\n        token,\n        user: safeUser\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU1KLEtBQUtJLElBQUk7UUFDZkMsU0FBU0wsS0FBS0ssT0FBTztRQUNyQkMsWUFBWU4sS0FBS00sVUFBVTtRQUMzQkMsVUFBVVAsS0FBS08sUUFBUTtJQUN6QjtJQUVBLE1BQU0sRUFBRW1CLFlBQVksRUFBRSxHQUFHQyxVQUFVLEdBQUczQjtJQUV0QyxPQUFPO1FBQ0xZO1FBQ0FaLE1BQU0yQjtJQUNSO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NkYS1iYWNrZW5kLy4vc3JjL3NlcnZpY2VzL2F1dGguc2VydmljZS50cz9kNmZhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCB7IFJvbGUsIHR5cGUgVXNlciB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xuXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tIFwiQC9saWIvcHJpc21hXCI7XG5pbXBvcnQgeyBlbnYgfSBmcm9tIFwiQC9saWIvZW52XCI7XG5pbXBvcnQgeyBVbmF1dGhvcml6ZWRFcnJvciB9IGZyb20gXCJAL2xpYi9lcnJvcnNcIjtcbmltcG9ydCB7IFVzZXJNb2RlbCB9IGZyb20gXCJAL21vZGVscy91c2VyLm1vZGVsXCI7XG5cbmNvbnN0IFRPS0VOX1RUTF9TRUNPTkRTID0gNjAgKiA2MCAqIDEyOyAvLyAxMiBob3Vyc1xuXG50eXBlIEp3dFBheWxvYWQgPSB7XG4gIHN1Yjogc3RyaW5nO1xuICByb2xlOiBSb2xlO1xuICB1bmlvbklkPzogc3RyaW5nIHwgbnVsbDtcbiAgZGlzdHJpY3RJZD86IHN0cmluZyB8IG51bGw7XG4gIGNodXJjaElkPzogc3RyaW5nIHwgbnVsbDtcbn07XG5cbmV4cG9ydCB0eXBlIFRva2VuU3ViamVjdCA9IFBpY2s8VXNlciwgXCJpZFwiIHwgXCJyb2xlXCIgfCBcInVuaW9uSWRcIiB8IFwiZGlzdHJpY3RJZFwiIHwgXCJjaHVyY2hJZFwiPjtcblxuZXhwb3J0IHR5cGUgQXV0aFVzZXIgPSBPbWl0PFVzZXIsIFwicGFzc3dvcmRIYXNoXCI+O1xuXG5leHBvcnQgY29uc3QgaGFzaFBhc3N3b3JkID0gYXN5bmMgKHBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4gPT4ge1xuICBjb25zdCBzYWx0ID0gYXdhaXQgYmNyeXB0LmdlblNhbHQoMTApO1xuICByZXR1cm4gYmNyeXB0Lmhhc2gocGFzc3dvcmQsIHNhbHQpO1xufTtcblxuZXhwb3J0IGNvbnN0IHZlcmlmeVBhc3N3b3JkID0gYXN5bmMgKHBhc3N3b3JkOiBzdHJpbmcsIGhhc2g6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICByZXR1cm4gYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIGhhc2gpO1xufTtcblxuZXhwb3J0IGNvbnN0IHNpZ25Ub2tlbiA9ICh1c2VyOiBUb2tlblN1YmplY3QpOiBzdHJpbmcgPT4ge1xuICBjb25zdCBwYXlsb2FkOiBKd3RQYXlsb2FkID0ge1xuICAgIHN1YjogdXNlci5pZCxcbiAgICByb2xlOiB1c2VyLnJvbGUsXG4gICAgdW5pb25JZDogdXNlci51bmlvbklkLFxuICAgIGRpc3RyaWN0SWQ6IHVzZXIuZGlzdHJpY3RJZCxcbiAgICBjaHVyY2hJZDogdXNlci5jaHVyY2hJZCxcbiAgfTtcblxuICByZXR1cm4gand0LnNpZ24ocGF5bG9hZCwgZW52LkpXVF9TRUNSRVQsIHtcbiAgICBleHBpcmVzSW46IFRPS0VOX1RUTF9TRUNPTkRTLFxuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VyRnJvbVRva2VuID0gYXN5bmMgKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPFVzZXI+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgZW52LkpXVF9TRUNSRVQpIGFzIEp3dFBheWxvYWQ7XG5cbiAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBpZDogZGVjb2RlZC5zdWIgfSxcbiAgICB9KTtcblxuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IFVuYXV0aG9yaXplZEVycm9yKFwiVXNlciBub3QgZm91bmRcIik7XG4gICAgfVxuXG4gICAgaWYgKCF1c2VyLmlzQWN0aXZlKSB7XG4gICAgICB0aHJvdyBuZXcgVW5hdXRob3JpemVkRXJyb3IoXCJBY2NvdW50IGRpc2FibGVkXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB1c2VyO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFVuYXV0aG9yaXplZEVycm9yKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgVW5hdXRob3JpemVkRXJyb3IoXCJJbnZhbGlkIHRva2VuXCIpO1xuICB9XG59O1xuXG50eXBlIENyZWRlbnRpYWxJbnB1dCA9IHtcbiAgZW1haWw/OiBzdHJpbmc7XG4gIHBob25lTnVtYmVyPzogc3RyaW5nO1xuICBwYXNzd29yZDogc3RyaW5nO1xufTtcblxuZXhwb3J0IGNvbnN0IGF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFscyA9IGFzeW5jICh7XG4gIGVtYWlsLFxuICBwaG9uZU51bWJlcixcbiAgcGFzc3dvcmQsXG59OiBDcmVkZW50aWFsSW5wdXQpID0+IHtcbiAgbGV0IHVzZXI6IFVzZXIgfCBudWxsID0gbnVsbDtcblxuICBpZiAocGhvbmVOdW1iZXIpIHtcbiAgICB1c2VyID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeVBob25lTnVtYmVyKHBob25lTnVtYmVyKTtcblxuICAgIGlmICghdXNlciB8fCAhdXNlci5pc0FjdGl2ZSkge1xuICAgICAgdGhyb3cgbmV3IFVuYXV0aG9yaXplZEVycm9yKFwiSW52YWxpZCBjcmVkZW50aWFsc1wiKTtcbiAgICB9XG5cbiAgICBpZiAodXNlci5yb2xlICE9PSBSb2xlLk1FTUJFUikge1xuICAgICAgdGhyb3cgbmV3IFVuYXV0aG9yaXplZEVycm9yKFwiUGhvbmUgbnVtYmVyIGxvZ2luIGlzIHJlc3RyaWN0ZWQgdG8gbWVtYmVyc1wiKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoZW1haWwpIHtcbiAgICB1c2VyID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeUVtYWlsKGVtYWlsKTtcblxuICAgIGlmICghdXNlciB8fCAhdXNlci5pc0FjdGl2ZSkge1xuICAgICAgdGhyb3cgbmV3IFVuYXV0aG9yaXplZEVycm9yKFwiSW52YWxpZCBjcmVkZW50aWFsc1wiKTtcbiAgICB9XG5cbiAgICBpZiAodXNlci5yb2xlID09PSBSb2xlLk1FTUJFUikge1xuICAgICAgdGhyb3cgbmV3IFVuYXV0aG9yaXplZEVycm9yKFwiTWVtYmVycyBtdXN0IHNpZ24gaW4gd2l0aCB0aGVpciBwaG9uZSBudW1iZXJcIik7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRFcnJvcihcIkVtYWlsIG9yIHBob25lIG51bWJlciBpcyByZXF1aXJlZFwiKTtcbiAgfVxuXG4gIGNvbnN0IHZhbGlkUGFzc3dvcmQgPSBhd2FpdCB2ZXJpZnlQYXNzd29yZChwYXNzd29yZCwgdXNlci5wYXNzd29yZEhhc2gpO1xuXG4gIGlmICghdmFsaWRQYXNzd29yZCkge1xuICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRFcnJvcihcIkludmFsaWQgY3JlZGVudGlhbHNcIik7XG4gIH1cblxuICBjb25zdCB0b2tlbiA9IHNpZ25Ub2tlbih7XG4gICAgaWQ6IHVzZXIuaWQsXG4gICAgcm9sZTogdXNlci5yb2xlLFxuICAgIHVuaW9uSWQ6IHVzZXIudW5pb25JZCxcbiAgICBkaXN0cmljdElkOiB1c2VyLmRpc3RyaWN0SWQsXG4gICAgY2h1cmNoSWQ6IHVzZXIuY2h1cmNoSWQsXG4gIH0pO1xuXG4gIGNvbnN0IHsgcGFzc3dvcmRIYXNoLCAuLi5zYWZlVXNlciB9ID0gdXNlcjtcblxuICByZXR1cm4ge1xuICAgIHRva2VuLFxuICAgIHVzZXI6IHNhZmVVc2VyIGFzIEF1dGhVc2VyLFxuICB9IHNhdGlzZmllcyB7IHRva2VuOiBzdHJpbmc7IHVzZXI6IEF1dGhVc2VyIH07XG59O1xuIl0sIm5hbWVzIjpbImJjcnlwdCIsImp3dCIsIlJvbGUiLCJwcmlzbWEiLCJlbnYiLCJVbmF1dGhvcml6ZWRFcnJvciIsIlVzZXJNb2RlbCIsIlRPS0VOX1RUTF9TRUNPTkRTIiwiaGFzaFBhc3N3b3JkIiwicGFzc3dvcmQiLCJzYWx0IiwiZ2VuU2FsdCIsImhhc2giLCJ2ZXJpZnlQYXNzd29yZCIsImNvbXBhcmUiLCJzaWduVG9rZW4iLCJ1c2VyIiwicGF5bG9hZCIsInN1YiIsImlkIiwicm9sZSIsInVuaW9uSWQiLCJkaXN0cmljdElkIiwiY2h1cmNoSWQiLCJzaWduIiwiSldUX1NFQ1JFVCIsImV4cGlyZXNJbiIsImdldFVzZXJGcm9tVG9rZW4iLCJ0b2tlbiIsImRlY29kZWQiLCJ2ZXJpZnkiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpc0FjdGl2ZSIsImVycm9yIiwiYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWxzIiwiZW1haWwiLCJwaG9uZU51bWJlciIsImZpbmRCeVBob25lTnVtYmVyIiwiTUVNQkVSIiwiZmluZEJ5RW1haWwiLCJ2YWxpZFBhc3N3b3JkIiwicGFzc3dvcmRIYXNoIiwic2FmZVVzZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/services/auth.service.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/member.service.ts":
/*!****************************************!*\
  !*** ./src/services/member.service.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createMember: () => (/* binding */ createMember),\n/* harmony export */   deleteMember: () => (/* binding */ deleteMember),\n/* harmony export */   getMemberPassForUser: () => (/* binding */ getMemberPassForUser),\n/* harmony export */   listMembersForUser: () => (/* binding */ listMembersForUser),\n/* harmony export */   updateMember: () => (/* binding */ updateMember)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _models_user_model__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/models/user.model */ \"(rsc)/./src/models/user.model.ts\");\n/* harmony import */ var _models_church_model__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/models/church.model */ \"(rsc)/./src/models/church.model.ts\");\n/* harmony import */ var _models_pass_model__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/models/pass.model */ \"(rsc)/./src/models/pass.model.ts\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/errors */ \"(rsc)/./src/lib/errors.ts\");\n/* harmony import */ var _services_auth_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/services/auth.service */ \"(rsc)/./src/services/auth.service.ts\");\n/* harmony import */ var _utils_qr__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/utils/qr */ \"(rsc)/./src/utils/qr.ts\");\n/* harmony import */ var _lib_email__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/lib/email */ \"(rsc)/./src/lib/email.ts\");\n/* harmony import */ var _lib_sms__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/lib/sms */ \"(rsc)/./src/lib/sms.ts\");\n/* harmony import */ var _lib_env__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/lib/env */ \"(rsc)/./src/lib/env.ts\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\nconst memberSelect = {\n    id: true,\n    nationalId: true,\n    firstName: true,\n    lastName: true,\n    phoneNumber: true,\n    email: true,\n    church: {\n        select: {\n            id: true,\n            name: true,\n            districtId: true\n        }\n    },\n    createdAt: true\n};\nconst toMemberSummary = (member, pass)=>({\n        id: member.id,\n        nationalId: member.nationalId,\n        firstName: member.firstName,\n        lastName: member.lastName,\n        phoneNumber: member.phoneNumber,\n        email: member.email,\n        createdAt: member.createdAt.toISOString(),\n        church: member.church ? {\n            id: member.church.id,\n            name: member.church.name,\n            districtId: member.church.districtId\n        } : null,\n        memberPass: pass ? {\n            token: pass.token,\n            smsSentAt: pass.smsSentAt ? pass.smsSentAt.toISOString() : null,\n            expiresAt: pass.expiresAt ? pass.expiresAt.toISOString() : null\n        } : null\n    });\nconst DEFAULT_FRONTEND_URL = _lib_env__WEBPACK_IMPORTED_MODULE_10__.env.CORS_ORIGIN || \"http://localhost:3000\";\nconst ensureMemberScope = (user, filters)=>{\n    if (user.role === \"UNION_ADMIN\") {\n        return;\n    }\n    if (user.role === \"DISTRICT_ADMIN\") {\n        if (!user.districtId) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"No district assigned to this account\");\n        }\n        if (filters.districtId && filters.districtId !== user.districtId) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"Cannot view members outside your district\");\n        }\n        return;\n    }\n    if (user.role === \"CHURCH_ADMIN\") {\n        if (!user.churchId) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"No church assigned to this account\");\n        }\n        if (filters.churchId && filters.churchId !== user.churchId) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"Cannot view members outside your church\");\n        }\n        return;\n    }\n    throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"Not allowed to view members\");\n};\nconst ensureMemberAccess = (user, member)=>{\n    if (user.role === \"UNION_ADMIN\") {\n        if (user.unionId && member.unionId && user.unionId !== member.unionId) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"Member belongs to another union\");\n        }\n        return;\n    }\n    if (user.role === \"DISTRICT_ADMIN\") {\n        if (!user.districtId || user.districtId !== member.districtId) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"Member belongs to another district\");\n        }\n        return;\n    }\n    if (user.role === \"CHURCH_ADMIN\") {\n        if (!user.churchId || user.churchId !== member.churchId) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"Member belongs to another church\");\n        }\n        return;\n    }\n    throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"Not allowed to manage members\");\n};\nconst updateMember = async (user, memberId, input)=>{\n    const existing = await _models_user_model__WEBPACK_IMPORTED_MODULE_2__.UserModel.findById(memberId, {\n        select: {\n            id: true,\n            role: true,\n            unionId: true,\n            districtId: true,\n            churchId: true\n        }\n    });\n    if (!existing || existing.role !== \"MEMBER\") {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.NotFoundError(\"Member not found\");\n    }\n    ensureMemberAccess(user, existing);\n    const data = {};\n    if (input.firstName !== undefined) {\n        data.firstName = input.firstName;\n    }\n    if (input.lastName !== undefined) {\n        data.lastName = input.lastName;\n    }\n    if (input.phoneNumber !== undefined) {\n        data.phoneNumber = input.phoneNumber;\n    }\n    if (input.email !== undefined) {\n        data.email = input.email;\n    }\n    if (Object.keys(data).length === 0) {\n        const member = await _models_user_model__WEBPACK_IMPORTED_MODULE_2__.UserModel.findById(memberId, {\n            select: memberSelect\n        });\n        return {\n            member\n        };\n    }\n    try {\n        const member = await _models_user_model__WEBPACK_IMPORTED_MODULE_2__.UserModel.update({\n            where: {\n                id: memberId\n            },\n            data,\n            select: memberSelect\n        });\n        return {\n            member\n        };\n    } catch (error) {\n        if (error instanceof _prisma_client__WEBPACK_IMPORTED_MODULE_0__.Prisma.PrismaClientKnownRequestError && error.code === \"P2002\" && error.meta?.target && Array.isArray(error.meta.target) && error.meta.target.includes(\"email\")) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ConflictError(\"Email already in use\");\n        }\n        throw error;\n    }\n};\nconst deleteMember = async (user, memberId)=>{\n    const existing = await _models_user_model__WEBPACK_IMPORTED_MODULE_2__.UserModel.findById(memberId, {\n        select: {\n            id: true,\n            role: true,\n            unionId: true,\n            districtId: true,\n            churchId: true\n        }\n    });\n    if (!existing || existing.role !== \"MEMBER\") {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.NotFoundError(\"Member not found\");\n    }\n    ensureMemberAccess(user, existing);\n    await _lib_prisma__WEBPACK_IMPORTED_MODULE_11__.prisma.memberPass.deleteMany({\n        where: {\n            memberId\n        }\n    });\n    await _models_user_model__WEBPACK_IMPORTED_MODULE_2__.UserModel.delete({\n        where: {\n            id: memberId\n        }\n    });\n    return {\n        success: true\n    };\n};\nconst listMembersForUser = async (user, filters = {})=>{\n    ensureMemberScope(user, filters);\n    const where = {\n        role: \"MEMBER\"\n    };\n    if (filters.districtId) {\n        where.districtId = filters.districtId;\n    }\n    if (filters.churchId) {\n        where.churchId = filters.churchId;\n    }\n    if (user.role === \"DISTRICT_ADMIN\" && !filters.districtId) {\n        where.districtId = user.districtId ?? undefined;\n    }\n    if (user.role === \"CHURCH_ADMIN\" && !filters.churchId) {\n        where.churchId = user.churchId ?? undefined;\n    }\n    const members = await _lib_prisma__WEBPACK_IMPORTED_MODULE_11__.prisma.user.findMany({\n        where,\n        select: memberSelect,\n        orderBy: {\n            lastName: \"asc\"\n        }\n    });\n    if (members.length === 0) {\n        return [];\n    }\n    const memberIds = members.map((member)=>member.id);\n    const passes = await _lib_prisma__WEBPACK_IMPORTED_MODULE_11__.prisma.memberPass.findMany({\n        where: {\n            memberId: {\n                in: memberIds\n            }\n        },\n        select: {\n            memberId: true,\n            token: true,\n            smsSentAt: true,\n            expiresAt: true\n        }\n    });\n    const passByMember = new Map();\n    passes.forEach((pass)=>{\n        passByMember.set(pass.memberId, {\n            token: pass.token,\n            smsSentAt: pass.smsSentAt,\n            expiresAt: pass.expiresAt\n        });\n    });\n    return members.map((member)=>toMemberSummary(member, passByMember.get(member.id) ?? null));\n};\nconst getMemberPassForUser = async (user, memberId)=>{\n    const member = await _lib_prisma__WEBPACK_IMPORTED_MODULE_11__.prisma.user.findUnique({\n        where: {\n            id: memberId\n        },\n        select: {\n            id: true,\n            role: true,\n            unionId: true,\n            districtId: true,\n            churchId: true,\n            firstName: true,\n            lastName: true,\n            nationalId: true,\n            phoneNumber: true,\n            email: true,\n            church: {\n                select: {\n                    id: true,\n                    name: true,\n                    districtId: true\n                }\n            },\n            createdAt: true\n        }\n    });\n    if (!member || member.role !== \"MEMBER\") {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.NotFoundError(\"Member not found\");\n    }\n    if (user.role === \"MEMBER\") {\n        if (user.id !== member.id) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"Not allowed to view other member passes\");\n        }\n    } else {\n        ensureMemberAccess(user, member);\n    }\n    const pass = await _lib_prisma__WEBPACK_IMPORTED_MODULE_11__.prisma.memberPass.findUnique({\n        where: {\n            memberId\n        },\n        select: {\n            id: true,\n            token: true,\n            qrPayload: true,\n            expiresAt: true,\n            smsSentAt: true\n        }\n    });\n    if (!pass) {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.NotFoundError(\"Member pass not found\");\n    }\n    return {\n        member: {\n            id: member.id,\n            firstName: member.firstName,\n            lastName: member.lastName,\n            nationalId: member.nationalId,\n            phoneNumber: member.phoneNumber,\n            email: member.email,\n            createdAt: member.createdAt.toISOString(),\n            church: member.church ? {\n                id: member.church.id,\n                name: member.church.name,\n                districtId: member.church.districtId\n            } : null\n        },\n        pass: {\n            ...pass,\n            smsSentAt: pass.smsSentAt ? pass.smsSentAt.toISOString() : null,\n            expiresAt: pass.expiresAt ? pass.expiresAt.toISOString() : null\n        }\n    };\n};\nconst createMember = async (user, input)=>{\n    if (user.role !== \"CHURCH_ADMIN\") {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"Only church admins can create members\");\n    }\n    if (!user.churchId) {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ForbiddenError(\"No church assigned to this account\");\n    }\n    const church = await _models_church_model__WEBPACK_IMPORTED_MODULE_3__.ChurchModel.findById(user.churchId, {\n        where: {\n            id: user.churchId\n        },\n        include: {\n            district: {\n                include: {\n                    union: true\n                }\n            }\n        }\n    });\n    if (!church) {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.NotFoundError(\"Church not found\");\n    }\n    if (input.email) {\n        const existingByEmail = await _models_user_model__WEBPACK_IMPORTED_MODULE_2__.UserModel.findByEmail(input.email);\n        if (existingByEmail) {\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ConflictError(\"A user with this email already exists\");\n        }\n    }\n    const existingByPhone = await _models_user_model__WEBPACK_IMPORTED_MODULE_2__.UserModel.findByPhoneNumber(input.phoneNumber);\n    if (existingByPhone) {\n        throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ConflictError(\"A user with this phone number already exists\");\n    }\n    const passwordHash = await (0,_services_auth_service__WEBPACK_IMPORTED_MODULE_6__.hashPassword)(input.password);\n    try {\n        const member = await _models_user_model__WEBPACK_IMPORTED_MODULE_2__.UserModel.create({\n            data: {\n                username: input.nationalId,\n                nationalId: input.nationalId,\n                firstName: input.firstName,\n                lastName: input.lastName,\n                phoneNumber: input.phoneNumber,\n                email: input.email,\n                passwordHash,\n                role: \"MEMBER\",\n                unionId: church.district.unionId,\n                districtId: church.districtId,\n                churchId: church.id\n            },\n            select: memberSelect\n        });\n        const passToken = crypto__WEBPACK_IMPORTED_MODULE_1___default().randomUUID();\n        const qrPayload = await (0,_utils_qr__WEBPACK_IMPORTED_MODULE_7__.generateQrPayload)(passToken);\n        let memberPassRecord = await _lib_prisma__WEBPACK_IMPORTED_MODULE_11__.prisma.memberPass.create({\n            data: {\n                memberId: member.id,\n                token: passToken,\n                qrPayload\n            }\n        });\n        await _models_pass_model__WEBPACK_IMPORTED_MODULE_4__.PassModel.upsert({\n            where: {\n                memberId: member.id\n            },\n            update: {\n                token: passToken,\n                qrPayload,\n                sessionDate: new Date(),\n                churchId: member.church?.id ?? null\n            },\n            create: {\n                memberId: member.id,\n                churchId: member.church?.id ?? null,\n                token: passToken,\n                qrPayload,\n                sessionDate: new Date()\n            }\n        });\n        const loginUrl = `${DEFAULT_FRONTEND_URL}/login`;\n        const passUrl = `${DEFAULT_FRONTEND_URL}/member/pass`;\n        let smsSentAt = null;\n        if (member.phoneNumber) {\n            const message = [\n                `Murakaza neza mu Umuganda SDA, ${member.firstName}.`,\n                `Injira kuri ${loginUrl} ukoresheje iri nambara y'indangamuntu: ${member.nationalId}.`,\n                `Ijambo ry'ibanga wahawe: ${input.password}.`,\n                `Ikarita yawe ya QR iri hano: ${passUrl}.`\n            ].join(\" \");\n            try {\n                await (0,_lib_sms__WEBPACK_IMPORTED_MODULE_9__.sendSms)({\n                    to: member.phoneNumber,\n                    message\n                });\n                smsSentAt = new Date();\n                memberPassRecord = await _lib_prisma__WEBPACK_IMPORTED_MODULE_11__.prisma.memberPass.update({\n                    where: {\n                        id: memberPassRecord.id\n                    },\n                    data: {\n                        smsSentAt\n                    }\n                });\n            } catch (smsError) {\n                // Log and continue without failing member creation\n                console.error(\"Failed to send member onboarding SMS\", smsError);\n            }\n        }\n        if (member.email) {\n            try {\n                await (0,_lib_email__WEBPACK_IMPORTED_MODULE_8__.sendMemberWelcomeEmail)({\n                    to: member.email,\n                    firstName: member.firstName,\n                    lastName: member.lastName,\n                    phoneNumber: member.phoneNumber,\n                    password: input.password,\n                    nationalId: member.nationalId,\n                    churchName: member.church?.name ?? null,\n                    loginUrl,\n                    passUrl,\n                    qrPayload,\n                    passToken\n                });\n            } catch (emailError) {\n                console.error(\"Failed to send member welcome email\", emailError);\n            }\n        }\n        return {\n            member: toMemberSummary(member, {\n                token: memberPassRecord.token,\n                smsSentAt: memberPassRecord.smsSentAt,\n                expiresAt: memberPassRecord.expiresAt\n            }),\n            memberPass: {\n                id: memberPassRecord.id,\n                token: passToken,\n                qrPayload,\n                smsSentAt\n            }\n        };\n    } catch (error) {\n        if (error instanceof _prisma_client__WEBPACK_IMPORTED_MODULE_0__.Prisma.PrismaClientKnownRequestError && error.code === \"P2002\") {\n            const target = Array.isArray(error.meta?.target) ? error.meta?.target : [];\n            if (target.includes(\"nationalId\") || target.includes(\"username\")) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ConflictError(\"A member with this national ID already exists\");\n            }\n            if (target.includes(\"email\")) {\n                throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ConflictError(\"A user with this email already exists\");\n            }\n            throw new _lib_errors__WEBPACK_IMPORTED_MODULE_5__.ConflictError(\"Member already exists\");\n        }\n        throw error;\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0MsTUFBTUMsT0FBTyxDQUFDTixNQUFNRyxJQUFJLEVBQUVDLFVBQVVKLE1BQU1HLElBQUksRUFBRUMsU0FBUyxFQUFFO1lBRTFFLElBQUlBLE9BQU9HLFFBQVEsQ0FBQyxpQkFBaUJILE9BQU9HLFFBQVEsQ0FBQyxhQUFhO2dCQUNoRSxNQUFNLElBQUl2RCxzREFBYUEsQ0FBQztZQUMxQjtZQUVBLElBQUlvRCxPQUFPRyxRQUFRLENBQUMsVUFBVTtnQkFDNUIsTUFBTSxJQUFJdkQsc0RBQWFBLENBQUM7WUFDMUI7WUFFQSxNQUFNLElBQUlBLHNEQUFhQSxDQUFDO1FBQzFCO1FBRUEsTUFBTWdEO0lBQ1I7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2RhLWJhY2tlbmQvLi9zcmMvc2VydmljZXMvbWVtYmVyLnNlcnZpY2UudHM/YTgxNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWEsIHR5cGUgVXNlciB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xuaW1wb3J0IGNyeXB0byBmcm9tIFwiY3J5cHRvXCI7XG5cbmltcG9ydCB7IFVzZXJNb2RlbCB9IGZyb20gXCJAL21vZGVscy91c2VyLm1vZGVsXCI7XG5pbXBvcnQgeyBDaHVyY2hNb2RlbCB9IGZyb20gXCJAL21vZGVscy9jaHVyY2gubW9kZWxcIjtcbmltcG9ydCB7IFBhc3NNb2RlbCB9IGZyb20gXCJAL21vZGVscy9wYXNzLm1vZGVsXCI7XG5pbXBvcnQgeyBGb3JiaWRkZW5FcnJvciwgTm90Rm91bmRFcnJvciwgQ29uZmxpY3RFcnJvciB9IGZyb20gXCJAL2xpYi9lcnJvcnNcIjtcbmltcG9ydCB7IGhhc2hQYXNzd29yZCB9IGZyb20gXCJAL3NlcnZpY2VzL2F1dGguc2VydmljZVwiO1xuaW1wb3J0IHsgZ2VuZXJhdGVRclBheWxvYWQgfSBmcm9tIFwiQC91dGlscy9xclwiO1xuaW1wb3J0IHsgc2VuZE1lbWJlcldlbGNvbWVFbWFpbCwgc2VuZEFjY291bnRDcmVkZW50aWFsc0VtYWlsIH0gZnJvbSBcIkAvbGliL2VtYWlsXCI7XG5pbXBvcnQgeyBzZW5kU21zIH0gZnJvbSBcIkAvbGliL3Ntc1wiO1xuaW1wb3J0IHsgZW52IH0gZnJvbSBcIkAvbGliL2VudlwiO1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xuXG5jb25zdCBtZW1iZXJTZWxlY3QgPSB7XG4gIGlkOiB0cnVlLFxuICBuYXRpb25hbElkOiB0cnVlLFxuICBmaXJzdE5hbWU6IHRydWUsXG4gIGxhc3ROYW1lOiB0cnVlLFxuICBwaG9uZU51bWJlcjogdHJ1ZSxcbiAgZW1haWw6IHRydWUsXG4gIGNodXJjaDoge1xuICAgIHNlbGVjdDoge1xuICAgICAgaWQ6IHRydWUsXG4gICAgICBuYW1lOiB0cnVlLFxuICAgICAgZGlzdHJpY3RJZDogdHJ1ZSxcbiAgICB9LFxuICB9LFxuICBjcmVhdGVkQXQ6IHRydWUsXG59IHNhdGlzZmllcyBQcmlzbWEuVXNlclNlbGVjdDtcblxudHlwZSBNZW1iZXJSZWNvcmQgPSBQcmlzbWEuVXNlckdldFBheWxvYWQ8eyBzZWxlY3Q6IHR5cGVvZiBtZW1iZXJTZWxlY3QgfT47XG5cbnR5cGUgTWVtYmVyUGFzc1JlY29yZCA9IHtcbiAgdG9rZW46IHN0cmluZztcbiAgc21zU2VudEF0OiBEYXRlIHwgbnVsbDtcbiAgZXhwaXJlc0F0OiBEYXRlIHwgbnVsbDtcbn07XG5cbmV4cG9ydCB0eXBlIE1lbWJlclN1bW1hcnkgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hdGlvbmFsSWQ6IHN0cmluZztcbiAgZmlyc3ROYW1lOiBzdHJpbmc7XG4gIGxhc3ROYW1lOiBzdHJpbmc7XG4gIHBob25lTnVtYmVyOiBzdHJpbmc7XG4gIGVtYWlsOiBzdHJpbmcgfCBudWxsO1xuICBjcmVhdGVkQXQ6IHN0cmluZztcbiAgY2h1cmNoOiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgZGlzdHJpY3RJZDogc3RyaW5nO1xuICB9IHwgbnVsbDtcbiAgbWVtYmVyUGFzczoge1xuICAgIHRva2VuOiBzdHJpbmc7XG4gICAgc21zU2VudEF0OiBzdHJpbmcgfCBudWxsO1xuICAgIGV4cGlyZXNBdDogc3RyaW5nIHwgbnVsbDtcbiAgfSB8IG51bGw7XG59O1xuXG5jb25zdCB0b01lbWJlclN1bW1hcnkgPSAobWVtYmVyOiBNZW1iZXJSZWNvcmQsIHBhc3M/OiBNZW1iZXJQYXNzUmVjb3JkIHwgbnVsbCk6IE1lbWJlclN1bW1hcnkgPT4gKHtcbiAgaWQ6IG1lbWJlci5pZCxcbiAgbmF0aW9uYWxJZDogbWVtYmVyLm5hdGlvbmFsSWQsXG4gIGZpcnN0TmFtZTogbWVtYmVyLmZpcnN0TmFtZSxcbiAgbGFzdE5hbWU6IG1lbWJlci5sYXN0TmFtZSxcbiAgcGhvbmVOdW1iZXI6IG1lbWJlci5waG9uZU51bWJlcixcbiAgZW1haWw6IG1lbWJlci5lbWFpbCxcbiAgY3JlYXRlZEF0OiBtZW1iZXIuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXG4gIGNodXJjaDogbWVtYmVyLmNodXJjaFxuICAgID8ge1xuICAgICAgICBpZDogbWVtYmVyLmNodXJjaC5pZCxcbiAgICAgICAgbmFtZTogbWVtYmVyLmNodXJjaC5uYW1lLFxuICAgICAgICBkaXN0cmljdElkOiBtZW1iZXIuY2h1cmNoLmRpc3RyaWN0SWQsXG4gICAgICB9XG4gICAgOiBudWxsLFxuICBtZW1iZXJQYXNzOiBwYXNzXG4gICAgPyB7XG4gICAgICAgIHRva2VuOiBwYXNzLnRva2VuLFxuICAgICAgICBzbXNTZW50QXQ6IHBhc3Muc21zU2VudEF0ID8gcGFzcy5zbXNTZW50QXQudG9JU09TdHJpbmcoKSA6IG51bGwsXG4gICAgICAgIGV4cGlyZXNBdDogcGFzcy5leHBpcmVzQXQgPyBwYXNzLmV4cGlyZXNBdC50b0lTT1N0cmluZygpIDogbnVsbCxcbiAgICAgIH1cbiAgICA6IG51bGwsXG59KTtcblxuZXhwb3J0IGludGVyZmFjZSBNZW1iZXJGaWx0ZXJzIHtcbiAgZGlzdHJpY3RJZD86IHN0cmluZztcbiAgY2h1cmNoSWQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3JlYXRlTWVtYmVySW5wdXQge1xuICBuYXRpb25hbElkOiBzdHJpbmc7XG4gIGZpcnN0TmFtZTogc3RyaW5nO1xuICBsYXN0TmFtZTogc3RyaW5nO1xuICBwaG9uZU51bWJlcjogc3RyaW5nO1xuICBlbWFpbD86IHN0cmluZyB8IG51bGw7XG4gIHBhc3N3b3JkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3JlYXRlTWVtYmVyUmVzdWx0IHtcbiAgbWVtYmVyOiBNZW1iZXJTdW1tYXJ5O1xuICBtZW1iZXJQYXNzOiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICB0b2tlbjogc3RyaW5nO1xuICAgIHFyUGF5bG9hZDogc3RyaW5nO1xuICAgIHNtc1NlbnRBdDogRGF0ZSB8IG51bGw7XG4gIH07XG59XG5cbmNvbnN0IERFRkFVTFRfRlJPTlRFTkRfVVJMID0gZW52LkNPUlNfT1JJR0lOIHx8IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXBkYXRlTWVtYmVySW5wdXQge1xuICBmaXJzdE5hbWU/OiBzdHJpbmc7XG4gIGxhc3ROYW1lPzogc3RyaW5nO1xuICBwaG9uZU51bWJlcj86IHN0cmluZztcbiAgZW1haWw/OiBzdHJpbmcgfCBudWxsO1xufVxuXG5jb25zdCBlbnN1cmVNZW1iZXJTY29wZSA9ICh1c2VyOiBVc2VyLCBmaWx0ZXJzOiBNZW1iZXJGaWx0ZXJzKSA9PiB7XG4gIGlmICh1c2VyLnJvbGUgPT09IFwiVU5JT05fQURNSU5cIikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh1c2VyLnJvbGUgPT09IFwiRElTVFJJQ1RfQURNSU5cIikge1xuICAgIGlmICghdXNlci5kaXN0cmljdElkKSB7XG4gICAgICB0aHJvdyBuZXcgRm9yYmlkZGVuRXJyb3IoXCJObyBkaXN0cmljdCBhc3NpZ25lZCB0byB0aGlzIGFjY291bnRcIik7XG4gICAgfVxuICAgIGlmIChmaWx0ZXJzLmRpc3RyaWN0SWQgJiYgZmlsdGVycy5kaXN0cmljdElkICE9PSB1c2VyLmRpc3RyaWN0SWQpIHtcbiAgICAgIHRocm93IG5ldyBGb3JiaWRkZW5FcnJvcihcIkNhbm5vdCB2aWV3IG1lbWJlcnMgb3V0c2lkZSB5b3VyIGRpc3RyaWN0XCIpO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodXNlci5yb2xlID09PSBcIkNIVVJDSF9BRE1JTlwiKSB7XG4gICAgaWYgKCF1c2VyLmNodXJjaElkKSB7XG4gICAgICB0aHJvdyBuZXcgRm9yYmlkZGVuRXJyb3IoXCJObyBjaHVyY2ggYXNzaWduZWQgdG8gdGhpcyBhY2NvdW50XCIpO1xuICAgIH1cbiAgICBpZiAoZmlsdGVycy5jaHVyY2hJZCAmJiBmaWx0ZXJzLmNodXJjaElkICE9PSB1c2VyLmNodXJjaElkKSB7XG4gICAgICB0aHJvdyBuZXcgRm9yYmlkZGVuRXJyb3IoXCJDYW5ub3QgdmlldyBtZW1iZXJzIG91dHNpZGUgeW91ciBjaHVyY2hcIik7XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuXG4gIHRocm93IG5ldyBGb3JiaWRkZW5FcnJvcihcIk5vdCBhbGxvd2VkIHRvIHZpZXcgbWVtYmVyc1wiKTtcbn07XG5cbmNvbnN0IGVuc3VyZU1lbWJlckFjY2VzcyA9IChcbiAgdXNlcjogVXNlcixcbiAgbWVtYmVyOiB7IHVuaW9uSWQ6IHN0cmluZyB8IG51bGw7IGRpc3RyaWN0SWQ6IHN0cmluZyB8IG51bGw7IGNodXJjaElkOiBzdHJpbmcgfCBudWxsIH0sXG4pID0+IHtcbiAgaWYgKHVzZXIucm9sZSA9PT0gXCJVTklPTl9BRE1JTlwiKSB7XG4gICAgaWYgKHVzZXIudW5pb25JZCAmJiBtZW1iZXIudW5pb25JZCAmJiB1c2VyLnVuaW9uSWQgIT09IG1lbWJlci51bmlvbklkKSB7XG4gICAgICB0aHJvdyBuZXcgRm9yYmlkZGVuRXJyb3IoXCJNZW1iZXIgYmVsb25ncyB0byBhbm90aGVyIHVuaW9uXCIpO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodXNlci5yb2xlID09PSBcIkRJU1RSSUNUX0FETUlOXCIpIHtcbiAgICBpZiAoIXVzZXIuZGlzdHJpY3RJZCB8fCB1c2VyLmRpc3RyaWN0SWQgIT09IG1lbWJlci5kaXN0cmljdElkKSB7XG4gICAgICB0aHJvdyBuZXcgRm9yYmlkZGVuRXJyb3IoXCJNZW1iZXIgYmVsb25ncyB0byBhbm90aGVyIGRpc3RyaWN0XCIpO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodXNlci5yb2xlID09PSBcIkNIVVJDSF9BRE1JTlwiKSB7XG4gICAgaWYgKCF1c2VyLmNodXJjaElkIHx8IHVzZXIuY2h1cmNoSWQgIT09IG1lbWJlci5jaHVyY2hJZCkge1xuICAgICAgdGhyb3cgbmV3IEZvcmJpZGRlbkVycm9yKFwiTWVtYmVyIGJlbG9uZ3MgdG8gYW5vdGhlciBjaHVyY2hcIik7XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuXG4gIHRocm93IG5ldyBGb3JiaWRkZW5FcnJvcihcIk5vdCBhbGxvd2VkIHRvIG1hbmFnZSBtZW1iZXJzXCIpO1xufTtcblxuZXhwb3J0IGNvbnN0IHVwZGF0ZU1lbWJlciA9IGFzeW5jICh1c2VyOiBVc2VyLCBtZW1iZXJJZDogc3RyaW5nLCBpbnB1dDogVXBkYXRlTWVtYmVySW5wdXQpID0+IHtcbiAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCBVc2VyTW9kZWwuZmluZEJ5SWQobWVtYmVySWQsIHtcbiAgICBzZWxlY3Q6IHtcbiAgICAgIGlkOiB0cnVlLFxuICAgICAgcm9sZTogdHJ1ZSxcbiAgICAgIHVuaW9uSWQ6IHRydWUsXG4gICAgICBkaXN0cmljdElkOiB0cnVlLFxuICAgICAgY2h1cmNoSWQ6IHRydWUsXG4gICAgfSxcbiAgfSk7XG5cbiAgaWYgKCFleGlzdGluZyB8fCBleGlzdGluZy5yb2xlICE9PSBcIk1FTUJFUlwiKSB7XG4gICAgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoXCJNZW1iZXIgbm90IGZvdW5kXCIpO1xuICB9XG5cbiAgZW5zdXJlTWVtYmVyQWNjZXNzKHVzZXIsIGV4aXN0aW5nKTtcblxuICBjb25zdCBkYXRhOiBQcmlzbWEuVXNlclVwZGF0ZUlucHV0ID0ge307XG5cbiAgaWYgKGlucHV0LmZpcnN0TmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGF0YS5maXJzdE5hbWUgPSBpbnB1dC5maXJzdE5hbWU7XG4gIH1cbiAgaWYgKGlucHV0Lmxhc3ROYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICBkYXRhLmxhc3ROYW1lID0gaW5wdXQubGFzdE5hbWU7XG4gIH1cbiAgaWYgKGlucHV0LnBob25lTnVtYmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICBkYXRhLnBob25lTnVtYmVyID0gaW5wdXQucGhvbmVOdW1iZXI7XG4gIH1cbiAgaWYgKGlucHV0LmVtYWlsICE9PSB1bmRlZmluZWQpIHtcbiAgICBkYXRhLmVtYWlsID0gaW5wdXQuZW1haWw7XG4gIH1cblxuICBpZiAoT2JqZWN0LmtleXMoZGF0YSkubGVuZ3RoID09PSAwKSB7XG4gICAgY29uc3QgbWVtYmVyID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeUlkKG1lbWJlcklkLCB7IHNlbGVjdDogbWVtYmVyU2VsZWN0IH0pO1xuICAgIHJldHVybiB7IG1lbWJlciB9O1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBtZW1iZXIgPSBhd2FpdCBVc2VyTW9kZWwudXBkYXRlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBtZW1iZXJJZCB9LFxuICAgICAgZGF0YSxcbiAgICAgIHNlbGVjdDogbWVtYmVyU2VsZWN0LFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHsgbWVtYmVyIH07XG4gIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XG4gICAgaWYgKFxuICAgICAgZXJyb3IgaW5zdGFuY2VvZiBQcmlzbWEuUHJpc21hQ2xpZW50S25vd25SZXF1ZXN0RXJyb3IgJiZcbiAgICAgIGVycm9yLmNvZGUgPT09IFwiUDIwMDJcIiAmJlxuICAgICAgZXJyb3IubWV0YT8udGFyZ2V0ICYmXG4gICAgICBBcnJheS5pc0FycmF5KGVycm9yLm1ldGEudGFyZ2V0KSAmJlxuICAgICAgZXJyb3IubWV0YS50YXJnZXQuaW5jbHVkZXMoXCJlbWFpbFwiKVxuICAgICkge1xuICAgICAgdGhyb3cgbmV3IENvbmZsaWN0RXJyb3IoXCJFbWFpbCBhbHJlYWR5IGluIHVzZVwiKTtcbiAgICB9XG5cbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGRlbGV0ZU1lbWJlciA9IGFzeW5jICh1c2VyOiBVc2VyLCBtZW1iZXJJZDogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeUlkKG1lbWJlcklkLCB7XG4gICAgc2VsZWN0OiB7XG4gICAgICBpZDogdHJ1ZSxcbiAgICAgIHJvbGU6IHRydWUsXG4gICAgICB1bmlvbklkOiB0cnVlLFxuICAgICAgZGlzdHJpY3RJZDogdHJ1ZSxcbiAgICAgIGNodXJjaElkOiB0cnVlLFxuICAgIH0sXG4gIH0pO1xuXG4gIGlmICghZXhpc3RpbmcgfHwgZXhpc3Rpbmcucm9sZSAhPT0gXCJNRU1CRVJcIikge1xuICAgIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKFwiTWVtYmVyIG5vdCBmb3VuZFwiKTtcbiAgfVxuXG4gIGVuc3VyZU1lbWJlckFjY2Vzcyh1c2VyLCBleGlzdGluZyk7XG5cbiAgYXdhaXQgcHJpc21hLm1lbWJlclBhc3MuZGVsZXRlTWFueSh7IHdoZXJlOiB7IG1lbWJlcklkIH0gfSk7XG5cbiAgYXdhaXQgVXNlck1vZGVsLmRlbGV0ZSh7IHdoZXJlOiB7IGlkOiBtZW1iZXJJZCB9IH0pO1xuXG4gIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBsaXN0TWVtYmVyc0ZvclVzZXIgPSBhc3luYyAodXNlcjogVXNlciwgZmlsdGVyczogTWVtYmVyRmlsdGVycyA9IHt9KSA9PiB7XG4gIGVuc3VyZU1lbWJlclNjb3BlKHVzZXIsIGZpbHRlcnMpO1xuXG4gIGNvbnN0IHdoZXJlOiBQcmlzbWEuVXNlcldoZXJlSW5wdXQgPSB7XG4gICAgcm9sZTogXCJNRU1CRVJcIixcbiAgfTtcblxuICBpZiAoZmlsdGVycy5kaXN0cmljdElkKSB7XG4gICAgd2hlcmUuZGlzdHJpY3RJZCA9IGZpbHRlcnMuZGlzdHJpY3RJZDtcbiAgfVxuXG4gIGlmIChmaWx0ZXJzLmNodXJjaElkKSB7XG4gICAgd2hlcmUuY2h1cmNoSWQgPSBmaWx0ZXJzLmNodXJjaElkO1xuICB9XG5cbiAgaWYgKHVzZXIucm9sZSA9PT0gXCJESVNUUklDVF9BRE1JTlwiICYmICFmaWx0ZXJzLmRpc3RyaWN0SWQpIHtcbiAgICB3aGVyZS5kaXN0cmljdElkID0gdXNlci5kaXN0cmljdElkID8/IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmICh1c2VyLnJvbGUgPT09IFwiQ0hVUkNIX0FETUlOXCIgJiYgIWZpbHRlcnMuY2h1cmNoSWQpIHtcbiAgICB3aGVyZS5jaHVyY2hJZCA9IHVzZXIuY2h1cmNoSWQgPz8gdW5kZWZpbmVkO1xuICB9XG5cbiAgY29uc3QgbWVtYmVycyA9IChhd2FpdCBwcmlzbWEudXNlci5maW5kTWFueSh7XG4gICAgd2hlcmUsXG4gICAgc2VsZWN0OiBtZW1iZXJTZWxlY3QsXG4gICAgb3JkZXJCeTogeyBsYXN0TmFtZTogXCJhc2NcIiB9LFxuICB9KSkgYXMgTWVtYmVyUmVjb3JkW107XG5cbiAgaWYgKG1lbWJlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgY29uc3QgbWVtYmVySWRzID0gbWVtYmVycy5tYXAoKG1lbWJlcikgPT4gbWVtYmVyLmlkKTtcbiAgY29uc3QgcGFzc2VzID0gYXdhaXQgcHJpc21hLm1lbWJlclBhc3MuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IG1lbWJlcklkOiB7IGluOiBtZW1iZXJJZHMgfSB9LFxuICAgIHNlbGVjdDoge1xuICAgICAgbWVtYmVySWQ6IHRydWUsXG4gICAgICB0b2tlbjogdHJ1ZSxcbiAgICAgIHNtc1NlbnRBdDogdHJ1ZSxcbiAgICAgIGV4cGlyZXNBdDogdHJ1ZSxcbiAgICB9LFxuICB9KTtcblxuICBjb25zdCBwYXNzQnlNZW1iZXIgPSBuZXcgTWFwPHN0cmluZywgTWVtYmVyUGFzc1JlY29yZD4oKTtcbiAgcGFzc2VzLmZvckVhY2goKHBhc3MpID0+IHtcbiAgICBwYXNzQnlNZW1iZXIuc2V0KHBhc3MubWVtYmVySWQsIHtcbiAgICAgIHRva2VuOiBwYXNzLnRva2VuLFxuICAgICAgc21zU2VudEF0OiBwYXNzLnNtc1NlbnRBdCxcbiAgICAgIGV4cGlyZXNBdDogcGFzcy5leHBpcmVzQXQsXG4gICAgfSk7XG4gIH0pO1xuXG4gIHJldHVybiBtZW1iZXJzLm1hcCgobWVtYmVyKSA9PiB0b01lbWJlclN1bW1hcnkobWVtYmVyLCBwYXNzQnlNZW1iZXIuZ2V0KG1lbWJlci5pZCkgPz8gbnVsbCkpO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldE1lbWJlclBhc3NGb3JVc2VyID0gYXN5bmMgKHVzZXI6IFVzZXIsIG1lbWJlcklkOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgbWVtYmVyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IG1lbWJlcklkIH0sXG4gICAgc2VsZWN0OiB7XG4gICAgICBpZDogdHJ1ZSxcbiAgICAgIHJvbGU6IHRydWUsXG4gICAgICB1bmlvbklkOiB0cnVlLFxuICAgICAgZGlzdHJpY3RJZDogdHJ1ZSxcbiAgICAgIGNodXJjaElkOiB0cnVlLFxuICAgICAgZmlyc3ROYW1lOiB0cnVlLFxuICAgICAgbGFzdE5hbWU6IHRydWUsXG4gICAgICBuYXRpb25hbElkOiB0cnVlLFxuICAgICAgcGhvbmVOdW1iZXI6IHRydWUsXG4gICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgIGNodXJjaDoge1xuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIGRpc3RyaWN0SWQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgY3JlYXRlZEF0OiB0cnVlLFxuICAgIH0sXG4gIH0pO1xuXG4gIGlmICghbWVtYmVyIHx8IG1lbWJlci5yb2xlICE9PSBcIk1FTUJFUlwiKSB7XG4gICAgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoXCJNZW1iZXIgbm90IGZvdW5kXCIpO1xuICB9XG5cbiAgaWYgKHVzZXIucm9sZSA9PT0gXCJNRU1CRVJcIikge1xuICAgIGlmICh1c2VyLmlkICE9PSBtZW1iZXIuaWQpIHtcbiAgICAgIHRocm93IG5ldyBGb3JiaWRkZW5FcnJvcihcIk5vdCBhbGxvd2VkIHRvIHZpZXcgb3RoZXIgbWVtYmVyIHBhc3Nlc1wiKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgZW5zdXJlTWVtYmVyQWNjZXNzKHVzZXIsIG1lbWJlcik7XG4gIH1cblxuICBjb25zdCBwYXNzID0gYXdhaXQgcHJpc21hLm1lbWJlclBhc3MuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgbWVtYmVySWQgfSxcbiAgICBzZWxlY3Q6IHtcbiAgICAgIGlkOiB0cnVlLFxuICAgICAgdG9rZW46IHRydWUsXG4gICAgICBxclBheWxvYWQ6IHRydWUsXG4gICAgICBleHBpcmVzQXQ6IHRydWUsXG4gICAgICBzbXNTZW50QXQ6IHRydWUsXG4gICAgfSxcbiAgfSk7XG5cbiAgaWYgKCFwYXNzKSB7XG4gICAgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoXCJNZW1iZXIgcGFzcyBub3QgZm91bmRcIik7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIG1lbWJlcjoge1xuICAgICAgaWQ6IG1lbWJlci5pZCxcbiAgICAgIGZpcnN0TmFtZTogbWVtYmVyLmZpcnN0TmFtZSxcbiAgICAgIGxhc3ROYW1lOiBtZW1iZXIubGFzdE5hbWUsXG4gICAgICBuYXRpb25hbElkOiBtZW1iZXIubmF0aW9uYWxJZCxcbiAgICAgIHBob25lTnVtYmVyOiBtZW1iZXIucGhvbmVOdW1iZXIsXG4gICAgICBlbWFpbDogbWVtYmVyLmVtYWlsLFxuICAgICAgY3JlYXRlZEF0OiBtZW1iZXIuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXG4gICAgICBjaHVyY2g6IG1lbWJlci5jaHVyY2hcbiAgICAgICAgPyB7XG4gICAgICAgICAgICBpZDogbWVtYmVyLmNodXJjaC5pZCxcbiAgICAgICAgICAgIG5hbWU6IG1lbWJlci5jaHVyY2gubmFtZSxcbiAgICAgICAgICAgIGRpc3RyaWN0SWQ6IG1lbWJlci5jaHVyY2guZGlzdHJpY3RJZCxcbiAgICAgICAgICB9XG4gICAgICAgIDogbnVsbCxcbiAgICB9LFxuICAgIHBhc3M6IHtcbiAgICAgIC4uLnBhc3MsXG4gICAgICBzbXNTZW50QXQ6IHBhc3Muc21zU2VudEF0ID8gcGFzcy5zbXNTZW50QXQudG9JU09TdHJpbmcoKSA6IG51bGwsXG4gICAgICBleHBpcmVzQXQ6IHBhc3MuZXhwaXJlc0F0ID8gcGFzcy5leHBpcmVzQXQudG9JU09TdHJpbmcoKSA6IG51bGwsXG4gICAgfSxcbiAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVNZW1iZXIgPSBhc3luYyAodXNlcjogVXNlciwgaW5wdXQ6IENyZWF0ZU1lbWJlcklucHV0KTogUHJvbWlzZTxDcmVhdGVNZW1iZXJSZXN1bHQ+ID0+IHtcbiAgaWYgKHVzZXIucm9sZSAhPT0gXCJDSFVSQ0hfQURNSU5cIikge1xuICAgIHRocm93IG5ldyBGb3JiaWRkZW5FcnJvcihcIk9ubHkgY2h1cmNoIGFkbWlucyBjYW4gY3JlYXRlIG1lbWJlcnNcIik7XG4gIH1cblxuICBpZiAoIXVzZXIuY2h1cmNoSWQpIHtcbiAgICB0aHJvdyBuZXcgRm9yYmlkZGVuRXJyb3IoXCJObyBjaHVyY2ggYXNzaWduZWQgdG8gdGhpcyBhY2NvdW50XCIpO1xuICB9XG5cbiAgY29uc3QgY2h1cmNoID0gYXdhaXQgQ2h1cmNoTW9kZWwuZmluZEJ5SWQodXNlci5jaHVyY2hJZCwge1xuICAgIHdoZXJlOiB7IGlkOiB1c2VyLmNodXJjaElkIH0sXG4gICAgaW5jbHVkZToge1xuICAgICAgZGlzdHJpY3Q6IHtcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIHVuaW9uOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9LFxuICB9KTtcblxuICBpZiAoIWNodXJjaCkge1xuICAgIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKFwiQ2h1cmNoIG5vdCBmb3VuZFwiKTtcbiAgfVxuXG4gIGlmIChpbnB1dC5lbWFpbCkge1xuICAgIGNvbnN0IGV4aXN0aW5nQnlFbWFpbCA9IGF3YWl0IFVzZXJNb2RlbC5maW5kQnlFbWFpbChpbnB1dC5lbWFpbCk7XG4gICAgaWYgKGV4aXN0aW5nQnlFbWFpbCkge1xuICAgICAgdGhyb3cgbmV3IENvbmZsaWN0RXJyb3IoXCJBIHVzZXIgd2l0aCB0aGlzIGVtYWlsIGFscmVhZHkgZXhpc3RzXCIpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGV4aXN0aW5nQnlQaG9uZSA9IGF3YWl0IFVzZXJNb2RlbC5maW5kQnlQaG9uZU51bWJlcihpbnB1dC5waG9uZU51bWJlcik7XG4gIGlmIChleGlzdGluZ0J5UGhvbmUpIHtcbiAgICB0aHJvdyBuZXcgQ29uZmxpY3RFcnJvcihcIkEgdXNlciB3aXRoIHRoaXMgcGhvbmUgbnVtYmVyIGFscmVhZHkgZXhpc3RzXCIpO1xuICB9XG5cbiAgY29uc3QgcGFzc3dvcmRIYXNoID0gYXdhaXQgaGFzaFBhc3N3b3JkKGlucHV0LnBhc3N3b3JkKTtcblxuICB0cnkge1xuICAgIGNvbnN0IG1lbWJlciA9IChhd2FpdCBVc2VyTW9kZWwuY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdXNlcm5hbWU6IGlucHV0Lm5hdGlvbmFsSWQsXG4gICAgICAgIG5hdGlvbmFsSWQ6IGlucHV0Lm5hdGlvbmFsSWQsXG4gICAgICAgIGZpcnN0TmFtZTogaW5wdXQuZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZTogaW5wdXQubGFzdE5hbWUsXG4gICAgICAgIHBob25lTnVtYmVyOiBpbnB1dC5waG9uZU51bWJlcixcbiAgICAgICAgZW1haWw6IGlucHV0LmVtYWlsLFxuICAgICAgICBwYXNzd29yZEhhc2gsXG4gICAgICAgIHJvbGU6IFwiTUVNQkVSXCIsXG4gICAgICAgIHVuaW9uSWQ6IGNodXJjaC5kaXN0cmljdC51bmlvbklkLFxuICAgICAgICBkaXN0cmljdElkOiBjaHVyY2guZGlzdHJpY3RJZCxcbiAgICAgICAgY2h1cmNoSWQ6IGNodXJjaC5pZCxcbiAgICAgIH0sXG4gICAgICBzZWxlY3Q6IG1lbWJlclNlbGVjdCxcbiAgICB9KSkgYXMgTWVtYmVyUmVjb3JkO1xuXG4gICAgY29uc3QgcGFzc1Rva2VuID0gY3J5cHRvLnJhbmRvbVVVSUQoKTtcbiAgICBjb25zdCBxclBheWxvYWQgPSBhd2FpdCBnZW5lcmF0ZVFyUGF5bG9hZChwYXNzVG9rZW4pO1xuXG4gICAgbGV0IG1lbWJlclBhc3NSZWNvcmQgPSBhd2FpdCBwcmlzbWEubWVtYmVyUGFzcy5jcmVhdGUoe1xuICAgICAgZGF0YToge1xuICAgICAgICBtZW1iZXJJZDogbWVtYmVyLmlkLFxuICAgICAgICB0b2tlbjogcGFzc1Rva2VuLFxuICAgICAgICBxclBheWxvYWQsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgYXdhaXQgUGFzc01vZGVsLnVwc2VydCh7XG4gICAgICB3aGVyZTogeyBtZW1iZXJJZDogbWVtYmVyLmlkIH0sXG4gICAgICB1cGRhdGU6IHtcbiAgICAgICAgdG9rZW46IHBhc3NUb2tlbixcbiAgICAgICAgcXJQYXlsb2FkLFxuICAgICAgICBzZXNzaW9uRGF0ZTogbmV3IERhdGUoKSxcbiAgICAgICAgY2h1cmNoSWQ6IG1lbWJlci5jaHVyY2g/LmlkID8/IG51bGwsXG4gICAgICB9LFxuICAgICAgY3JlYXRlOiB7XG4gICAgICAgIG1lbWJlcklkOiBtZW1iZXIuaWQsXG4gICAgICAgIGNodXJjaElkOiBtZW1iZXIuY2h1cmNoPy5pZCA/PyBudWxsLFxuICAgICAgICB0b2tlbjogcGFzc1Rva2VuLFxuICAgICAgICBxclBheWxvYWQsXG4gICAgICAgIHNlc3Npb25EYXRlOiBuZXcgRGF0ZSgpLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGxvZ2luVXJsID0gYCR7REVGQVVMVF9GUk9OVEVORF9VUkx9L2xvZ2luYDtcbiAgICBjb25zdCBwYXNzVXJsID0gYCR7REVGQVVMVF9GUk9OVEVORF9VUkx9L21lbWJlci9wYXNzYDtcblxuICAgIGxldCBzbXNTZW50QXQ6IERhdGUgfCBudWxsID0gbnVsbDtcblxuICAgIGlmIChtZW1iZXIucGhvbmVOdW1iZXIpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBbXG4gICAgICAgIGBNdXJha2F6YSBuZXphIG11IFVtdWdhbmRhIFNEQSwgJHttZW1iZXIuZmlyc3ROYW1lfS5gLFxuICAgICAgICBgSW5qaXJhIGt1cmkgJHtsb2dpblVybH0gdWtvcmVzaGVqZSBpcmkgbmFtYmFyYSB5J2luZGFuZ2FtdW50dTogJHttZW1iZXIubmF0aW9uYWxJZH0uYCxcbiAgICAgICAgYElqYW1ibyByeSdpYmFuZ2Egd2FoYXdlOiAke2lucHV0LnBhc3N3b3JkfS5gLFxuICAgICAgICBgSWthcml0YSB5YXdlIHlhIFFSIGlyaSBoYW5vOiAke3Bhc3NVcmx9LmAsXG4gICAgICBdLmpvaW4oXCIgXCIpO1xuXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBzZW5kU21zKHtcbiAgICAgICAgICB0bzogbWVtYmVyLnBob25lTnVtYmVyLFxuICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgIH0pO1xuICAgICAgICBzbXNTZW50QXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBtZW1iZXJQYXNzUmVjb3JkID0gYXdhaXQgcHJpc21hLm1lbWJlclBhc3MudXBkYXRlKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogbWVtYmVyUGFzc1JlY29yZC5pZCB9LFxuICAgICAgICAgIGRhdGE6IHsgc21zU2VudEF0IH0sXG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoc21zRXJyb3IpIHtcbiAgICAgICAgLy8gTG9nIGFuZCBjb250aW51ZSB3aXRob3V0IGZhaWxpbmcgbWVtYmVyIGNyZWF0aW9uXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc2VuZCBtZW1iZXIgb25ib2FyZGluZyBTTVNcIiwgc21zRXJyb3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChtZW1iZXIuZW1haWwpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHNlbmRNZW1iZXJXZWxjb21lRW1haWwoe1xuICAgICAgICAgIHRvOiBtZW1iZXIuZW1haWwsXG4gICAgICAgICAgZmlyc3ROYW1lOiBtZW1iZXIuZmlyc3ROYW1lLFxuICAgICAgICAgIGxhc3ROYW1lOiBtZW1iZXIubGFzdE5hbWUsXG4gICAgICAgICAgcGhvbmVOdW1iZXI6IG1lbWJlci5waG9uZU51bWJlcixcbiAgICAgICAgICBwYXNzd29yZDogaW5wdXQucGFzc3dvcmQsXG4gICAgICAgICAgbmF0aW9uYWxJZDogbWVtYmVyLm5hdGlvbmFsSWQsXG4gICAgICAgICAgY2h1cmNoTmFtZTogbWVtYmVyLmNodXJjaD8ubmFtZSA/PyBudWxsLFxuICAgICAgICAgIGxvZ2luVXJsLFxuICAgICAgICAgIHBhc3NVcmwsXG4gICAgICAgICAgcXJQYXlsb2FkLFxuICAgICAgICAgIHBhc3NUb2tlbixcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlbWFpbEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc2VuZCBtZW1iZXIgd2VsY29tZSBlbWFpbFwiLCBlbWFpbEVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgbWVtYmVyOiB0b01lbWJlclN1bW1hcnkobWVtYmVyLCB7XG4gICAgICAgIHRva2VuOiBtZW1iZXJQYXNzUmVjb3JkLnRva2VuLFxuICAgICAgICBzbXNTZW50QXQ6IG1lbWJlclBhc3NSZWNvcmQuc21zU2VudEF0LFxuICAgICAgICBleHBpcmVzQXQ6IG1lbWJlclBhc3NSZWNvcmQuZXhwaXJlc0F0LFxuICAgICAgfSksXG4gICAgICBtZW1iZXJQYXNzOiB7XG4gICAgICAgIGlkOiBtZW1iZXJQYXNzUmVjb3JkLmlkLFxuICAgICAgICB0b2tlbjogcGFzc1Rva2VuLFxuICAgICAgICBxclBheWxvYWQsXG4gICAgICAgIHNtc1NlbnRBdCxcbiAgICAgIH0sXG4gICAgfSBzYXRpc2ZpZXMgQ3JlYXRlTWVtYmVyUmVzdWx0O1xuICB9IGNhdGNoIChlcnJvcjogdW5rbm93bikge1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFByaXNtYS5QcmlzbWFDbGllbnRLbm93blJlcXVlc3RFcnJvciAmJiBlcnJvci5jb2RlID09PSBcIlAyMDAyXCIpIHtcbiAgICAgIGNvbnN0IHRhcmdldCA9IEFycmF5LmlzQXJyYXkoZXJyb3IubWV0YT8udGFyZ2V0KSA/IGVycm9yLm1ldGE/LnRhcmdldCA6IFtdO1xuXG4gICAgICBpZiAodGFyZ2V0LmluY2x1ZGVzKFwibmF0aW9uYWxJZFwiKSB8fCB0YXJnZXQuaW5jbHVkZXMoXCJ1c2VybmFtZVwiKSkge1xuICAgICAgICB0aHJvdyBuZXcgQ29uZmxpY3RFcnJvcihcIkEgbWVtYmVyIHdpdGggdGhpcyBuYXRpb25hbCBJRCBhbHJlYWR5IGV4aXN0c1wiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRhcmdldC5pbmNsdWRlcyhcImVtYWlsXCIpKSB7XG4gICAgICAgIHRocm93IG5ldyBDb25mbGljdEVycm9yKFwiQSB1c2VyIHdpdGggdGhpcyBlbWFpbCBhbHJlYWR5IGV4aXN0c1wiKTtcbiAgICAgIH1cblxuICAgICAgdGhyb3cgbmV3IENvbmZsaWN0RXJyb3IoXCJNZW1iZXIgYWxyZWFkeSBleGlzdHNcIik7XG4gICAgfVxuXG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG4iXSwibmFtZXMiOlsiUHJpc21hIiwiY3J5cHRvIiwiVXNlck1vZGVsIiwiQ2h1cmNoTW9kZWwiLCJQYXNzTW9kZWwiLCJGb3JiaWRkZW5FcnJvciIsIk5vdEZvdW5kRXJyb3IiLCJDb25mbGljdEVycm9yIiwiaGFzaFBhc3N3b3JkIiwiZ2VuZXJhdGVRclBheWxvYWQiLCJzZW5kTWVtYmVyV2VsY29tZUVtYWlsIiwic2VuZFNtcyIsImVudiIsInByaXNtYSIsIm1lbWJlclNlbGVjdCIsImlkIiwibmF0aW9uYWxJZCIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwicGhvbmVOdW1iZXIiLCJlbWFpbCIsImNodXJjaCIsInNlbGVjdCIsIm5hbWUiLCJkaXN0cmljdElkIiwiY3JlYXRlZEF0IiwidG9NZW1iZXJTdW1tYXJ5IiwibWVtYmVyIiwicGFzcyIsInRvSVNPU3RyaW5nIiwibWVtYmVyUGFzcyIsInRva2VuIiwic21zU2VudEF0IiwiZXhwaXJlc0F0IiwiREVGQVVMVF9GUk9OVEVORF9VUkwiLCJDT1JTX09SSUdJTiIsImVuc3VyZU1lbWJlclNjb3BlIiwidXNlciIsImZpbHRlcnMiLCJyb2xlIiwiY2h1cmNoSWQiLCJlbnN1cmVNZW1iZXJBY2Nlc3MiLCJ1bmlvbklkIiwidXBkYXRlTWVtYmVyIiwibWVtYmVySWQiLCJpbnB1dCIsImV4aXN0aW5nIiwiZmluZEJ5SWQiLCJkYXRhIiwidW5kZWZpbmVkIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsInVwZGF0ZSIsIndoZXJlIiwiZXJyb3IiLCJQcmlzbWFDbGllbnRLbm93blJlcXVlc3RFcnJvciIsImNvZGUiLCJtZXRhIiwidGFyZ2V0IiwiQXJyYXkiLCJpc0FycmF5IiwiaW5jbHVkZXMiLCJkZWxldGVNZW1iZXIiLCJkZWxldGVNYW55IiwiZGVsZXRlIiwic3VjY2VzcyIsImxpc3RNZW1iZXJzRm9yVXNlciIsIm1lbWJlcnMiLCJmaW5kTWFueSIsIm9yZGVyQnkiLCJtZW1iZXJJZHMiLCJtYXAiLCJwYXNzZXMiLCJpbiIsInBhc3NCeU1lbWJlciIsIk1hcCIsImZvckVhY2giLCJzZXQiLCJnZXQiLCJnZXRNZW1iZXJQYXNzRm9yVXNlciIsImZpbmRVbmlxdWUiLCJxclBheWxvYWQiLCJjcmVhdGVNZW1iZXIiLCJpbmNsdWRlIiwiZGlzdHJpY3QiLCJ1bmlvbiIsImV4aXN0aW5nQnlFbWFpbCIsImZpbmRCeUVtYWlsIiwiZXhpc3RpbmdCeVBob25lIiwiZmluZEJ5UGhvbmVOdW1iZXIiLCJwYXNzd29yZEhhc2giLCJwYXNzd29yZCIsImNyZWF0ZSIsInVzZXJuYW1lIiwicGFzc1Rva2VuIiwicmFuZG9tVVVJRCIsIm1lbWJlclBhc3NSZWNvcmQiLCJ1cHNlcnQiLCJzZXNzaW9uRGF0ZSIsIkRhdGUiLCJsb2dpblVybCIsInBhc3NVcmwiLCJtZXNzYWdlIiwiam9pbiIsInRvIiwic21zRXJyb3IiLCJjb25zb2xlIiwiY2h1cmNoTmFtZSIsImVtYWlsRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/services/member.service.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/qr.ts":
/*!*************************!*\
  !*** ./src/utils/qr.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateQrPayload: () => (/* binding */ generateQrPayload)\n/* harmony export */ });\n/* harmony import */ var qrcode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! qrcode */ \"(rsc)/./node_modules/qrcode/lib/index.js\");\n\nconst generateQrPayload = async (token)=>{\n    return qrcode__WEBPACK_IMPORTED_MODULE_0__.toDataURL(JSON.stringify({\n        token\n    }));\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvcXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBNEI7QUFFckIsTUFBTUMsb0JBQW9CLE9BQU9DO0lBQ3RDLE9BQU9GLDZDQUFnQixDQUFDSSxLQUFLQyxTQUFTLENBQUM7UUFBRUg7SUFBTTtBQUNqRCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2RhLWJhY2tlbmQvLi9zcmMvdXRpbHMvcXIudHM/MjY0NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUVJDb2RlIGZyb20gXCJxcmNvZGVcIjtcblxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlUXJQYXlsb2FkID0gYXN5bmMgKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4gPT4ge1xuICByZXR1cm4gUVJDb2RlLnRvRGF0YVVSTChKU09OLnN0cmluZ2lmeSh7IHRva2VuIH0pKTtcbn07XG4iXSwibmFtZXMiOlsiUVJDb2RlIiwiZ2VuZXJhdGVRclBheWxvYWQiLCJ0b2tlbiIsInRvRGF0YVVSTCIsIkpTT04iLCJzdHJpbmdpZnkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/qr.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/zod","vendor-chunks/semver","vendor-chunks/bcryptjs","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time","vendor-chunks/twilio","vendor-chunks/xmlbuilder","vendor-chunks/mime-db","vendor-chunks/axios","vendor-chunks/qrcode","vendor-chunks/pngjs","vendor-chunks/qs","vendor-chunks/follow-redirects","vendor-chunks/object-inspect","vendor-chunks/debug","vendor-chunks/url-parse","vendor-chunks/form-data","vendor-chunks/get-intrinsic","vendor-chunks/https-proxy-agent","vendor-chunks/dayjs","vendor-chunks/agent-base","vendor-chunks/asynckit","vendor-chunks/dijkstrajs","vendor-chunks/combined-stream","vendor-chunks/mime-types","vendor-chunks/side-channel-list","vendor-chunks/proxy-from-env","vendor-chunks/supports-color","vendor-chunks/side-channel-weakmap","vendor-chunks/querystringify","vendor-chunks/has-symbols","vendor-chunks/delayed-stream","vendor-chunks/function-bind","vendor-chunks/side-channel-map","vendor-chunks/es-set-tostringtag","vendor-chunks/side-channel","vendor-chunks/scmp","vendor-chunks/get-proto","vendor-chunks/call-bind-apply-helpers","vendor-chunks/dunder-proto","vendor-chunks/math-intrinsics","vendor-chunks/requires-port","vendor-chunks/call-bound","vendor-chunks/es-errors","vendor-chunks/has-flag","vendor-chunks/gopd","vendor-chunks/es-define-property","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/pdf-lib","vendor-chunks/nodemailer","vendor-chunks/pako","vendor-chunks/@pdf-lib"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute&page=%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmembers%2F%5BmemberId%5D%2Fpass%2Froute.ts&appDir=%2FVolumes%2FMacintosh%20HD%20-%20Data%2Fsda%2Fsda-backend%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FMacintosh%20HD%20-%20Data%2Fsda%2Fsda-backend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();